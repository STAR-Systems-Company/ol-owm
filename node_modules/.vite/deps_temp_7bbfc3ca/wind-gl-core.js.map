{
  "version": 3,
  "sources": ["../../wind-gl-core/node_modules/earcut/src/earcut.js", "../../worker-fetch/src/util.ts", "../../.pnpm/exifr@7.1.3/node_modules/exifr/dist/lite.esm.mjs", "../../worker-fetch/src/RequestScheduler.ts", "../../worker-fetch/src/UPNG.js", "../../worker-fetch/src/Request.ts", "../../worker-fetch/src/webWorkerTransfer.ts", "../../worker-fetch/src/ThrottledInvoker.ts", "../../worker-fetch/src/Actor.ts", "../../worker-fetch/src/worker.ts", "../../worker-fetch/src/config.ts", "../../worker-fetch/src/workerFactory.ts", "../../worker-fetch/src/WorkerPool.ts", "../../worker-fetch/src/Dispatcher.ts", "../../worker-fetch/src/index.ts", "../../worker-fetch/bundle/index.js", "../../wind-gl-core/src/renderer/Pipelines.ts", "../../wind-gl-core/src/renderer/pass/base.ts", "../../wind-gl-core/src/utils/common.ts", "../../wind-gl-core/src/renderer/pass/color/compose.ts", "../../wind-gl-core/src/renderer/pass/color/colorize.ts", "../../wind-gl-core/src/renderer/pass/raster/image.ts", "../../wind-gl-core/src/renderer/pass/raster/compose.ts", "../../wind-gl-core/src/renderer/pass/particles/compose.ts", "../../wind-gl-core/src/renderer/pass/particles/update.ts", "../../wind-gl-core/src/renderer/pass/particles/screen.ts", "../../wind-gl-core/src/renderer/pass/particles/particles.ts", "../../wind-gl-core/src/renderer/pass/picker.ts", "../../wind-gl-core/src/utils/style-parser.ts", "../../wind-gl-core/src/type.ts", "../../wind-gl-core/src/renderer/pass/mask.ts", "../../wind-gl-core/src/renderer/pass/arrow/compose.ts", "../../wind-gl-core/src/renderer/pass/arrow/arrow.ts", "../../wind-gl-core/src/renderer/index.ts", "../../wind-gl-core/src/tile/TileID.ts", "../../wind-gl-core/src/tile/TileMesh.ts", "../../wind-gl-core/src/tile/Tile.ts", "../../wind-gl-core/src/utils/LRUCache.ts", "../../wind-gl-core/src/source/cahce.ts", "../../wind-gl-core/src/source/tile.ts", "../../wind-gl-core/src/source/image.ts", "../../wind-gl-core/src/utils/TrackManger.ts", "../../wind-gl-core/src/utils/Track.ts", "../../wind-gl-core/src/source/Timeline.ts", "../../wind-gl-core/src/index.ts"],
  "sourcesContent": ["'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 32767 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize, 0);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim | 0);\n            triangles.push(ear.i / dim | 0);\n            triangles.push(next.i / dim | 0);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    var p = c.next;\n    while (p !== a) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(x0, y0, minX, minY, invSize),\n        maxZ = zOrder(x1, y1, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim | 0);\n            triangles.push(p.i / dim | 0);\n            triangles.push(b.i / dim | 0);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize, 0);\n                earcutLinked(c, triangles, dim, minX, minY, invSize, 0);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    var bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    var bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    filterPoints(bridgeReverse, bridgeReverse.next);\n    return filterPoints(bridge, bridge.next);\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                m = p.x < p.next.x ? p : p.next;\n                if (x === hx) return m; // hole touches outer segment; pick leftmost endpoint\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === 0) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = (x - minX) * invSize | 0;\n    y = (y - minY) * invSize | 0;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) >= (ax - px) * (cy - py) &&\n           (ax - px) * (by - py) >= (bx - px) * (ay - py) &&\n           (bx - px) * (cy - py) >= (cx - px) * (by - py);\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = 0;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n", "/* eslint-disable no-restricted-globals */\n\n/*\n * Call an asynchronous function on an array of arguments,\n * calling `callback` with the completed results of all calls.\n *\n * @param array input to each call of the async function.\n * @param fn an async function with signature (data, callback)\n * @param callback a callback run after all async work is done.\n * called with an array, containing the results of each async call.\n * @private\n */\nexport function asyncAll<Item, Result>(\n  array: Array<Item>,\n  fn: (item: Item, fnCallback: Callback<Result>) => void,\n  callback: Callback<Array<Result>>,\n) {\n  if (!array.length) {\n    return callback(null, []);\n  }\n  let remaining = array.length;\n  const results = new Array(array.length);\n  let error = null;\n  array.forEach((item, i) => {\n    fn(item, (err, result) => {\n      if (err) {\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        error = err;\n      }\n      results[i] = result as any as Result; // https://github.com/facebook/flow/issues/2123\n      if (--remaining === 0) callback(error, results);\n    });\n  });\n}\n\n/**\n *  Returns true if the when run in the web-worker context.\n *\n * @private\n * @returns {boolean}\n */\nexport function isWorker(): boolean {\n  return typeof WorkerGlobalScope !== 'undefined' && typeof self !== 'undefined' && self instanceof WorkerGlobalScope;\n}\n\n/**\n * Print a warning message to the console and ensure duplicate warning messages\n * are not printed.\n * @private\n */\nconst warnOnceHistory: { [key: string]: boolean } = {};\n\nexport function warnOnce(message: string): void {\n  if (!warnOnceHistory[message]) {\n    // console isn't defined in some WebWorkers, see #2558\n    if (typeof console !== 'undefined') console.warn(message);\n    warnOnceHistory[message] = true;\n  }\n}\n\nexport function isImageBitmap(image: any): image is ImageBitmap {\n  return typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap;\n}\n\nexport function isArrayBuffer(value: any): value is ArrayBuffer {\n  return (\n    value &&\n    typeof ArrayBuffer !== 'undefined' &&\n    (value instanceof ArrayBuffer || (value.constructor && value.constructor.name === 'ArrayBuffer'))\n  );\n}\n\nlet _isSafari: WithNull<boolean> = null;\n\n/**\n * Returns true when run in WebKit derived browsers.\n * This is used as a workaround for a memory leak in Safari caused by using Transferable objects to\n * transfer data between WebWorkers and the main thread.\n * https://github.com/mapbox/mapbox-gl-js/issues/8771\n *\n * This should be removed once the underlying Safari issue is fixed.\n *\n * @private\n * @param scope {WindowOrWorkerGlobalScope} Since this function is used both on the main thread and WebWorker context,\n *      let the calling scope pass in the global scope object.\n * @returns {boolean}\n */\nexport function isSafari(scope: any): boolean {\n  if (_isSafari == null) {\n    const userAgent = scope.navigator ? scope.navigator.userAgent : null;\n    _isSafari =\n      !!scope.safari ||\n      !!(\n        userAgent &&\n        (/\\b(iPad|iPhone|iPod)\\b/.test(userAgent) || (!!userAgent.match('Safari') && !userAgent.match('Chrome')))\n      );\n  }\n  return _isSafari;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function nullFunction() {}\n\nconst uidCounters: Record<string, number> = {};\n\n/**\n * 获取 uid\n * @param id= - Identifier base name\n * @param id\n * @return uid\n * */\nexport function uid(id = 'id'): string {\n  uidCounters[id] = uidCounters[id] ?? 0;\n  const count = uidCounters[id]++;\n  return `${id}-${count}`;\n}\n\nexport function typeOf(value: any): string {\n  return Object.prototype.toString.call(value).slice(8, -1).toLowerCase();\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isFunction(v: any): v is Function {\n  return typeOf(v) === 'function';\n}\n\n// Ensure that we're sending the correct referrer from blob URL worker bundles.\n// For files loaded from the local file system, `location.origin` will be set\n// to the string(!) \"null\" (Firefox), or \"file://\" (Chrome, Safari, Edge, IE),\n// and we will set an empty referrer. Otherwise, we're using the document's URL.\nexport const getReferrer = isWorker()\n  ? () => (self as any).worker && (self as any).worker.referrer\n  : () => (window.location.protocol === 'blob:' ? window.parent : window).location.href;\n\n/**\n * 将 ArrayBuffer 转换为 ImageBitmap\n * @param data\n * @param callback\n */\nexport function arrayBufferToImageBitmap(\n  data: ArrayBuffer,\n  callback: (err?: Error | null, image?: ImageBitmap | null) => void,\n) {\n  const blob: Blob = new Blob([new Uint8Array(data)], { type: 'image/png' });\n  createImageBitmap(blob)\n    .then((imgBitmap) => {\n      callback(null, imgBitmap);\n    })\n    .catch((e) => {\n      callback(\n        new Error(\n          `Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`,\n        ),\n      );\n    });\n}\n\nconst transparentPngUrl =\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=';\n\n/**\n * 将 ArrayBuffer 转换为 Image\n * @param data\n * @param callback\n */\nexport function arrayBufferToImage(\n  data: ArrayBuffer,\n  callback: (err?: Error | null, image?: HTMLImageElement | null) => void,\n) {\n  const img: HTMLImageElement = new Image();\n  img.onload = () => {\n    callback(null, img);\n    URL.revokeObjectURL(img.src);\n    // prevent image dataURI memory leak in Safari;\n    // but don't free the image immediately because it might be uploaded in the next frame\n    // https://github.com/mapbox/mapbox-gl-js/issues/10226\n    img.onload = null;\n    window.requestAnimationFrame(() => {\n      img.src = transparentPngUrl;\n    });\n  };\n  img.onerror = () =>\n    callback(\n      new Error(\n        'Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.',\n      ),\n    );\n  const blob: Blob = new Blob([new Uint8Array(data)], { type: 'image/png' });\n  img.src = data.byteLength ? URL.createObjectURL(blob) : transparentPngUrl;\n}\n\n/*\nTakes in a flattened one dimensional array\nrepresenting two-dimensional pixel values\nand returns an array of arrays.\n*/\nexport function unflatten(valuesInOneDimension, size) {\n  const { height, width } = size;\n  const valuesInTwoDimensions: any[] = [];\n  for (let y = 0; y < height; y++) {\n    const start = y * width;\n    const end = start + width;\n    valuesInTwoDimensions.push(valuesInOneDimension.slice(start, end));\n  }\n  return valuesInTwoDimensions;\n}\n\nexport function parseMetedata(str: string) {\n  const array = str.split(',');\n  const res = array.map((item) => {\n    const kv = item.split(':');\n    return {\n      [kv[0]]: isNaN(parseFloat(kv[1])) ? kv[1] : parseFloat(kv[1]),\n    };\n  });\n\n  return res.reduce((pre, cur) => Object.assign({}, pre, cur), {});\n}\n", "function e(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var t=\"undefined\"!=typeof self?self:global;const i=\"undefined\"!=typeof navigator,s=i&&\"undefined\"==typeof HTMLImageElement,n=!(\"undefined\"==typeof global||\"undefined\"==typeof process||!process.versions||!process.versions.node),r=t.Buffer,a=t.BigInt,o=!!r,h=e=>f(e)?void 0:e,l=e=>void 0!==e;function f(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(l).length)}function u(e){let t=new Error(e);throw delete t.stack,t}function d(e){return\"\"===(e=function(e){for(;e.endsWith(\"\\0\");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function c(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const g=e=>String.fromCharCode.apply(null,e),p=\"undefined\"!=typeof TextDecoder?new TextDecoder(\"utf-8\"):void 0;function m(e){return p?p.decode(e):o?Buffer.from(e).toString(\"utf8\"):decodeURIComponent(escape(g(e)))}class y{static from(e,t){return e instanceof this&&e.le===t?e:new y(e,void 0,void 0,t)}constructor(e,t=0,i,s){if(\"boolean\"==typeof s&&(this.le=s),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let s=new DataView(e,t,i);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof y){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&u(\"Creating view outside of available memory in ArrayBuffer\");let s=new DataView(e.buffer,t,i);this._swapDataView(s)}else if(\"number\"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else u(\"Invalid input argument for BufferView: \"+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=y){return e instanceof DataView||e instanceof y?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||u(\"BufferView.set(): Invalid data argument.\"),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new y(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return m(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return g(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let s=0;s<t&&e+s<this.byteLength;s+=2)i.push(this.getUint16(e+s));return g(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function b(e,t){u(`${e} '${t}' was not loaded, try using full build of exifr.`)}class w extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||b(this.kind,e),t&&(e in t||function(e,t){u(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||b(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var S=new w(\"file parser\"),k=new w(\"segment parser\"),v=new w(\"file reader\");let O=t.fetch;function x(e,t){return(s=e).startsWith(\"data:\")||s.length>1e4?P(e,t,\"base64\"):n&&e.includes(\"://\")?C(e,t,\"url\",A):n?P(e,t,\"fs\"):i?C(e,t,\"url\",A):void u(\"Invalid input argument\");var s}async function C(e,t,i,s){return v.has(i)?P(e,t,i):s?async function(e,t){let i=await t(e);return new y(i)}(e,s):void u(`Parser ${i} is not loaded`)}async function P(e,t,i){let s=new(v.get(i))(e,t);return await s.read(),s}const A=e=>O(e).then((e=>e.arrayBuffer())),U=e=>new Promise(((t,i)=>{let s=new FileReader;s.onloadend=()=>t(s.result||new ArrayBuffer),s.onerror=i,s.readAsArrayBuffer(e)}));class I extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function B(e,t,i){let s=new I;for(let[e,t]of i)s.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,s);else e.set(t,s);return s}function F(e,t,i){let s,n=e.get(t);for(s of i)n.set(s[0],s[1])}const L=new Map,D=new Map,T=new Map,z=[\"chunked\",\"firstChunkSize\",\"firstChunkSizeNode\",\"firstChunkSizeBrowser\",\"chunkSize\",\"chunkLimit\"],N=[\"jfif\",\"xmp\",\"icc\",\"iptc\",\"ihdr\"],V=[\"tiff\",...N],M=[\"ifd0\",\"ifd1\",\"exif\",\"gps\",\"interop\"],E=[...V,...M],R=[\"makerNote\",\"userComment\"],j=[\"translateKeys\",\"translateValues\",\"reviveValues\",\"multiSegment\"],G=[...j,\"sanitize\",\"mergeOutput\",\"silentErrors\"];class H{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class _ extends H{get needed(){return this.enabled||this.deps.size>0}constructor(t,i,s,n){if(super(),e(this,\"enabled\",!1),e(this,\"skip\",new Set),e(this,\"pick\",new Set),e(this,\"deps\",new Set),e(this,\"translateKeys\",!1),e(this,\"translateValues\",!1),e(this,\"reviveValues\",!1),this.key=t,this.enabled=i,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=M.includes(t),this.canBeFiltered&&(this.dict=L.get(t)),void 0!==s)if(Array.isArray(s))this.parse=this.enabled=!0,this.canBeFiltered&&s.length>0&&this.translateTagSet(s,this.pick);else if(\"object\"==typeof s){if(this.enabled=!0,this.parse=!1!==s.parse,this.canBeFiltered){let{pick:e,skip:t}=s;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(s)}else!0===s||!1===s?this.parse=this.enabled=s:u(`Invalid options argument: ${s}`)}applyInheritables(e){let t,i;for(t of j)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,s,{tagKeys:n,tagValues:r}=this.dict;for(i of e)\"string\"==typeof i?(s=r.indexOf(i),-1===s&&(s=n.indexOf(Number(i))),-1!==s&&t.add(Number(n[s]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,q(this.pick,this.deps)):this.enabled&&this.pick.size>0&&q(this.pick,this.deps)}}var W={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},$=new Map;class K extends H{static useCached(e){let t=$.get(e);return void 0!==t||(t=new this(e),$.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):\"object\"==typeof e?this.setupFromObject(e):u(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=i?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of z)this[e]=W[e];for(e of G)this[e]=W[e];for(e of R)this[e]=W[e];for(e of E)this[e]=new _(e,W[e],void 0,this)}setupFromTrue(){let e;for(e of z)this[e]=W[e];for(e of G)this[e]=W[e];for(e of R)this[e]=!0;for(e of E)this[e]=new _(e,!0,void 0,this)}setupFromArray(e){let t;for(t of z)this[t]=W[t];for(t of G)this[t]=W[t];for(t of R)this[t]=W[t];for(t of E)this[t]=new _(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,M)}setupFromObject(e){let t;for(t of(M.ifd0=M.ifd0||M.image,M.ifd1=M.ifd1||M.thumbnail,Object.assign(this,e),z))this[t]=Y(e[t],W[t]);for(t of G)this[t]=Y(e[t],W[t]);for(t of R)this[t]=Y(e[t],W[t]);for(t of V)this[t]=new _(t,W[t],e[t],this);for(t of M)this[t]=new _(t,W[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,M,E),!0===e.tiff?this.batchEnableWithBool(M,!0):!1===e.tiff?this.batchEnableWithUserValue(M,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,M):\"object\"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,M)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,s=i){if(e&&e.length){for(let e of s)this[e].enabled=!1;let t=X(e,i);for(let[e,i]of t)q(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=X(t,i);for(let[t,i]of e)q(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:s,icc:n}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),s.enabled||e.skip.add(33723),n.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:s}=this;s.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=M.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of M)this[e].finalizeFilters()}get onlyTiff(){return!N.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of V)this[e].enabled&&!k.has(e)&&b(\"segment parser\",e)}}function X(e,t){let i,s,n,r,a=[];for(n of t){for(r of(i=L.get(n),s=[],i))(e.includes(r[0])||e.includes(r[1]))&&s.push(r[0]);s.length&&a.push([n,s])}return a}function Y(e,t){return void 0!==e?e:void 0!==t?t:void 0}function q(e,t){for(let i of t)e.add(i)}e(K,\"default\",W);class J{constructor(t){e(this,\"parsers\",{}),e(this,\"output\",{}),e(this,\"errors\",[]),e(this,\"pushToErrors\",(e=>this.errors.push(e))),this.options=K.useCached(t)}async read(e){this.file=await function(e,t){return\"string\"==typeof e?x(e,t):i&&!s&&e instanceof HTMLImageElement?x(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new y(e):i&&e instanceof Blob?C(e,t,\"blob\",U):void u(\"Invalid input argument\")}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,s]of S)if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),u(\"Unknown file format\")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),h(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=k.get(\"tiff\",e);var s;if(t.tiff?s={start:0,type:\"tiff\"}:t.jpeg&&(s=await this.fileParser.getOrFindSegment(\"tiff\")),void 0===s)return;let n=await this.fileParser.ensureSegmentChunk(s),r=this.parsers.tiff=new i(n,e,t),a=await r.extractThumbnail();return t.close&&t.close(),a}}async function Z(e,t){let i=new J(t);return await i.read(e),i.parse()}var Q=Object.freeze({__proto__:null,parse:Z,Exifr:J,fileParsers:S,segmentParsers:k,fileReaders:v,tagKeys:L,tagValues:D,tagRevivers:T,createDictionary:B,extendDictionary:F,fetchUrlAsArrayBuffer:A,readBlobAsArrayBuffer:U,chunkedProps:z,otherSegments:N,segments:V,tiffBlocks:M,segmentsAndBlocks:E,tiffExtractables:R,inheritables:j,allFormatters:G,Options:K});class ee{constructor(t,i,s){e(this,\"errors\",[]),e(this,\"ensureSegmentChunk\",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){u(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):u(\"Segment unreachable: \"+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=i,this.parsers=s}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(k.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,s=this.options[e];if(s&&s.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class te{static findPosition(e,t){let i=e.getUint16(t+2)+2,s=\"function\"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,n=t+s,r=i-s;return{offset:t,length:i,headerLength:s,start:n,size:r,end:n+r}}static parse(e,t={}){return new this(e,new K({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof y?e:new y(e)}constructor(t,i={},s){e(this,\"errors\",[]),e(this,\"raw\",new Map),e(this,\"handleError\",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(t),this.file=s,this.type=this.constructor.type,this.globalOptions=this.options=i,this.localOptions=i[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=T.get(t),s=D.get(t),n=L.get(t),r=this.options[t],a=r.reviveValues&&!!i,o=r.translateValues&&!!s,h=r.translateKeys&&!!n,l={};for(let[t,r]of e)a&&i.has(t)?r=i.get(t)(r):o&&s.has(t)&&(r=this.translateValue(r,s.get(t))),h&&n.has(t)&&(t=n.get(t)||t),l[t]=r;return l}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}e(te,\"headerLength\",4),e(te,\"type\",void 0),e(te,\"multiSegment\",!1),e(te,\"canHandle\",(()=>!1));function ie(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function se(e){return e>=224&&e<=239}function ne(e,t,i){for(let[s,n]of k)if(n.canHandle(e,t,i))return s}class re extends ee{constructor(...t){super(...t),e(this,\"appSegments\",[]),e(this,\"jpegSegments\",[]),e(this,\"unknownSegments\",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(k.keyList())):(e=void 0===e?k.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&k.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:s,wanted:n,remaining:r}=this;if(!s&&this.file.chunked&&(s=Array.from(n).some((e=>{let t=k.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),s&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;r.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:s}=i,n=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>s&&!n?!await i.readNextChunk(e):!await i.readNextChunk(s),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,s,n,r,a,o,{file:h,findAll:l,wanted:f,remaining:u,options:d}=this;for(;e<t;e++)if(255===h.getUint8(e))if(i=h.getUint8(e+1),se(i)){if(s=h.getUint16(e+2),n=ne(h,e,s),n&&f.has(n)&&(r=k.get(n),a=r.findPosition(h,e),o=d[n],a.type=n,this.appSegments.push(a),!l&&(r.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||u.delete(n)):u.delete(n),0===u.size)))break;d.recordUnknownSegments&&(a=te.findPosition(h,e),a.marker=i,this.unknownSegments.push(a)),e+=s+1}else if(ie(i)){if(s=h.getUint16(e+2),218===i&&!1!==d.stopAfterSos)return;d.recordJpegSegments&&this.jpegSegments.push({offset:e,length:s,marker:i}),e+=s+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,s,n,r=new Map;for(let a=0;a<e.length;a++)i=e[a],s=i[t],r.has(s)?n=r.get(s):r.set(s,n=[]),n.push(i);return Array.from(r)}(this.appSegments,\"type\");this.mergedAppSegments=e.map((([e,t])=>{let i=k.get(e,this.options);if(i.handleMultiSegments){return{type:e,chunk:i.handleMultiSegments(t)}}return t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}e(re,\"type\",\"jpeg\"),S.set(\"jpeg\",re);const ae=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class oe extends te{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:s,skip:n}=this.options[t];s=new Set(s);let r=s.size>0,a=0===n.size,o=this.chunk.getUint16(e);e+=2;for(let h=0;h<o;h++){let o=this.chunk.getUint16(e);if(r){if(s.has(o)&&(i.set(o,this.parseTag(e,o,t)),s.delete(o),0===s.size))break}else!a&&n.has(o)||i.set(o,this.parseTag(e,o,t));e+=12}return i}parseTag(e,t,i){let{chunk:s}=this,n=s.getUint16(e+2),r=s.getUint32(e+4),a=ae[n];if(a*r<=4?e+=8:e=s.getUint32(e+8),(n<1||n>13)&&u(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e}`),e>s.byteLength&&u(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${n}, offset ${e} is outside of chunk size ${s.byteLength}`),1===n)return s.getUint8Array(e,r);if(2===n)return d(s.getString(e,r));if(7===n)return s.getUint8Array(e,r);if(1===r)return this.parseTagValue(n,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(n))(r),i=a;for(let s=0;s<r;s++)t[s]=this.parseTagValue(n,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:u(`Invalid tiff type ${e}`)}}}class he extends oe{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse(\"parseExifBlock\"),e.gps.enabled&&await this.safeParse(\"parseGpsBlock\"),e.interop.enabled&&await this.safeParse(\"parseInteropBlock\"),e.ifd1.enabled&&await this.safeParse(\"parseThumbnailBlock\"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&u(\"Malformed EXIF data\"),!e.chunked&&this.ifd0Offset>e.byteLength&&u(`IFD0 offset points to outside of file.\\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,c(this.options));let t=this.parseBlock(this.ifd0Offset,\"ifd0\");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,c(this.options));let e=this.parseBlock(this.exifOffset,\"exif\");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,\"gps\");return e&&e.has(2)&&e.has(4)&&(e.set(\"latitude\",le(...e.get(2),e.get(1))),e.set(\"longitude\",le(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,\"interop\")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,\"ifd1\"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,s={};for(t of M)if(e=this[t],!f(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(\"ifd1\"===t)continue;Object.assign(s,i)}else s[t]=i;return this.makerNote&&(s.makerNote=this.makerNote),this.userComment&&(s.userComment=this.userComment),s}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,s]of Object.entries(t))this.assignObjectToOutput(e,i,s)}}function le(e,t,i,s){var n=e+t/60+i/3600;return\"S\"!==s&&\"W\"!==s||(n*=-1),n}e(he,\"type\",\"tiff\"),e(he,\"headerLength\",10),k.set(\"tiff\",he);var fe=Object.freeze({__proto__:null,default:Q,Exifr:J,fileParsers:S,segmentParsers:k,fileReaders:v,tagKeys:L,tagValues:D,tagRevivers:T,createDictionary:B,extendDictionary:F,fetchUrlAsArrayBuffer:A,readBlobAsArrayBuffer:U,chunkedProps:z,otherSegments:N,segments:V,tiffBlocks:M,segmentsAndBlocks:E,tiffExtractables:R,inheritables:j,allFormatters:G,Options:K,parse:Z});const ue={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},de=Object.assign({},ue,{firstChunkSize:4e4,gps:[1,2,3,4]});async function ce(e){let t=new J(de);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}}const ge=Object.assign({},ue,{tiff:!1,ifd1:!0,mergeOutput:!1});async function pe(e){let t=new J(ge);await t.read(e);let i=await t.extractThumbnail();return i&&o?r.from(i):i}async function me(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const ye=Object.assign({},ue,{firstChunkSize:4e4,ifd0:[274]});async function be(e){let t=new J(ye);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const we=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Se=!0,ke=!0;if(\"object\"==typeof navigator){let e=navigator.userAgent;if(e.includes(\"iPad\")||e.includes(\"iPhone\")){let t=e.match(/OS (\\d+)_(\\d+)/);if(t){let[,e,i]=t,s=Number(e)+.1*Number(i);Se=s<13.4,ke=!1}}else if(e.includes(\"OS X 10\")){let[,t]=e.match(/OS X 10[_.](\\d+)/);Se=ke=Number(t)<15}if(e.includes(\"Chrome/\")){let[,t]=e.match(/Chrome\\/(\\d+)/);Se=ke=Number(t)<81}else if(e.includes(\"Firefox/\")){let[,t]=e.match(/Firefox\\/(\\d+)/);Se=ke=Number(t)<77}}async function ve(e){let t=await be(e);return Object.assign({canvas:Se,css:ke},we[t])}class Oe extends y{constructor(...t){super(...t),e(this,\"ranges\",new xe),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=o?r.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let s=super.set(e,t);return this.ranges.add(t,s.byteLength),s}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class xe{constructor(){e(this,\"list\",[])}get length(){return this.list.length}add(e,t,i=0){let s=e+t,n=this.list.filter((t=>Ce(e,t.offset,s)||Ce(e,t.end,s)));if(n.length>0){e=Math.min(e,...n.map((e=>e.offset))),s=Math.max(s,...n.map((e=>e.end))),t=s-e;let i=n.shift();i.offset=e,i.length=t,i.end=s,this.list=this.list.filter((e=>!n.includes(e)))}else this.list.push({offset:e,length:t,end:s})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function Ce(e,t,i){return e<=t&&t<=i}class Pe extends Oe{constructor(t,i){super(0),e(this,\"chunksRead\",0),this.input=t,this.options=i}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}v.set(\"blob\",class extends Pe{async readWhole(){this.chunked=!1;let e=await U(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,s=this.input.slice(e,i),n=await U(s);return this.set(n,e,!0)}});var Ae=Object.freeze({__proto__:null,default:fe,Exifr:J,fileParsers:S,segmentParsers:k,fileReaders:v,tagKeys:L,tagValues:D,tagRevivers:T,createDictionary:B,extendDictionary:F,fetchUrlAsArrayBuffer:A,readBlobAsArrayBuffer:U,chunkedProps:z,otherSegments:N,segments:V,tiffBlocks:M,segmentsAndBlocks:E,tiffExtractables:R,inheritables:j,allFormatters:G,Options:K,parse:Z,gpsOnlyOptions:de,gps:ce,thumbnailOnlyOptions:ge,thumbnail:pe,thumbnailUrl:me,orientationOnlyOptions:ye,orientation:be,rotations:we,get rotateCanvas(){return Se},get rotateCss(){return ke},rotation:ve});v.set(\"url\",class extends Pe{async readWhole(){this.chunked=!1;let e=await A(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let i=t?e+t-1:void 0,s=this.options.httpHeaders||{};(e||i)&&(s.range=`bytes=${[e,i].join(\"-\")}`);let n=await O(this.input,{headers:s}),r=await n.arrayBuffer(),a=r.byteLength;if(416!==n.status)return a!==t&&(this.size=e+a),this.set(r,e,!0)}});y.prototype.getUint64=function(e){let t=this.getUint32(e),i=this.getUint32(e+4);return t<1048575?t<<32|i:void 0!==typeof a?(console.warn(\"Using BigInt because of type 64uint but JS can only handle 53b numbers.\"),a(t)<<a(32)|a(i)):void u(\"Trying to read 64b value but JS can only handle 53b numbers.\")};class Ue extends ee{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),0===i.length)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),s=e+8;return 1===t&&(t=this.file.getUint64(e+8),s+=8),{offset:e,length:t,kind:i,start:s}}parseBoxFullHead(e){if(void 0!==e.version)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Ie extends Ue{static canHandle(e,t){if(0!==t)return!1;let i=e.getUint16(2);if(i>50)return!1;let s=16,n=[];for(;s<i;)n.push(e.getString(s,4)),s+=4;return n.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;\"meta\"!==t.kind;)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let s=this.file.subarray(t,i);this.createParser(e,s)}async findIcc(e){let t=this.findBox(e,\"iprp\");if(void 0===t)return;let i=this.findBox(t,\"ipco\");if(void 0===i)return;let s=this.findBox(i,\"colr\");void 0!==s&&await this.registerSegment(\"icc\",s.offset+12,s.length)}async findExif(e){let t=this.findBox(e,\"iinf\");if(void 0===t)return;let i=this.findBox(e,\"iloc\");if(void 0===i)return;let s=this.findExifLocIdInIinf(t),n=this.findExtentInIloc(i,s);if(void 0===n)return;let[r,a]=n;await this.file.ensureChunk(r,a);let o=4+this.file.getUint32(r);r+=o,a-=o,await this.registerSegment(\"tiff\",r,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,s,n,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(s=3===t.version?4:2,n=this.file.getString(i+s+2,4),\"Exif\"===n))return this.file.getUintBytes(i,s);r+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[s,n]=this.get8bits(i++),[r,a]=this.get8bits(i++),o=2===e.version?4:2,h=1===e.version||2===e.version?2:0,l=a+s+n,f=2===e.version?4:2,u=this.file.getUintBytes(i,f);for(i+=f;u--;){let e=this.file.getUintBytes(i,o);i+=o+h+2+r;let f=this.file.getUint16(i);if(i+=2,e===t)return f>1&&console.warn(\"ILOC box has more than one extent but we're only processing one\\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file\"),[this.file.getUintBytes(i+a,s),this.file.getUintBytes(i+a+s,n)];i+=f*l}}}class Be extends Ie{}e(Be,\"type\",\"heic\");class Fe extends Ie{}e(Fe,\"type\",\"avif\"),S.set(\"heic\",Be),S.set(\"avif\",Fe),B(L,[\"ifd0\",\"ifd1\"],[[256,\"ImageWidth\"],[257,\"ImageHeight\"],[258,\"BitsPerSample\"],[259,\"Compression\"],[262,\"PhotometricInterpretation\"],[270,\"ImageDescription\"],[271,\"Make\"],[272,\"Model\"],[273,\"StripOffsets\"],[274,\"Orientation\"],[277,\"SamplesPerPixel\"],[278,\"RowsPerStrip\"],[279,\"StripByteCounts\"],[282,\"XResolution\"],[283,\"YResolution\"],[284,\"PlanarConfiguration\"],[296,\"ResolutionUnit\"],[301,\"TransferFunction\"],[305,\"Software\"],[306,\"ModifyDate\"],[315,\"Artist\"],[316,\"HostComputer\"],[317,\"Predictor\"],[318,\"WhitePoint\"],[319,\"PrimaryChromaticities\"],[513,\"ThumbnailOffset\"],[514,\"ThumbnailLength\"],[529,\"YCbCrCoefficients\"],[530,\"YCbCrSubSampling\"],[531,\"YCbCrPositioning\"],[532,\"ReferenceBlackWhite\"],[700,\"ApplicationNotes\"],[33432,\"Copyright\"],[33723,\"IPTC\"],[34665,\"ExifIFD\"],[34675,\"ICC\"],[34853,\"GpsIFD\"],[330,\"SubIFD\"],[40965,\"InteropIFD\"],[40091,\"XPTitle\"],[40092,\"XPComment\"],[40093,\"XPAuthor\"],[40094,\"XPKeywords\"],[40095,\"XPSubject\"]]),B(L,\"exif\",[[33434,\"ExposureTime\"],[33437,\"FNumber\"],[34850,\"ExposureProgram\"],[34852,\"SpectralSensitivity\"],[34855,\"ISO\"],[34858,\"TimeZoneOffset\"],[34859,\"SelfTimerMode\"],[34864,\"SensitivityType\"],[34865,\"StandardOutputSensitivity\"],[34866,\"RecommendedExposureIndex\"],[34867,\"ISOSpeed\"],[34868,\"ISOSpeedLatitudeyyy\"],[34869,\"ISOSpeedLatitudezzz\"],[36864,\"ExifVersion\"],[36867,\"DateTimeOriginal\"],[36868,\"CreateDate\"],[36873,\"GooglePlusUploadCode\"],[36880,\"OffsetTime\"],[36881,\"OffsetTimeOriginal\"],[36882,\"OffsetTimeDigitized\"],[37121,\"ComponentsConfiguration\"],[37122,\"CompressedBitsPerPixel\"],[37377,\"ShutterSpeedValue\"],[37378,\"ApertureValue\"],[37379,\"BrightnessValue\"],[37380,\"ExposureCompensation\"],[37381,\"MaxApertureValue\"],[37382,\"SubjectDistance\"],[37383,\"MeteringMode\"],[37384,\"LightSource\"],[37385,\"Flash\"],[37386,\"FocalLength\"],[37393,\"ImageNumber\"],[37394,\"SecurityClassification\"],[37395,\"ImageHistory\"],[37396,\"SubjectArea\"],[37500,\"MakerNote\"],[37510,\"UserComment\"],[37520,\"SubSecTime\"],[37521,\"SubSecTimeOriginal\"],[37522,\"SubSecTimeDigitized\"],[37888,\"AmbientTemperature\"],[37889,\"Humidity\"],[37890,\"Pressure\"],[37891,\"WaterDepth\"],[37892,\"Acceleration\"],[37893,\"CameraElevationAngle\"],[40960,\"FlashpixVersion\"],[40961,\"ColorSpace\"],[40962,\"ExifImageWidth\"],[40963,\"ExifImageHeight\"],[40964,\"RelatedSoundFile\"],[41483,\"FlashEnergy\"],[41486,\"FocalPlaneXResolution\"],[41487,\"FocalPlaneYResolution\"],[41488,\"FocalPlaneResolutionUnit\"],[41492,\"SubjectLocation\"],[41493,\"ExposureIndex\"],[41495,\"SensingMethod\"],[41728,\"FileSource\"],[41729,\"SceneType\"],[41730,\"CFAPattern\"],[41985,\"CustomRendered\"],[41986,\"ExposureMode\"],[41987,\"WhiteBalance\"],[41988,\"DigitalZoomRatio\"],[41989,\"FocalLengthIn35mmFormat\"],[41990,\"SceneCaptureType\"],[41991,\"GainControl\"],[41992,\"Contrast\"],[41993,\"Saturation\"],[41994,\"Sharpness\"],[41996,\"SubjectDistanceRange\"],[42016,\"ImageUniqueID\"],[42032,\"OwnerName\"],[42033,\"SerialNumber\"],[42034,\"LensInfo\"],[42035,\"LensMake\"],[42036,\"LensModel\"],[42037,\"LensSerialNumber\"],[42080,\"CompositeImage\"],[42081,\"CompositeImageCount\"],[42082,\"CompositeImageExposureTimes\"],[42240,\"Gamma\"],[59932,\"Padding\"],[59933,\"OffsetSchema\"],[65e3,\"OwnerName\"],[65001,\"SerialNumber\"],[65002,\"Lens\"],[65100,\"RawFile\"],[65101,\"Converter\"],[65102,\"WhiteBalance\"],[65105,\"Exposure\"],[65106,\"Shadows\"],[65107,\"Brightness\"],[65108,\"Contrast\"],[65109,\"Saturation\"],[65110,\"Sharpness\"],[65111,\"Smoothness\"],[65112,\"MoireFilter\"],[40965,\"InteropIFD\"]]),B(L,\"gps\",[[0,\"GPSVersionID\"],[1,\"GPSLatitudeRef\"],[2,\"GPSLatitude\"],[3,\"GPSLongitudeRef\"],[4,\"GPSLongitude\"],[5,\"GPSAltitudeRef\"],[6,\"GPSAltitude\"],[7,\"GPSTimeStamp\"],[8,\"GPSSatellites\"],[9,\"GPSStatus\"],[10,\"GPSMeasureMode\"],[11,\"GPSDOP\"],[12,\"GPSSpeedRef\"],[13,\"GPSSpeed\"],[14,\"GPSTrackRef\"],[15,\"GPSTrack\"],[16,\"GPSImgDirectionRef\"],[17,\"GPSImgDirection\"],[18,\"GPSMapDatum\"],[19,\"GPSDestLatitudeRef\"],[20,\"GPSDestLatitude\"],[21,\"GPSDestLongitudeRef\"],[22,\"GPSDestLongitude\"],[23,\"GPSDestBearingRef\"],[24,\"GPSDestBearing\"],[25,\"GPSDestDistanceRef\"],[26,\"GPSDestDistance\"],[27,\"GPSProcessingMethod\"],[28,\"GPSAreaInformation\"],[29,\"GPSDateStamp\"],[30,\"GPSDifferential\"],[31,\"GPSHPositioningError\"]]),B(D,[\"ifd0\",\"ifd1\"],[[274,{1:\"Horizontal (normal)\",2:\"Mirror horizontal\",3:\"Rotate 180\",4:\"Mirror vertical\",5:\"Mirror horizontal and rotate 270 CW\",6:\"Rotate 90 CW\",7:\"Mirror horizontal and rotate 90 CW\",8:\"Rotate 270 CW\"}],[296,{1:\"None\",2:\"inches\",3:\"cm\"}]]);let Le=B(D,\"exif\",[[34850,{0:\"Not defined\",1:\"Manual\",2:\"Normal program\",3:\"Aperture priority\",4:\"Shutter priority\",5:\"Creative program\",6:\"Action program\",7:\"Portrait mode\",8:\"Landscape mode\"}],[37121,{0:\"-\",1:\"Y\",2:\"Cb\",3:\"Cr\",4:\"R\",5:\"G\",6:\"B\"}],[37383,{0:\"Unknown\",1:\"Average\",2:\"CenterWeightedAverage\",3:\"Spot\",4:\"MultiSpot\",5:\"Pattern\",6:\"Partial\",255:\"Other\"}],[37384,{0:\"Unknown\",1:\"Daylight\",2:\"Fluorescent\",3:\"Tungsten (incandescent light)\",4:\"Flash\",9:\"Fine weather\",10:\"Cloudy weather\",11:\"Shade\",12:\"Daylight fluorescent (D 5700 - 7100K)\",13:\"Day white fluorescent (N 4600 - 5400K)\",14:\"Cool white fluorescent (W 3900 - 4500K)\",15:\"White fluorescent (WW 3200 - 3700K)\",17:\"Standard light A\",18:\"Standard light B\",19:\"Standard light C\",20:\"D55\",21:\"D65\",22:\"D75\",23:\"D50\",24:\"ISO studio tungsten\",255:\"Other\"}],[37385,{0:\"Flash did not fire\",1:\"Flash fired\",5:\"Strobe return light not detected\",7:\"Strobe return light detected\",9:\"Flash fired, compulsory flash mode\",13:\"Flash fired, compulsory flash mode, return light not detected\",15:\"Flash fired, compulsory flash mode, return light detected\",16:\"Flash did not fire, compulsory flash mode\",24:\"Flash did not fire, auto mode\",25:\"Flash fired, auto mode\",29:\"Flash fired, auto mode, return light not detected\",31:\"Flash fired, auto mode, return light detected\",32:\"No flash function\",65:\"Flash fired, red-eye reduction mode\",69:\"Flash fired, red-eye reduction mode, return light not detected\",71:\"Flash fired, red-eye reduction mode, return light detected\",73:\"Flash fired, compulsory flash mode, red-eye reduction mode\",77:\"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",79:\"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",89:\"Flash fired, auto mode, red-eye reduction mode\",93:\"Flash fired, auto mode, return light not detected, red-eye reduction mode\",95:\"Flash fired, auto mode, return light detected, red-eye reduction mode\"}],[41495,{1:\"Not defined\",2:\"One-chip color area sensor\",3:\"Two-chip color area sensor\",4:\"Three-chip color area sensor\",5:\"Color sequential area sensor\",7:\"Trilinear sensor\",8:\"Color sequential linear sensor\"}],[41728,{1:\"Film Scanner\",2:\"Reflection Print Scanner\",3:\"Digital Camera\"}],[41729,{1:\"Directly photographed\"}],[41985,{0:\"Normal\",1:\"Custom\",2:\"HDR (no original saved)\",3:\"HDR (original saved)\",4:\"Original (for HDR)\",6:\"Panorama\",7:\"Portrait HDR\",8:\"Portrait\"}],[41986,{0:\"Auto\",1:\"Manual\",2:\"Auto bracket\"}],[41987,{0:\"Auto\",1:\"Manual\"}],[41990,{0:\"Standard\",1:\"Landscape\",2:\"Portrait\",3:\"Night\",4:\"Other\"}],[41991,{0:\"None\",1:\"Low gain up\",2:\"High gain up\",3:\"Low gain down\",4:\"High gain down\"}],[41996,{0:\"Unknown\",1:\"Macro\",2:\"Close\",3:\"Distant\"}],[42080,{0:\"Unknown\",1:\"Not a Composite Image\",2:\"General Composite Image\",3:\"Composite Image Captured While Shooting\"}]]);const De={1:\"No absolute unit of measurement\",2:\"Inch\",3:\"Centimeter\"};Le.set(37392,De),Le.set(41488,De);const Te={0:\"Normal\",1:\"Low\",2:\"High\"};function ze(e){return\"object\"==typeof e&&void 0!==e.length?e[0]:e}function Ne(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),\"0\"!==t[2]&&0!==t[2]||t.pop(),t.join(\".\")}function Ve(e){if(\"string\"==typeof e){var[t,i,s,n,r,a]=e.trim().split(/[-: ]/g).map(Number),o=new Date(t,i-1,s);return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(a)||(o.setHours(n),o.setMinutes(r),o.setSeconds(a)),Number.isNaN(+o)?e:o}}function Me(e){if(\"string\"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let i=0;i<e.length;i+=2)t.push(Ee(e[i+1],e[i]));else for(let i=0;i<e.length;i+=2)t.push(Ee(e[i],e[i+1]));return d(String.fromCodePoint(...t))}function Ee(e,t){return e<<8|t}Le.set(41992,Te),Le.set(41993,Te),Le.set(41994,Te),B(T,[\"ifd0\",\"ifd1\"],[[50827,function(e){return\"string\"!=typeof e?m(e):e}],[306,Ve],[40091,Me],[40092,Me],[40093,Me],[40094,Me],[40095,Me]]),B(T,\"exif\",[[40960,Ne],[36864,Ne],[36867,Ve],[36868,Ve],[40962,ze],[40963,ze]]),B(T,\"gps\",[[0,e=>Array.from(e).join(\".\")],[7,e=>Array.from(e).join(\":\")]]);class Re extends te{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&\"http://ns.adobe.com/\"===e.getString(t+4,\"http://ns.adobe.com/\".length)}static headerLength(e,t){return\"http://ns.adobe.com/xmp/extension/\"===e.getString(t+4,\"http://ns.adobe.com/xmp/extension/\".length)?79:4+\"http://ns.adobe.com/xap/1.0/\".length+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=79===i.headerLength,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join(\"\")}normalizeInput(e){return\"string\"==typeof e?e:y.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={},i={};for(let e of Ye)t[e]=[],i[e]=0;return e.replace(qe,((e,s,n)=>{if(\"<\"===s){let s=++i[n];return t[n].push(s),`${e}#${s}`}return`${e}#${t[n].pop()}`}))}(e);let t=Ge.findAll(e,\"rdf\",\"Description\");0===t.length&&t.push(new Ge(\"rdf\",\"Description\",void 0,e));let i,s={};for(let e of t)for(let t of e.properties)i=$e(t.ns,s),He(t,i);return function(e){let t;for(let i in e)t=e[i]=h(e[i]),void 0===t&&delete e[i];return h(e)}(s)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,s]of Object.entries(t))switch(i){case\"tiff\":this.assignObjectToOutput(e,\"ifd0\",s);break;case\"exif\":this.assignObjectToOutput(e,\"exif\",s);break;case\"xmlns\":break;default:this.assignObjectToOutput(e,i,s)}else e.xmp=t}}e(Re,\"type\",\"xmp\"),e(Re,\"multiSegment\",!0),k.set(\"xmp\",Re);class je{static findAll(e){return Ke(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=(\"[^\"]*\"|'[^']*')/gm).map(je.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],s=e[3].slice(1,-1);return s=Xe(s),new je(t,i,s)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class Ge{static findAll(e,t,i){if(void 0!==t||void 0!==i){t=t||\"[\\\\w\\\\d-]+\",i=i||\"[\\\\w\\\\d-]+\";var s=new RegExp(`<(${t}):(${i})(#\\\\d+)?((\\\\s+?[\\\\w\\\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\\\s*)(\\\\/>|>([\\\\s\\\\S]*?)<\\\\/\\\\1:\\\\2\\\\3>)`,\"gm\")}else s=/<([\\w\\d-]+):([\\w\\d-]+)(#\\d+)?((\\s+?[\\w\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)/gm;return Ke(e,s).map(Ge.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],s=e[4],n=e[8];return new Ge(t,i,s,n)}constructor(e,t,i,s){this.ns=e,this.name=t,this.attrString=i,this.innerXml=s,this.attrs=je.findAll(i),this.children=Ge.findAll(s),this.value=0===this.children.length?Xe(s):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return\"rdf\"===e&&(\"Seq\"===t||\"Bag\"===t||\"Alt\"===t)}get isListItem(){return\"rdf\"===this.ns&&\"li\"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return We(this.children.map(_e));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)He(t,e);return void 0!==this.value&&(e.value=this.value),h(e)}}function He(e,t){let i=e.serialize();void 0!==i&&(t[e.name]=i)}var _e=e=>e.serialize(),We=e=>1===e.length?e[0]:e,$e=(e,t)=>t[e]?t[e]:t[e]={};function Ke(e,t){let i,s=[];if(!e)return s;for(;null!==(i=t.exec(e));)s.push(i);return s}function Xe(e){if(function(e){return null==e||\"null\"===e||\"undefined\"===e||\"\"===e||\"\"===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let i=e.toLowerCase();return\"true\"===i||\"false\"!==i&&e.trim()}const Ye=[\"rdf:li\",\"rdf:Seq\",\"rdf:Bag\",\"rdf:Alt\",\"rdf:Description\"],qe=new RegExp(`(<|\\\\/)(${Ye.join(\"|\")})`,\"g\");export default Ae;export{J as Exifr,K as Options,G as allFormatters,z as chunkedProps,B as createDictionary,F as extendDictionary,A as fetchUrlAsArrayBuffer,S as fileParsers,v as fileReaders,ce as gps,de as gpsOnlyOptions,j as inheritables,be as orientation,ye as orientationOnlyOptions,N as otherSegments,Z as parse,U as readBlobAsArrayBuffer,Se as rotateCanvas,ke as rotateCss,ve as rotation,we as rotations,k as segmentParsers,V as segments,E as segmentsAndBlocks,L as tagKeys,T as tagRevivers,D as tagValues,pe as thumbnail,ge as thumbnailOnlyOptions,me as thumbnailUrl,M as tiffBlocks,R as tiffExtractables};\n", "type Request = Promise<any> & {\n  cancel: () => void;\n};\n\ninterface IScheduleRequest {\n  ref: () => Request;\n  cancelled: boolean;\n  completed: boolean;\n  request: WithNull<Request>;\n  cancel: () => void;\n}\n\ninterface RequestSchedulerOptions {\n  maxRequests: number;\n}\n\nconst defaultOptions: RequestSchedulerOptions = {\n  maxRequests: 6,\n};\n\nexport default class RequestScheduler {\n  public options: RequestSchedulerOptions;\n  public requestQueue: IScheduleRequest[];\n  public executing: Set<IScheduleRequest>;\n\n  constructor(options: Partial<RequestSchedulerOptions>) {\n    this.options = {\n      ...defaultOptions,\n      ...options,\n    };\n    this.requestQueue = [];\n    this.executing = new Set();\n  }\n\n  remove(p) {\n    this.executing.delete(p);\n    if (!p.cancelled) {\n      p.completed = true;\n      this.enqueue();\n    }\n  }\n\n  enqueue() {\n    for (\n      let numImageRequests = this.executing.size;\n      numImageRequests < this.options.maxRequests && this.requestQueue.length > 0;\n      numImageRequests++\n    ) {\n      const q = this.requestQueue.shift() as IScheduleRequest;\n      if (q.cancelled) {\n        this.remove(q);\n        continue;\n      }\n\n      const p = Promise.resolve().then(() => {\n        const request = q.ref();\n        q.request = request;\n        return request;\n      });\n      this.executing.add(q);\n      p.then(() => {\n        this.remove(q);\n      }).catch(() => {\n        this.remove(q);\n      });\n    }\n  }\n\n  scheduleRequest(fn) {\n    const request: IScheduleRequest = {\n      ref: fn,\n      cancelled: false,\n      completed: false,\n      request: null,\n      cancel: () => {\n        if (!request.completed && !request.cancelled) {\n          request.cancelled = true;\n\n          if (request.request) {\n            request.request.cancel();\n          }\n          this.enqueue();\n        }\n      },\n    };\n\n    this.requestQueue.push(request);\n\n    this.enqueue();\n\n    return request;\n  }\n}\n", "/* eslint-disable */\nvar _bin = {\n  nextZero   : function(data,p)  {  while(data[p]!=0) p++;  return p;  },\n  readUshort : function(buff,p)  {  return (buff[p]<< 8) | buff[p+1];  },\n  writeUshort: function(buff,p,n){  buff[p] = (n>>8)&255;  buff[p+1] = n&255;  },\n  readUint   : function(buff,p)  {  return (buff[p]*(256*256*256)) + ((buff[p+1]<<16) | (buff[p+2]<< 8) | buff[p+3]);  },\n  writeUint  : function(buff,p,n){  buff[p]=(n>>24)&255;  buff[p+1]=(n>>16)&255;  buff[p+2]=(n>>8)&255;  buff[p+3]=n&255;  },\n  readASCII  : function(buff,p,l){  var s = \"\";  for(var i=0; i<l; i++) s += String.fromCharCode(buff[p+i]);  return s;    },\n  writeASCII : function(data,p,s){  for(var i=0; i<s.length; i++) data[p+i] = s.charCodeAt(i);  },\n  readBytes  : function(buff,p,l){  var arr = [];   for(var i=0; i<l; i++) arr.push(buff[p+i]);   return arr;  },\n  pad : function(n) { return n.length < 2 ? \"0\" + n : n; },\n  readUTF8 : function(buff, p, l) {\n    var s = \"\", ns;\n    for(var i=0; i<l; i++) s += \"%\" + _bin.pad(buff[p+i].toString(16));\n    try {  ns = decodeURIComponent(s); }\n    catch(e) {  return _bin.readASCII(buff, p, l);  }\n    return  ns;\n  }\n}\n\nfunction toRGBA8(out) {\n  var w = out.width, h = out.height;\n  if(out.tabs.acTL==null) return [decodeImage(out.data, w, h, out).buffer];\n\n  var frms = [];\n  if(out.frames[0].data==null) out.frames[0].data = out.data;\n\n  var len = w*h*4, img = new Uint8Array(len), empty = new Uint8Array(len), prev=new Uint8Array(len);\n  for(var i=0; i<out.frames.length; i++) {\n    var frm = out.frames[i];\n    var fx=frm.rect.x, fy=frm.rect.y, fw = frm.rect.width, fh = frm.rect.height;\n    var fdata = decodeImage(frm.data, fw,fh, out);\n\n    if(i!=0) for(var j=0; j<len; j++) prev[j]=img[j];\n\n    if     (frm.blend==0) _copyTile(fdata, fw, fh, img, w, h, fx, fy, 0);\n    else if(frm.blend==1) _copyTile(fdata, fw, fh, img, w, h, fx, fy, 1);\n\n    frms.push(img.buffer.slice(0));\n\n    if     (frm.dispose==0) {}\n    else if(frm.dispose==1) _copyTile(empty, fw, fh, img, w, h, fx, fy, 0);\n    else if(frm.dispose==2) for(var j=0; j<len; j++) img[j]=prev[j];\n  }\n  return frms;\n}\n\nfunction decodeImage(data, w, h, out) {\n  var area = w*h, bpp = _getBPP(out);\n  var bpl = Math.ceil(w*bpp/8);\t// bytes per line\n\n  var bf = new Uint8Array(area*4), bf32 = new Uint32Array(bf.buffer);\n  var ctype = out.ctype, depth = out.depth;\n  var rs = _bin.readUshort;\n\n  //console.log(ctype, depth);\n  var time = Date.now();\n\n  if     (ctype==6) { // RGB + alpha\n    var qarea = area<<2;\n    if(depth== 8) for(var i=0; i<qarea;i+=4) {  bf[i] = data[i];  bf[i+1] = data[i+1];  bf[i+2] = data[i+2];  bf[i+3] = data[i+3]; }\n    if(depth==16) for(var i=0; i<qarea;i++ ) {  bf[i] = data[i<<1];  }\n  }\n  else if(ctype==2) {\t// RGB\n    var ts=out.tabs[\"tRNS\"];\n    if(ts==null) {\n      if(depth== 8) for(var i=0; i<area; i++) {  var ti=i*3;  bf32[i] = (255<<24)|(data[ti+2]<<16)|(data[ti+1]<<8)|data[ti];  }\n      if(depth==16) for(var i=0; i<area; i++) {  var ti=i*6;  bf32[i] = (255<<24)|(data[ti+4]<<16)|(data[ti+2]<<8)|data[ti];  }\n    }\n    else {  var tr=ts[0], tg=ts[1], tb=ts[2];\n      if(depth== 8) for(var i=0; i<area; i++) {  var qi=i<<2, ti=i*3;  bf32[i] = (255<<24)|(data[ti+2]<<16)|(data[ti+1]<<8)|data[ti];\n        if(data[ti]   ==tr && data[ti+1]   ==tg && data[ti+2]   ==tb) bf[qi+3] = 0;  }\n      if(depth==16) for(var i=0; i<area; i++) {  var qi=i<<2, ti=i*6;  bf32[i] = (255<<24)|(data[ti+4]<<16)|(data[ti+2]<<8)|data[ti];\n        if(rs(data,ti)==tr && rs(data,ti+2)==tg && rs(data,ti+4)==tb) bf[qi+3] = 0;  }\n    }\n  }\n  else if(ctype==3) {\t// palette\n    var p=out.tabs[\"PLTE\"], ap=out.tabs[\"tRNS\"], tl=ap?ap.length:0;\n    //console.log(p, ap);\n    if(depth==1) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n      for(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>3)]>>(7-((i&7)<<0)))& 1), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n    }\n    if(depth==2) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n      for(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>2)]>>(6-((i&3)<<1)))& 3), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n    }\n    if(depth==4) for(var y=0; y<h; y++) {  var s0 = y*bpl, t0 = y*w;\n      for(var i=0; i<w; i++) { var qi=(t0+i)<<2, j=((data[s0+(i>>1)]>>(4-((i&1)<<2)))&15), cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n    }\n    if(depth==8) for(var i=0; i<area; i++ ) {  var qi=i<<2, j=data[i]                      , cj=3*j;  bf[qi]=p[cj];  bf[qi+1]=p[cj+1];  bf[qi+2]=p[cj+2];  bf[qi+3]=(j<tl)?ap[j]:255;  }\n  }\n  else if(ctype==4) {\t// gray + alpha\n    if(depth== 8)  for(var i=0; i<area; i++) {  var qi=i<<2, di=i<<1, gr=data[di];  bf[qi]=gr;  bf[qi+1]=gr;  bf[qi+2]=gr;  bf[qi+3]=data[di+1];  }\n    if(depth==16)  for(var i=0; i<area; i++) {  var qi=i<<2, di=i<<2, gr=data[di];  bf[qi]=gr;  bf[qi+1]=gr;  bf[qi+2]=gr;  bf[qi+3]=data[di+2];  }\n  }\n  else if(ctype==0) {\t// gray\n    var tr = out.tabs[\"tRNS\"] ? out.tabs[\"tRNS\"] : -1;\n    for(var y=0; y<h; y++) {\n      var off = y*bpl, to = y*w;\n      if     (depth== 1) for(var x=0; x<w; x++) {  var gr=255*((data[off+(x>>>3)]>>>(7 -((x&7)   )))& 1), al=(gr==tr*255)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n      else if(depth== 2) for(var x=0; x<w; x++) {  var gr= 85*((data[off+(x>>>2)]>>>(6 -((x&3)<<1)))& 3), al=(gr==tr* 85)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n      else if(depth== 4) for(var x=0; x<w; x++) {  var gr= 17*((data[off+(x>>>1)]>>>(4 -((x&1)<<2)))&15), al=(gr==tr* 17)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n      else if(depth== 8) for(var x=0; x<w; x++) {  var gr=data[off+     x], al=(gr                 ==tr)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n      else if(depth==16) for(var x=0; x<w; x++) {  var gr=data[off+(x<<1)], al=(rs(data,off+(x<<1))==tr)?0:255;  bf32[to+x]=(al<<24)|(gr<<16)|(gr<<8)|gr;  }\n    }\n  }\n  //console.log(Date.now()-time);\n  return bf;\n}\n\nfunction decode(buff) {\n  var data = new Uint8Array(buff), offset = 8, bin = _bin, rUs = bin.readUshort, rUi = bin.readUint;\n  var out = {tabs:{}, frames:[]};\n  var dd = new Uint8Array(data.length), doff = 0;\t // put all IDAT data into it\n  var fd, foff = 0;\t// frames\n\n  var mgck = [0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a];\n  for(var i=0; i<8; i++) if(data[i]!=mgck[i]) throw \"The input is not a PNG file!\";\n\n  while(offset<data.length)\n  {\n    var len  = bin.readUint(data, offset);  offset += 4;\n    var type = bin.readASCII(data, offset, 4);  offset += 4;\n    //console.log(type,len);\n\n    if     (type==\"IHDR\")  {  _IHDR(data, offset, out);  }\n    else if(type==\"iCCP\")  {\n      var off = offset;  while(data[off]!=0) off++;\n      var nam = bin.readASCII(data,offset,off-offset);\n      var cpr = data[off+1];\n      var fil = data.slice(off+2,offset+len);\n      var res = null;\n      try { res = _inflate(fil); } catch(e) {  res = inflateRaw(fil);  }\n      out.tabs[type] = res;\n    }\n    else if(type==\"CgBI\")  {  out.tabs[type] = data.slice(offset,offset+4);  }\n    else if(type==\"IDAT\") {\n      for(var i=0; i<len; i++) dd[doff+i] = data[offset+i];\n      doff += len;\n    }\n    else if(type==\"acTL\")  {\n      out.tabs[type] = {  num_frames:rUi(data, offset), num_plays:rUi(data, offset+4)  };\n      fd = new Uint8Array(data.length);\n    }\n    else if(type==\"fcTL\")  {\n      if(foff!=0) {  var fr = out.frames[out.frames.length-1];\n        fr.data = _decompress(out, fd.slice(0,foff), fr.rect.width, fr.rect.height);  foff=0;\n      }\n      var rct = {x:rUi(data, offset+12),y:rUi(data, offset+16),width:rUi(data, offset+4),height:rUi(data, offset+8)};\n      var del = rUs(data, offset+22);  del = rUs(data, offset+20) / (del==0?100:del);\n      var frm = {rect:rct, delay:Math.round(del*1000), dispose:data[offset+24], blend:data[offset+25]};\n      //console.log(frm);\n      out.frames.push(frm);\n    }\n    else if(type==\"fdAT\") {\n      for(var i=0; i<len-4; i++) fd[foff+i] = data[offset+i+4];\n      foff += len-4;\n    }\n    else if(type==\"pHYs\") {\n      out.tabs[type] = [bin.readUint(data, offset), bin.readUint(data, offset+4), data[offset+8]];\n    }\n    else if(type==\"cHRM\") {\n      out.tabs[type] = [];\n      for(var i=0; i<8; i++) out.tabs[type].push(bin.readUint(data, offset+i*4));\n    }\n    else if(type==\"tEXt\" || type==\"zTXt\") {\n      if(out.tabs[type]==null) out.tabs[type] = {};\n      var nz = bin.nextZero(data, offset);\n      var keyw = bin.readASCII(data, offset, nz-offset);\n      var text, tl=offset+len-nz-1;\n      if(type==\"tEXt\") text = bin.readASCII(data, nz+1, tl);\n      else {\n        var bfr = _inflate(data.slice(nz+2,nz+2+tl));\n        text = bin.readUTF8(bfr,0,bfr.length);\n      }\n      out.tabs[type][keyw] = text;\n    }\n    else if(type==\"iTXt\") {\n      if(out.tabs[type]==null) out.tabs[type] = {};\n      var nz = 0, off = offset;\n      nz = bin.nextZero(data, off);\n      var keyw = bin.readASCII(data, off, nz-off);  off = nz + 1;\n      var cflag = data[off], cmeth = data[off+1];  off+=2;\n      nz = bin.nextZero(data, off);\n      var ltag = bin.readASCII(data, off, nz-off);  off = nz + 1;\n      nz = bin.nextZero(data, off);\n      var tkeyw = bin.readUTF8(data, off, nz-off);  off = nz + 1;\n      var text, tl=len-(off-offset);\n      if(cflag==0) text  = bin.readUTF8(data, off, tl);\n      else {\n        var bfr = _inflate(data.slice(off,off+tl));\n        text = bin.readUTF8(bfr,0,bfr.length);\n      }\n      out.tabs[type][keyw] = text;\n    }\n    else if(type==\"PLTE\") {\n      out.tabs[type] = bin.readBytes(data, offset, len);\n    }\n    else if(type==\"hIST\") {\n      var pl = out.tabs[\"PLTE\"].length/3;\n      out.tabs[type] = [];  for(var i=0; i<pl; i++) out.tabs[type].push(rUs(data, offset+i*2));\n    }\n    else if(type==\"tRNS\") {\n      if     (out.ctype==3) out.tabs[type] = bin.readBytes(data, offset, len);\n      else if(out.ctype==0) out.tabs[type] = rUs(data, offset);\n      else if(out.ctype==2) out.tabs[type] = [ rUs(data,offset),rUs(data,offset+2),rUs(data,offset+4) ];\n      //else console.log(\"tRNS for unsupported color type\",out.ctype, len);\n    }\n    else if(type==\"gAMA\") out.tabs[type] = bin.readUint(data, offset)/100000;\n    else if(type==\"sRGB\") out.tabs[type] = data[offset];\n    else if(type==\"bKGD\")\n    {\n      if     (out.ctype==0 || out.ctype==4) out.tabs[type] = [rUs(data, offset)];\n      else if(out.ctype==2 || out.ctype==6) out.tabs[type] = [rUs(data, offset), rUs(data, offset+2), rUs(data, offset+4)];\n      else if(out.ctype==3) out.tabs[type] = data[offset];\n    }\n    else if(type==\"IEND\") {\n      break;\n    }\n    //else {  console.log(\"unknown chunk type\", type, len);  out.tabs[type]=data.slice(offset,offset+len);  }\n    offset += len;\n    var crc = bin.readUint(data, offset);  offset += 4;\n  }\n  if(foff!=0) {  var fr = out.frames[out.frames.length-1];\n    fr.data = _decompress(out, fd.slice(0,foff), fr.rect.width, fr.rect.height);\n  }\n  out.data = _decompress(out, dd, out.width, out.height);\n\n  delete out.compress;  delete out.interlace;  delete out.filter;\n  return out;\n}\n\nfunction _decompress(out, dd, w, h) {\n  var bpp = _getBPP(out), bpl = Math.ceil(w*bpp/8), buff = new Uint8Array((bpl+1+out.interlace)*h);\n  if(out.tabs[\"CgBI\"]) dd = inflateRaw(dd,buff);\n  else                 dd = _inflate(dd,buff);\n\n  if     (out.interlace==0) dd = _filterZero(dd, out, 0, w, h);\n  else if(out.interlace==1) dd = _readInterlace(dd, out);\n  return dd;\n}\n\nfunction _inflate(data, buff) {  var out=inflateRaw(new Uint8Array(data.buffer, 2,data.length-6),buff);  return out;  }\n\nvar inflateRaw=function(){var H={};H.H={};H.H.N=function(N,W){var R=Uint8Array,i=0,m=0,J=0,h=0,Q=0,X=0,u=0,w=0,d=0,v,C;\n  if(N[0]==3&&N[1]==0)return W?W:new R(0);var V=H.H,n=V.b,A=V.e,l=V.R,M=V.n,I=V.A,e=V.Z,b=V.m,Z=W==null;\n  if(Z)W=new R(N.length>>>2<<5);while(i==0){i=n(N,d,1);m=n(N,d+1,2);d+=3;if(m==0){if((d&7)!=0)d+=8-(d&7);\n    var D=(d>>>3)+4,q=N[D-4]|N[D-3]<<8;if(Z)W=H.H.W(W,w+q);W.set(new R(N.buffer,N.byteOffset+D,q),w);d=D+q<<3;\n    w+=q;continue}if(Z)W=H.H.W(W,w+(1<<17));if(m==1){v=b.J;C=b.h;X=(1<<9)-1;u=(1<<5)-1}if(m==2){J=A(N,d,5)+257;\n    h=A(N,d+5,5)+1;Q=A(N,d+10,4)+4;d+=14;var E=d,j=1;for(var c=0;c<38;c+=2){b.Q[c]=0;b.Q[c+1]=0}for(var c=0;\n                                                                                                    c<Q;c++){var K=A(N,d+c*3,3);b.Q[(b.X[c]<<1)+1]=K;if(K>j)j=K}d+=3*Q;M(b.Q,j);I(b.Q,j,b.u);v=b.w;C=b.d;\n    d=l(b.u,(1<<j)-1,J+h,N,d,b.v);var r=V.V(b.v,0,J,b.C);X=(1<<r)-1;var S=V.V(b.v,J,h,b.D);u=(1<<S)-1;M(b.C,r);\n    I(b.C,r,v);M(b.D,S);I(b.D,S,C)}while(!0){var T=v[e(N,d)&X];d+=T&15;var p=T>>>4;if(p>>>8==0){W[w++]=p}else if(p==256){break}else{var z=w+p-254;\n    if(p>264){var _=b.q[p-257];z=w+(_>>>3)+A(N,d,_&7);d+=_&7}var $=C[e(N,d)&u];d+=$&15;var s=$>>>4,Y=b.c[s],a=(Y>>>4)+n(N,d,Y&15);\n    d+=Y&15;while(w<z){W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a];W[w]=W[w++-a]}w=z}}}return W.length==w?W:W.slice(0,w)};\n  H.H.W=function(N,W){var R=N.length;if(W<=R)return N;var V=new Uint8Array(R<<1);V.set(N,0);return V};\n  H.H.R=function(N,W,R,V,n,A){var l=H.H.e,M=H.H.Z,I=0;while(I<R){var e=N[M(V,n)&W];n+=e&15;var b=e>>>4;\n    if(b<=15){A[I]=b;I++}else{var Z=0,m=0;if(b==16){m=3+l(V,n,2);n+=2;Z=A[I-1]}else if(b==17){m=3+l(V,n,3);\n      n+=3}else if(b==18){m=11+l(V,n,7);n+=7}var J=I+m;while(I<J){A[I]=Z;I++}}}return n};H.H.V=function(N,W,R,V){var n=0,A=0,l=V.length>>>1;\n    while(A<R){var M=N[A+W];V[A<<1]=0;V[(A<<1)+1]=M;if(M>n)n=M;A++}while(A<l){V[A<<1]=0;V[(A<<1)+1]=0;A++}return n};\n  H.H.n=function(N,W){var R=H.H.m,V=N.length,n,A,l,M,I,e=R.j;for(var M=0;M<=W;M++)e[M]=0;for(M=1;M<V;M+=2)e[N[M]]++;\n    var b=R.K;n=0;e[0]=0;for(A=1;A<=W;A++){n=n+e[A-1]<<1;b[A]=n}for(l=0;l<V;l+=2){I=N[l+1];if(I!=0){N[l]=b[I];\n      b[I]++}}};H.H.A=function(N,W,R){var V=N.length,n=H.H.m,A=n.r;for(var l=0;l<V;l+=2)if(N[l+1]!=0){var M=l>>1,I=N[l+1],e=M<<4|I,b=W-I,Z=N[l]<<b,m=Z+(1<<b);\n    while(Z!=m){var J=A[Z]>>>15-W;R[J]=e;Z++}}};H.H.l=function(N,W){var R=H.H.m.r,V=15-W;for(var n=0;n<N.length;\n                                                                                             n+=2){var A=N[n]<<W-N[n+1];N[n]=R[A]>>>V}};H.H.M=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8};\n  H.H.I=function(N,W,R){R=R<<(W&7);var V=W>>>3;N[V]|=R;N[V+1]|=R>>>8;N[V+2]|=R>>>16};H.H.e=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8)>>>(W&7)&(1<<R)-1};\n  H.H.b=function(N,W,R){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)&(1<<R)-1};H.H.Z=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16)>>>(W&7)};\n  H.H.i=function(N,W){return(N[W>>>3]|N[(W>>>3)+1]<<8|N[(W>>>3)+2]<<16|N[(W>>>3)+3]<<24)>>>(W&7)};H.H.m=function(){var N=Uint16Array,W=Uint32Array;\n    return{K:new N(16),j:new N(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new N(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new W(32),J:new N(512),_:[],h:new N(32),$:[],w:new N(32768),C:[],v:[],d:new N(32768),D:[],u:new N(512),Q:[],r:new N(1<<15),s:new W(286),Y:new W(30),a:new W(19),t:new W(15e3),k:new N(1<<16),g:new N(1<<15)}}();\n  (function(){var N=H.H.m,W=1<<15;for(var R=0;R<W;R++){var V=R;V=(V&2863311530)>>>1|(V&1431655765)<<1;\n    V=(V&3435973836)>>>2|(V&858993459)<<2;V=(V&4042322160)>>>4|(V&252645135)<<4;V=(V&4278255360)>>>8|(V&16711935)<<8;\n    N.r[R]=(V>>>16|V<<16)>>>17}function n(A,l,M){while(l--!=0)A.push(0,M)}for(var R=0;R<32;R++){N.q[R]=N.S[R]<<3|N.T[R];\n    N.c[R]=N.p[R]<<4|N.z[R]}n(N._,144,8);n(N._,255-143,9);n(N._,279-255,7);n(N._,287-279,8);H.H.n(N._,9);\n    H.H.A(N._,9,N.J);H.H.l(N._,9);n(N.$,32,5);H.H.n(N.$,5);H.H.A(N.$,5,N.h);H.H.l(N.$,5);n(N.Q,19,0);n(N.C,286,0);\n    n(N.D,30,0);n(N.v,320,0)}());return H.H.N}()\n\n\nfunction _readInterlace(data, out) {\n  var w = out.width, h = out.height;\n  var bpp = _getBPP(out), cbpp = bpp>>3, bpl = Math.ceil(w*bpp/8);\n  var img = new Uint8Array( h * bpl );\n  var di = 0;\n\n  var starting_row  = [ 0, 0, 4, 0, 2, 0, 1 ];\n  var starting_col  = [ 0, 4, 0, 2, 0, 1, 0 ];\n  var row_increment = [ 8, 8, 8, 4, 4, 2, 2 ];\n  var col_increment = [ 8, 8, 4, 4, 2, 2, 1 ];\n\n  var pass=0;\n  while(pass<7)\n  {\n    var ri = row_increment[pass], ci = col_increment[pass];\n    var sw = 0, sh = 0;\n    var cr = starting_row[pass];  while(cr<h) {  cr+=ri;  sh++;  }\n    var cc = starting_col[pass];  while(cc<w) {  cc+=ci;  sw++;  }\n    var bpll = Math.ceil(sw*bpp/8);\n    _filterZero(data, out, di, sw, sh);\n\n    var y=0, row = starting_row[pass];\n    while(row<h)\n    {\n      var col = starting_col[pass];\n      var cdi = (di+y*bpll)<<3;\n\n      while(col<w)\n      {\n        if(bpp==1) {\n          var val = data[cdi>>3];  val = (val>>(7-(cdi&7)))&1;\n          img[row*bpl + (col>>3)] |= (val << (7-((col&7)<<0)));\n        }\n        if(bpp==2) {\n          var val = data[cdi>>3];  val = (val>>(6-(cdi&7)))&3;\n          img[row*bpl + (col>>2)] |= (val << (6-((col&3)<<1)));\n        }\n        if(bpp==4) {\n          var val = data[cdi>>3];  val = (val>>(4-(cdi&7)))&15;\n          img[row*bpl + (col>>1)] |= (val << (4-((col&1)<<2)));\n        }\n        if(bpp>=8) {\n          var ii = row*bpl+col*cbpp;\n          for(var j=0; j<cbpp; j++) img[ii+j] = data[(cdi>>3)+j];\n        }\n        cdi+=bpp;  col+=ci;\n      }\n      y++;  row += ri;\n    }\n    if(sw*sh!=0) di += sh * (1 + bpll);\n    pass = pass + 1;\n  }\n  return img;\n}\n\nfunction _getBPP(out) {\n  var noc = [1,null,3,1,2,null,4][out.ctype];\n  return noc * out.depth;\n}\n\nfunction _filterZero(data, out, off, w, h) {\n  var bpp = _getBPP(out), bpl = Math.ceil(w*bpp/8);\n  bpp = Math.ceil(bpp/8);\n\n  var i,di, type=data[off], x=0;\n\n  if(type>1) data[off]=[0,0,1][type-2];\n  if(type==3) for(x=bpp; x<bpl; x++) data[x+1] = (data[x+1] + (data[x+1-bpp]>>>1) )&255;\n\n  for(var y=0; y<h; y++)  {\n    i = off+y*bpl; di = i+y+1;\n    type = data[di-1]; x=0;\n\n    if     (type==0)   for(; x<bpl; x++) data[i+x] = data[di+x];\n    else if(type==1) { for(; x<bpp; x++) data[i+x] = data[di+x];\n      for(; x<bpl; x++) data[i+x] = (data[di+x] + data[i+x-bpp]);  }\n    else if(type==2) { for(; x<bpl; x++) data[i+x] = (data[di+x] + data[i+x-bpl]);  }\n    else if(type==3) { for(; x<bpp; x++) data[i+x] = (data[di+x] + ( data[i+x-bpl]>>>1));\n      for(; x<bpl; x++) data[i+x] = (data[di+x] + ((data[i+x-bpl]+data[i+x-bpp])>>>1) );  }\n    else             { for(; x<bpp; x++) data[i+x] = (data[di+x] + _paeth(0, data[i+x-bpl], 0));\n      for(; x<bpl; x++) data[i+x] = (data[di+x] + _paeth(data[i+x-bpp], data[i+x-bpl], data[i+x-bpp-bpl]) );  }\n  }\n  return data;\n}\n\nfunction _paeth(a,b,c) {\n  var p = a+b-c, pa = (p-a), pb = (p-b), pc = (p-c);\n  if (pa*pa <= pb*pb && pa*pa <= pc*pc)  return a;\n  else if (pb*pb <= pc*pc)  return b;\n  return c;\n}\n\nfunction _IHDR(data, offset, out) {\n  out.width  = _bin.readUint(data, offset);  offset += 4;\n  out.height = _bin.readUint(data, offset);  offset += 4;\n  out.depth     = data[offset];  offset++;\n  out.ctype     = data[offset];  offset++;\n  out.compress  = data[offset];  offset++;\n  out.filter    = data[offset];  offset++;\n  out.interlace = data[offset];  offset++;\n}\n\nfunction _copyTile(sb, sw, sh, tb, tw, th, xoff, yoff, mode) {\n  var w = Math.min(sw,tw), h = Math.min(sh,th);\n  var si=0, ti=0;\n  for(var y=0; y<h; y++)\n    for(var x=0; x<w; x++)\n    {\n      if(xoff>=0 && yoff>=0) {  si = (y*sw+x)<<2;  ti = (( yoff+y)*tw+xoff+x)<<2;  }\n      else                   {  si = ((-yoff+y)*sw-xoff+x)<<2;  ti = (y*tw+x)<<2;  }\n\n      if     (mode==0) {  tb[ti] = sb[si];  tb[ti+1] = sb[si+1];  tb[ti+2] = sb[si+2];  tb[ti+3] = sb[si+3];  }\n      else if(mode==1) {\n        var fa = sb[si+3]*(1/255), fr=sb[si]*fa, fg=sb[si+1]*fa, fb=sb[si+2]*fa;\n        var ba = tb[ti+3]*(1/255), br=tb[ti]*ba, bg=tb[ti+1]*ba, bb=tb[ti+2]*ba;\n\n        var ifa=1-fa, oa = fa+ba*ifa, ioa = (oa==0?0:1/oa);\n        tb[ti+3] = 255*oa;\n        tb[ti+0] = (fr+br*ifa)*ioa;\n        tb[ti+1] = (fg+bg*ifa)*ioa;\n        tb[ti+2] = (fb+bb*ifa)*ioa;\n      }\n      else if(mode==2){\t// copy only differences, otherwise zero\n        var fa = sb[si+3], fr=sb[si], fg=sb[si+1], fb=sb[si+2];\n        var ba = tb[ti+3], br=tb[ti], bg=tb[ti+1], bb=tb[ti+2];\n        if(fa==ba && fr==br && fg==bg && fb==bb) {  tb[ti]=0;  tb[ti+1]=0;  tb[ti+2]=0;  tb[ti+3]=0;  }\n        else {  tb[ti]=fr;  tb[ti+1]=fg;  tb[ti+2]=fb;  tb[ti+3]=fa;  }\n      }\n      else if(mode==3){\t// check if can be blended\n        var fa = sb[si+3], fr=sb[si], fg=sb[si+1], fb=sb[si+2];\n        var ba = tb[ti+3], br=tb[ti], bg=tb[ti+1], bb=tb[ti+2];\n        if(fa==ba && fr==br && fg==bg && fb==bb) continue;\n        //if(fa!=255 && ba!=0) return false;\n        if(fa<220 && ba>20) return false;\n      }\n    }\n  return true;\n}\n\nexport {\n  decode,\n  toRGBA8,\n  _paeth,\n  _copyTile,\n  _bin\n};\n", "import { parse } from 'exifr/dist/lite.esm';\nimport RequestScheduler from './RequestScheduler';\nimport { arrayBufferToImageBitmap, getReferrer, isWorker, warnOnce, parseMetedata, isImageBitmap } from './util';\nimport { decode, toRGBA8 } from './UPNG';\n\nexport interface RequestParameters {\n  url: string;\n  headers?: any;\n  method?: 'GET' | 'POST' | 'PUT';\n  body?: string;\n  type?: 'string' | 'json' | 'arrayBuffer';\n  credentials?: 'same-origin' | 'include';\n  collectResourceTiming?: boolean;\n}\n\nexport type ResponseCallback<T> = (\n  error?: Error | null,\n  data?: T | null,\n  cacheControl?: string | null,\n  expires?: string | null,\n) => void;\n\n/**\n * An error thrown when a HTTP request results in an error response.\n * @extends Error\n * @param {number} status The response's HTTP status code.\n * @param {string} statusText The response's HTTP status text.\n * @param {string} url The request's URL.\n * @param {Blob} body The response's body.\n */\nexport class AJAXError extends Error {\n  /**\n   * The response's HTTP status code.\n   */\n  status: number;\n\n  /**\n   * The response's HTTP status text.\n   */\n  statusText: string;\n\n  /**\n   * The request's URL.\n   */\n  url: string;\n\n  /**\n   * The response's body.\n   */\n  body: Blob;\n\n  constructor(status: number, statusText: string, url: string, body: Blob) {\n    super(`AJAXError: ${statusText} (${status}): ${url}`);\n    this.status = status;\n    this.statusText = statusText;\n    this.url = url;\n    this.body = body;\n  }\n}\n\nconst isFileURL = (url) => /^file:/.test(url) || (/^file:/.test(getReferrer()) && !/^\\w+:/.test(url));\n\nfunction makeFetchRequest(requestParameters: RequestParameters, callback: ResponseCallback<any>): Cancelable {\n  const controller = new AbortController();\n  const request = new Request(requestParameters.url, {\n    method: requestParameters.method || 'GET',\n    body: requestParameters.body,\n    credentials: requestParameters.credentials,\n    headers: requestParameters.headers,\n    referrer: getReferrer(),\n    signal: controller.signal,\n  });\n  let complete = false;\n  let aborted = false;\n\n  if (requestParameters.type === 'json') {\n    request.headers.set('Accept', 'application/json');\n  }\n\n  const validateOrFetch = (err, cachedResponse?, responseIsFresh?) => {\n    if (aborted) return;\n\n    if (err) {\n      // Do fetch in case of cache error.\n      // HTTP pages in Edge trigger a security error that can be ignored.\n      if (err.message !== 'SecurityError') {\n        warnOnce(err);\n      }\n    }\n\n    if (cachedResponse && responseIsFresh) {\n      // eslint-disable-next-line @typescript-eslint/no-use-before-define\n      return finishRequest(cachedResponse);\n    }\n\n    if (cachedResponse) {\n      // We can't do revalidation with 'If-None-Match' because then the\n      // request doesn't have simple cors headers.\n    }\n\n    fetch(request)\n      .then((response) => {\n        if (response.ok) {\n          // eslint-disable-next-line @typescript-eslint/no-use-before-define\n          return finishRequest(response);\n        } else {\n          return response\n            .blob()\n            .then((body) => callback(new AJAXError(response.status, response.statusText, requestParameters.url, body)));\n        }\n      })\n      .catch((error) => {\n        if (error.code === 20) {\n          // silence expected AbortError\n          // return;\n        }\n        callback(new Error(error.message));\n      });\n  };\n\n  const finishRequest = (response) => {\n    (requestParameters.type === 'arrayBuffer'\n      ? response.arrayBuffer()\n      : requestParameters.type === 'json'\n        ? response.json()\n        : response.text()\n    )\n      .then((result) => {\n        if (aborted) return;\n        complete = true;\n        callback(null, result, response.headers.get('Cache-Control'), response.headers.get('Expires'));\n      })\n      .catch((err) => {\n        if (!aborted) callback(new Error(err.message));\n      });\n  };\n\n  validateOrFetch(null, null);\n\n  return {\n    cancel: () => {\n      aborted = true;\n      if (!complete) controller.abort();\n    },\n  };\n}\n\nfunction makeXMLHttpRequest(requestParameters: RequestParameters, callback: ResponseCallback<any>): Cancelable {\n  const xhr: XMLHttpRequest = new XMLHttpRequest();\n\n  xhr.open(requestParameters.method || 'GET', requestParameters.url, true);\n  if (requestParameters.type === 'arrayBuffer') {\n    xhr.responseType = 'arraybuffer';\n  }\n  for (const k in requestParameters.headers) {\n    xhr.setRequestHeader(k, requestParameters.headers[k]);\n  }\n  if (requestParameters.type === 'json') {\n    xhr.responseType = 'text';\n    xhr.setRequestHeader('Accept', 'application/json');\n  }\n  xhr.withCredentials = requestParameters.credentials === 'include';\n  xhr.onerror = () => {\n    callback(new Error(xhr.statusText));\n  };\n  xhr.onload = () => {\n    if (((xhr.status >= 200 && xhr.status < 300) || xhr.status === 0) && xhr.response !== null) {\n      let data: unknown = xhr.response;\n      if (requestParameters.type === 'json') {\n        // We're manually parsing JSON here to get better error messages.\n        try {\n          data = JSON.parse(xhr.response);\n        } catch (err) {\n          return callback(err);\n        }\n      }\n      callback(null, data, xhr.getResponseHeader('Cache-Control'), xhr.getResponseHeader('Expires'));\n    } else {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      const body = new Blob([xhr.response], { type: xhr.getResponseHeader('Content-Type') });\n      callback(new AJAXError(xhr.status, xhr.statusText, requestParameters.url, body));\n    }\n  };\n  xhr.send(requestParameters.body);\n  return { cancel: () => xhr.abort() };\n}\n\nexport const makeRequest = function (\n  requestParameters: RequestParameters,\n  callback: ResponseCallback<any>,\n): Cancelable {\n  // We're trying to use the Fetch API if possible. However, in some situations we can't use it:\n  // - IE11 doesn't support it at all. In this case, we dispatch the request to the main thread so\n  //   that we can get an accruate referrer header.\n  // - Safari exposes window.AbortController, but it doesn't work actually abort any requests in\n  //   some versions (see https://bugs.webkit.org/show_bug.cgi?id=174980#c2)\n  // - Requests for resources with the file:// URI scheme don't work with the Fetch API either. In\n  //   this case we unconditionally use XHR on the current thread since referrers don't matter.\n  if (/:\\/\\//.test(requestParameters.url) && !/^https?:|^file:/.test(requestParameters.url)) {\n    if (isWorker() && (self as any).worker && (self as any).worker.actor) {\n      return (self as any).worker.actor.send('getResource', requestParameters, callback);\n    }\n    if (!isWorker()) {\n      return makeFetchRequest(requestParameters, callback);\n    }\n  }\n  if (!isFileURL(requestParameters.url)) {\n    if (\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      fetch &&\n      Request &&\n      AbortController &&\n      Object.prototype.hasOwnProperty.call(Request.prototype, 'signal')\n    ) {\n      return makeFetchRequest(requestParameters, callback);\n    }\n    if (isWorker() && (self as any).worker && (self as any).worker.actor) {\n      const queueOnMainThread = true;\n      return (self as any).worker.actor.send('getResource', requestParameters, callback, undefined, queueOnMainThread);\n    }\n  }\n  return makeXMLHttpRequest(requestParameters, callback);\n};\n\nlet pool;\n\nexport function getPool() {\n  if (!pool) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    pool = new self.GeoTIFF.Pool();\n  }\n\n  return pool;\n}\n\nexport class RequestAdapter {\n  public requestScheduler: RequestScheduler;\n\n  constructor(options) {\n    this.requestScheduler = new RequestScheduler(options);\n  }\n\n  getResource(mapId: string, params: RequestParameters, callback: ResponseCallback<any>): Cancelable {\n    return makeRequest(params, callback);\n  }\n\n  /**\n   * arrayBuffer 转 Unit8\n   * @param data\n   * @param callback\n   */\n  arrayBuffer2unit8(data: ArrayBuffer, callback: any) {\n    const pngImage = decode(data);\n\n    const pixels = toRGBA8(pngImage);\n    callback(null, {\n      data: new Uint8Array(pixels[0]),\n      width: pngImage.width,\n      height: pngImage.height,\n    });\n  }\n\n  /**\n   * arrayBuffer 转图像\n   * 1. 如果支持 ImageBitmap 则生成 `ImageBitmap` 除了极少数浏览器不支持外兼容性尚可\n   * 2. 在 safari 和移动浏览器下配合 rgba2float 有精度问题，不建议使用\n   * @param data\n   * @param callback\n   */\n  arrayBuffer2Image(data: ArrayBuffer, callback: any) {\n    const imageBitmapSupported = typeof createImageBitmap === 'function';\n    if (imageBitmapSupported) {\n      arrayBufferToImageBitmap(data, callback);\n    } else {\n      this.arrayBuffer2unit8(data, callback);\n    }\n  }\n\n  /**\n   * geotiff 解析\n   * @param data\n   * @param callback\n   */\n  arrayBuffer2tiff(data: ArrayBuffer, callback: any) {\n    // @ts-ignore\n    if (!self.GeoTIFF) {\n      throw new Error('Must config [geotiff](https://github.com/geotiffjs/geotiff.js) dep use `configDeps`');\n    }\n    // @ts-ignore\n    self.GeoTIFF.fromArrayBuffer(data)\n      .then((geotiff) => {\n        geotiff\n          .getImage()\n          .then((image) => {\n            const result: any = {};\n            const fileDirectory = image.fileDirectory;\n\n            const { GeographicTypeGeoKey, ProjectedCSTypeGeoKey } = image.getGeoKeys();\n\n            result.projection = ProjectedCSTypeGeoKey || GeographicTypeGeoKey;\n\n            const height = image.getHeight();\n            result.height = height;\n            const width = image.getWidth();\n            result.width = width;\n\n            const [resolutionX, resolutionY] = image.getResolution();\n            result.pixelHeight = Math.abs(resolutionY);\n            result.pixelWidth = Math.abs(resolutionX);\n\n            const [originX, originY] = image.getOrigin();\n            result.xmin = originX;\n            result.xmax = result.xmin + width * result.pixelWidth;\n            result.ymax = originY;\n            result.ymin = result.ymax - height * result.pixelHeight;\n\n            result.noDataValue = fileDirectory.GDAL_NODATA ? parseFloat(fileDirectory.GDAL_NODATA) : null;\n\n            result.numberOfRasters = fileDirectory.SamplesPerPixel;\n\n            image\n              .readRasters({ pool: getPool() })\n              .then((rasters) => {\n                result.rasters = rasters;\n                const r = rasters[0];\n                if (r) {\n                  let i = 0;\n                  const bands = rasters.length;\n                  const d = new r.constructor(r.length * bands);\n                  for (; i < r.length; i++) {\n                    for (let j = 0; j < bands; j++) {\n                      d[i + j] = rasters[j][i];\n                    }\n                  }\n                  result.data = d;\n                }\n                result.metadata = image.getGDALMetadata();\n                const metadata = parseMetedata(fileDirectory.ImageDescription || '');\n                result.min = metadata.min;\n                result.max = metadata.max;\n                result.isTiff = true;\n                callback(null, result);\n              })\n              .catch((err) => {\n                callback(err);\n              });\n          })\n          .catch((err) => {\n            callback(err);\n          });\n      })\n      .catch((err) => {\n        callback(err);\n      });\n  }\n\n  /**\n   * 解析 exif 信息\n   * @param data\n   * @param callback\n   */\n  parseExif(data: ArrayBuffer, callback: any) {\n    // // @ts-ignore\n    // if (!self.exifr) {\n    //   throw new Error(\n    //     'Must config [exifr](https://github.com/MikeKovarik/exifr) dep use `configDeps`',\n    //   );\n    // }\n    // // @ts-ignore\n    // self.exifr\n    parse(data)\n      .then((res) => {\n        this.arrayBuffer2Image(data, (error, image) => {\n          if (error) {\n            callback(error);\n          } else {\n            callback(null, {\n              data: isImageBitmap(image) ? image : image.data,\n              width: image.width,\n              height: image.height,\n              exif: res,\n              withExif: true,\n            });\n          }\n        });\n      })\n      .catch((err) => {\n        callback(err);\n      });\n  }\n\n  fetch(params, callback) {\n    let aborted = false;\n\n    const r = this.requestScheduler.scheduleRequest(() => {\n      const p = new Promise((resolve) => {\n        const request = makeRequest(params, (...args) => {\n          if (aborted) {\n            resolve(false);\n            return;\n          }\n          callback(...args);\n          resolve(args);\n        });\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        p.cancel = () => {\n          request.cancel();\n        };\n      });\n      return p;\n    });\n\n    return {\n      cancel: () => {\n        aborted = true;\n        r.cancel();\n      },\n    };\n  }\n}\n\nlet request: WithNull<RequestAdapter> = null;\n\nexport default function getRequest(options = {}, force = false): RequestAdapter {\n  if (!request || force) {\n    request = new RequestAdapter(options);\n  }\n  return request;\n}\n", "import { isImageBitmap, isArrayBuffer } from './util';\nimport { AJAXError } from './Request';\n\ninterface SerializedObject<S extends Serialized = any> {\n  [_: string]: S;\n}\n\nexport type Serialized =\n  | null\n  | void\n  | boolean\n  | number\n  | string\n  | boolean\n  | number\n  | string\n  | Date\n  | RegExp\n  | ArrayBuffer\n  | ArrayBufferView\n  | ImageData\n  | ImageBitmap\n  | Blob\n  | Array<Serialized>\n  | SerializedObject;\n\ninterface Registry {\n  [_: string]: {\n    klass: {\n      new (...args: any): any;\n      deserialize?: (input: Serialized) => unknown;\n    };\n    omit: ReadonlyArray<string>;\n    shallow: ReadonlyArray<string>;\n  };\n}\n\ninterface RegisterOptions<T> {\n  omit?: ReadonlyArray<keyof T>;\n  shallow?: ReadonlyArray<keyof T>;\n}\n\nconst registry: Registry = {};\n\n/**\n * Register the given class as serializable.\n *\n * @param name\n * @param klass\n * @param options\n * @param options.omit List of properties to omit from serialization (e.g., cached/computed properties)\n * @param options.shallow List of properties that should be serialized by a simple shallow copy, rather than by a recursive call to serialize().\n *\n * @private\n */\nexport function register<T>(\n  name: string,\n  klass: {\n    new (...args: any): T;\n  },\n  options: RegisterOptions<T> = {},\n) {\n  if (registry[name]) throw new Error(`${name} is already registered.`);\n  (Object.defineProperty as any)(klass, '_classRegistryKey', {\n    value: name,\n    writeable: false,\n  });\n  registry[name] = {\n    klass,\n    omit: (options.omit as ReadonlyArray<string>) || [],\n    shallow: (options.shallow as ReadonlyArray<string>) || [],\n  };\n}\n\nregister('Object', Object);\nregister('Error', Error);\nregister('AJAXError', AJAXError);\n\n/**\n * Serialize the given object for transfer to or from a web worker.\n *\n * For non-builtin types, recursively serialize each property (possibly\n * omitting certain properties - see register()), and package the result along\n * with the constructor's `name` so that the appropriate constructor can be\n * looked up in `deserialize()`.\n *\n * If a `transferables` array is provided, add any transferable objects (i.e.,\n * any ArrayBuffers or ArrayBuffer views) to the list. (If a copy is needed,\n * this should happen in the client code, before using serialize().)\n *\n * @private\n */\nexport function serialize(input: unknown, transferables?: Array<Transferable> | null): Serialized {\n  if (\n    input === null ||\n    input === undefined ||\n    typeof input === 'boolean' ||\n    typeof input === 'number' ||\n    typeof input === 'string' ||\n    input instanceof Boolean ||\n    input instanceof Number ||\n    input instanceof String ||\n    input instanceof Date ||\n    input instanceof RegExp ||\n    input instanceof Blob\n  ) {\n    return input;\n  }\n\n  if (isArrayBuffer(input)) {\n    if (transferables) {\n      transferables.push(input);\n    }\n    return input;\n  }\n\n  if (isImageBitmap(input)) {\n    if (transferables) {\n      transferables.push(input);\n    }\n    return input;\n  }\n\n  if (ArrayBuffer.isView(input)) {\n    const view = input;\n    if (transferables) {\n      transferables.push(view.buffer);\n    }\n    return view;\n  }\n\n  if (input instanceof ImageData) {\n    if (transferables) {\n      transferables.push(input.data.buffer);\n    }\n    return input;\n  }\n\n  if (Array.isArray(input)) {\n    const serialized: Array<Serialized> = [];\n    for (const item of input) {\n      serialized.push(serialize(item, transferables));\n    }\n    return serialized;\n  }\n\n  if (typeof input === 'object') {\n    const klass = input.constructor as any;\n    const name = klass._classRegistryKey;\n    if (!name) {\n      throw new Error(\"can't serialize object of unregistered class\");\n    }\n    if (!registry[name]) throw new Error(`${name} is not registered.`);\n\n    const properties: SerializedObject = klass.serialize\n      ? // (Temporary workaround) allow a class to provide static\n        // `serialize()` and `deserialize()` methods to bypass the generic\n        // approach.\n        // This temporary workaround lets us use the generic serialization\n        // approach for objects whose members include instances of dynamic\n        // StructArray types. Once we refactor StructArray to be static,\n        // we can remove this complexity.\n        (klass.serialize(input, transferables) as SerializedObject)\n      : {};\n\n    if (!klass.serialize) {\n      for (const key in input) {\n        // any cast due to https://github.com/facebook/flow/issues/5393\n        // eslint-disable-next-line no-continue\n        if (!(input as any).hasOwnProperty(key)) continue; // eslint-disable-line no-prototype-builtins\n        // eslint-disable-next-line no-continue\n        if (registry[name].omit.indexOf(key) >= 0) continue;\n        const property = (input as any)[key];\n        properties[key] = registry[name].shallow.indexOf(key) >= 0 ? property : serialize(property, transferables);\n      }\n      if (input instanceof Error) {\n        properties.message = input.message;\n      }\n    } else if (transferables && (properties as any) === transferables[transferables.length - 1]) {\n      throw new Error(\"statically serialized object won't survive transfer of $name property\");\n    }\n\n    if (properties.$name) {\n      throw new Error('$name property is reserved for worker serialization logic.');\n    }\n    if (name !== 'Object') {\n      properties.$name = name;\n    }\n\n    return properties;\n  }\n\n  throw new Error(`can't serialize object of type ${typeof input}`);\n}\n\nexport function deserialize(input: Serialized): unknown {\n  if (\n    input === null ||\n    input === undefined ||\n    typeof input === 'boolean' ||\n    typeof input === 'number' ||\n    typeof input === 'string' ||\n    input instanceof Boolean ||\n    input instanceof Number ||\n    input instanceof String ||\n    input instanceof Date ||\n    input instanceof RegExp ||\n    input instanceof Blob ||\n    isArrayBuffer(input) ||\n    isImageBitmap(input) ||\n    ArrayBuffer.isView(input) ||\n    input instanceof ImageData\n  ) {\n    return input;\n  }\n\n  if (Array.isArray(input)) {\n    return input.map(deserialize);\n  }\n\n  if (typeof input === 'object') {\n    const name = (input as any).$name || 'Object';\n    if (!registry[name]) {\n      throw new Error(`can't deserialize unregistered class ${name}`);\n    }\n    const { klass } = registry[name];\n    if (!klass) {\n      throw new Error(`can't deserialize unregistered class ${name}`);\n    }\n\n    if (klass.deserialize) {\n      return klass.deserialize(input);\n    }\n\n    const result = Object.create(klass.prototype);\n\n    for (const key of Object.keys(input)) {\n      // eslint-disable-next-line no-continue\n      if (key === '$name') continue;\n      const value = (input as SerializedObject)[key];\n      result[key] = registry[name].shallow.indexOf(key) >= 0 ? value : deserialize(value);\n    }\n\n    return result;\n  }\n\n  throw new Error(`can't deserialize object of type ${typeof input}`);\n}\n", "import { nullFunction } from './util';\n\n/**\n * Invokes the wrapped function in a non-blocking way when trigger() is called. Invocation requests\n * are ignored until the function was actually invoked.\n */\nclass ThrottledInvoker {\n  channel: WithNull<MessageChannel>;\n  triggered: boolean;\n  callback: () => void;\n\n  constructor(callback: () => void) {\n    this.callback = callback;\n    this.triggered = false;\n    if (typeof MessageChannel !== 'undefined') {\n      this.channel = new MessageChannel();\n      this.channel.port2.onmessage = () => {\n        this.triggered = false;\n        this.callback();\n      };\n    }\n  }\n\n  trigger() {\n    if (!this.triggered) {\n      this.triggered = true;\n      if (this.channel) {\n        this.channel.port1.postMessage(true);\n      } else {\n        setTimeout(() => {\n          this.triggered = false;\n          this.callback();\n        }, 0);\n      }\n    }\n  }\n\n  remove() {\n    this.channel = null;\n    this.callback = nullFunction;\n  }\n}\n\nexport default ThrottledInvoker;\n", "/* eslint-disable no-restricted-globals */\n\nimport { isWorker, isSafari, uid } from './util';\nimport { serialize, deserialize } from './webWorkerTransfer';\nimport ThrottledInvoker from './ThrottledInvoker';\n\n/**\n * An implementation of the [Actor design pattern](http://en.wikipedia.org/wiki/Actor_model)\n * that maintains the relationship between asynchronous tasks and the objects\n * that spin them off - in this case, tasks like parsing parts of styles,\n * owned by the styles\n */\nclass Actor {\n  target: any;\n  parent: any;\n  id: string;\n  dispatcherId: number | undefined;\n  callbacks: {\n    number: any;\n  };\n  name: string;\n  tasks: {\n    [key: number]: any;\n  };\n  taskQueue: number[];\n  cancelCallbacks: {\n    number: Cancelable;\n  };\n  invoker: ThrottledInvoker;\n  globalScope: any;\n\n  constructor(target: any, parent: any, dispatcherId?: number) {\n    this.target = target;\n    this.parent = parent;\n    this.id = uid('actor');\n    this.dispatcherId = dispatcherId;\n    this.callbacks = {} as { number: any };\n    this.tasks = {} as { number: any };\n    this.taskQueue = [];\n    this.cancelCallbacks = {} as { number: Cancelable };\n    this.receive = this.receive.bind(this);\n    this.process = this.process.bind(this);\n    this.invoker = new ThrottledInvoker(this.process);\n    this.target.addEventListener('message', this.receive, false);\n    this.globalScope = isWorker() ? target : window;\n  }\n\n  /**\n   * Sends a message from a main-thread map to a Worker or from a Worker back to\n   * a main-thread map instance.\n   *\n   * @param type The name of the target method to invoke or '[source-type].[source-name].name' for a method on a WorkerSource.\n   * @param data\n   * @param callback\n   * @param targetId A particular mapId to which to send this message.\n   * @param mustQueue\n   * @private\n   */\n  send(type: string, data: unknown, callback?: () => void, targetId?: string | null, mustQueue = false): Cancelable {\n    // We're using a string ID instead of numbers because they are being used as object keys\n    // anyway, and thus stringified implicitly. We use random IDs because an actor may receive\n    // message from multiple other actors which could run in different execution context. A\n    // linearly increasing ID could produce collisions.\n    const id = Math.round(Math.random() * 1e18)\n      .toString(36)\n      .substring(0, 10);\n    if (callback) {\n      this.callbacks[id] = callback;\n    }\n    const buffers: undefined | any[] = isSafari(this.globalScope) ? undefined : [];\n    this.target.postMessage(\n      {\n        id,\n        type,\n        hasCallback: !!callback,\n        targetId,\n        mustQueue,\n        dispatcherId: this.dispatcherId,\n        data: serialize(data, buffers),\n      },\n      buffers,\n    );\n    return {\n      cancel: () => {\n        if (callback) {\n          // Set the callback to null so that it never fires after the request is aborted.\n          delete this.callbacks[id];\n        }\n        this.target.postMessage({\n          id,\n          type: '<cancel>',\n          targetId,\n          dispatcherId: this.dispatcherId,\n        });\n      },\n    };\n  }\n\n  receive(message: any) {\n    const { data } = message;\n    const { id } = data;\n\n    if (!id) {\n      return;\n    }\n\n    if (data.targetId && this.dispatcherId !== data.targetId) {\n      return;\n    }\n\n    if (data.type === '<cancel>') {\n      // Remove the original request from the queue. This is only possible if it\n      // hasn't been kicked off yet. The id will remain in the queue, but because\n      // there is no associated task, it will be dropped once it's time to execute it.\n      delete this.tasks[id];\n      const cancel = this.cancelCallbacks[id];\n      delete this.cancelCallbacks[id];\n      if (cancel) {\n        cancel();\n      }\n    } else if (isWorker() || data.mustQueue) {\n      // In workers, store the tasks that we need to process before actually processing them. This\n      // is necessary because we want to keep receiving messages, and in particular,\n      // <cancel> messages. Some tasks may take a while in the worker thread, so before\n      // executing the next task in our queue, postMessage preempts this and <cancel>\n      // messages can be processed. We're using a MessageChannel object to get throttle the\n      // process() flow to one at a time.\n      this.tasks[id] = data;\n      this.taskQueue.push(id);\n      this.invoker.trigger();\n    } else {\n      // In the main thread, process messages immediately so that other work does not slip in\n      // between getting partial data back from workers.\n      this.processTask(id, data);\n    }\n  }\n\n  process() {\n    if (!this.taskQueue.length) {\n      return;\n    }\n    const id = this.taskQueue.shift();\n    if (id === undefined) return;\n    const task = this.tasks[id];\n    delete this.tasks[id];\n    // Schedule another process call if we know there's more to process _before_ invoking the\n    // current task. This is necessary so that processing continues even if the current task\n    // doesn't execute successfully.\n    if (this.taskQueue.length) {\n      this.invoker.trigger();\n    }\n    if (!task) {\n      // If the task ID doesn't have associated task data anymore, it was canceled.\n      return;\n    }\n\n    this.processTask(id, task);\n  }\n\n  processTask(id: number, task: any) {\n    if (task.type === '<response>') {\n      // The done() function in the counterpart has been called, and we are now\n      // firing the callback in the originating actor, if there is one.\n      const callback = this.callbacks[id];\n      delete this.callbacks[id];\n      if (callback) {\n        // If we get a response, but don't have a callback, the request was canceled.\n        if (task.error) {\n          callback(deserialize(task.error));\n        } else {\n          callback(null, deserialize(task.data));\n        }\n      }\n    } else {\n      let completed = false;\n      const buffers: undefined | any[] = isSafari(this.globalScope) ? undefined : [];\n      const done = task.hasCallback\n        ? (err: Error, data?: any) => {\n            completed = true;\n            delete this.cancelCallbacks[id];\n            this.target.postMessage(\n              {\n                id,\n                type: '<response>',\n                dispatcherId: this.dispatcherId,\n                error: err ? serialize(err) : null,\n                data: serialize(data, buffers),\n              },\n              buffers,\n            );\n          }\n        : () => {\n            completed = true;\n          };\n\n      let callback: WithNull<Cancelable> = null;\n      const params = deserialize(task.data) as any;\n      if (this.parent[task.type]) {\n        callback = this.parent[task.type]?.(task.dispatcherId, params, done);\n      } else {\n        // No function was found.\n        done(new Error(`Could not find function ${task.type}`));\n      }\n\n      if (!completed && callback && callback.cancel) {\n        // Allows canceling the task as long as it hasn't been completed yet.\n        this.cancelCallbacks[id] = callback.cancel;\n      }\n    }\n  }\n\n  remove() {\n    this.invoker.remove();\n    this.target.removeEventListener('message', this.receive, false);\n  }\n}\n\nexport default Actor;\n", "/* eslint-disable no-restricted-globals */\nimport { asyncAll, isWorker } from './util';\nimport Actor from './Actor';\nimport type { RequestAdapter } from './Request';\nimport getRequest from './Request';\n\nexport default class Worker {\n  public self: any;\n\n  public actor: Actor;\n\n  public referrer: string;\n\n  public request: RequestAdapter;\n\n  public cancelMap: Map<any, any> = new Map();\n\n  constructor(self: any) {\n    this.self = self;\n    this.actor = new Actor(self, this);\n    this.request = getRequest();\n  }\n\n  setReferrer(dispatcherId: string, referrer: string) {\n    this.referrer = referrer;\n  }\n\n  configDeps(dispatcherId: string, deps: string[], callback: any) {\n    if (deps && Array.isArray(deps) && deps.length > 0) {\n      try {\n        self.importScripts(...deps);\n        callback(null, true);\n      } catch (e) {\n        asyncAll(\n          deps,\n          (d, done) => {\n            this.request.fetch(\n              {\n                url: d,\n                type: 'arrayBuffer',\n              },\n              (err, data) => {\n                if (err) {\n                  done(err, false);\n                  return console.error(err);\n                }\n                const url = URL.createObjectURL(new Blob([data], { type: 'application/javascript' }));\n                self.importScripts(url);\n                // Mobile Safari\n                setTimeout(() => {\n                  URL.revokeObjectURL(url);\n                });\n                done(null, true);\n              },\n            );\n          },\n          callback,\n        );\n      }\n    } else {\n      callback(null, true);\n    }\n  }\n\n  loadData(dispatcherId: string, params: any, callback: any) {\n    const cancelId = params?.cancelId;\n    const { cancel } = this.request.fetch(params, (err, data) => {\n      this.cancelMap.delete(cancelId);\n      if (err) {\n        callback(err);\n      } else {\n        if (params?.decodeType === 0) {\n          this.request.arrayBuffer2Image(data, callback);\n        } else if (params?.decodeType === 1) {\n          this.request.arrayBuffer2unit8(data, callback);\n        } else if (params?.decodeType === 2) {\n          this.request.arrayBuffer2tiff(data, callback);\n        } else if (params?.decodeType === 3) {\n          this.request.parseExif(data, callback);\n        }\n      }\n    });\n    this.cancelMap.set(cancelId, cancel);\n  }\n\n  cancel(dispatcherId: string, params: any, callback: any) {\n    const cancelId = params?.cancelId;\n    const c = this.cancelMap.get(cancelId);\n    if (c) {\n      c();\n      callback(null, true);\n    } else {\n      callback(new Error('无相关的可取消请求！'));\n    }\n  }\n}\n\nif (isWorker()) {\n  (self as any).worker = new Worker(self as any);\n}\n", "let u = '';\nexport function setWorkerUrl(url: string) {\n  u = url;\n}\n\nexport function getWorkerUrl() {\n  return u;\n}\n\nlet deps: string[] = [];\n\n/**\n * 设置外部依赖的路径\n * 一般我们在使用 importScripts 时需要指定\n * @param d\n */\nexport function configDeps(d: string[]) {\n  deps = d;\n}\n\nexport function getConfigDeps() {\n  return deps;\n}\n", "import { getWorkerUrl } from './config';\n\nexport type MessageListener = (a: { data: any; target: any }) => unknown;\n\n// The main thread interface. Provided by Worker in a browser environment,\nexport interface WorkerInterface {\n  addEventListener(type: 'message', listener: MessageListener): void;\n  removeEventListener(type: 'message', listener: MessageListener): void;\n  postMessage(message: any): void;\n  terminate(): void;\n}\n\nexport default function workerFactory() {\n  return new Worker(getWorkerUrl());\n}\n", "import workerFactory from './workerFactory';\nimport type { WorkerInterface } from './workerFactory';\n\nexport const PRELOAD_POOL_ID = '__wind_layer_preloaded_worker_pool__';\n\n/**\n * 创建`webworker` 线程池\n */\nexport default class WorkerPool {\n  static workerCount: number;\n\n  active: {\n    [_ in number | string]: boolean;\n  };\n  workers: WithNull<WorkerInterface[]>;\n\n  constructor() {\n    this.active = {};\n  }\n\n  /**\n   * 获取 `Worker` 实例\n   * @param id\n   */\n  acquire(id: number | string): WorkerInterface[] {\n    if (!this.workers) {\n      this.workers = [];\n      for (let i = 0; i < WorkerPool.workerCount; i++) {\n        const worker = workerFactory();\n        if (worker) {\n          this.workers.push(worker);\n        }\n      }\n    }\n\n    this.active[id] = true;\n    return this.workers.slice();\n  }\n\n  /**\n   * 释放所有 `Worker`\n   * @param id\n   */\n  release(id: number | string) {\n    delete this.active[id];\n    if (this.numActive() === 0 && this.workers) {\n      this.workers.forEach((w) => {\n        w.terminate();\n      });\n      this.workers = null;\n    }\n  }\n\n  isPreloaded(): boolean {\n    return !!this.active[PRELOAD_POOL_ID];\n  }\n\n  /**\n   * 获取激活的`Worker` 数量\n   */\n  numActive(): number {\n    return Object.keys(this.active).length;\n  }\n}\n\nconst hardwareConcurrency = (typeof navigator !== 'undefined' && navigator.hardwareConcurrency) || 4;\nconst availableLogicalProcessors = Math.floor(hardwareConcurrency / 2);\nWorkerPool.workerCount = Math.max(Math.min(availableLogicalProcessors, 6), 1);\n", "import Actor from './Actor';\nimport type WorkerPool from './WorkerPool';\nimport { nullFunction, asyncAll, uid } from './util';\n\nclass Dispatcher {\n  workerPool: WorkerPool;\n  actors: Array<Actor>;\n  currentActor: number;\n  id: string;\n  dispatcherId: number;\n\n  constructor(workerPool: WorkerPool, parent: any, dispatcherId: number) {\n    this.workerPool = workerPool;\n    this.actors = [];\n    this.currentActor = 0;\n    this.id = uid('dispatcher');\n    this.dispatcherId = dispatcherId;\n    const workers = this.workerPool.acquire(this.dispatcherId);\n    for (let i = 0; i < workers.length; i++) {\n      const worker = workers[i];\n      const actor = new Actor(worker, parent, this.dispatcherId);\n      actor.name = `Worker ${i}`;\n      this.actors.push(actor);\n    }\n    if (!this.actors.length) throw new Error('No actors found');\n  }\n\n  /**\n   * 广播到所有 Actor\n   * @param type\n   * @param data\n   * @param cb\n   */\n  broadcast(type: string, data: unknown, cb?: (...args: any[]) => any) {\n    // eslint-disable-next-line no-param-reassign\n    cb = cb || nullFunction;\n    asyncAll(\n      this.actors,\n      (actor, done) => {\n        actor.send(type, data, done);\n      },\n      cb,\n    );\n  }\n\n  send(type, data: any, cb?: any, id?: string) {\n    const actor = this.getActor(id);\n    if (actor) {\n      actor.send(type, data, cb);\n    }\n  }\n\n  /**\n   * 获取要发送消息的 `Actor`\n   * TIP: 是否需要实现 `Actor` 是否占用判断\n   */\n  getActor(id?: string): Actor {\n    if (id !== undefined) {\n      const index = this.actors.findIndex((a) => a.id === id);\n      if (index > -1) {\n        this.currentActor = index;\n      } else {\n        this.currentActor = (this.currentActor + 1) % this.actors.length;\n      }\n    } else {\n      this.currentActor = (this.currentActor + 1) % this.actors.length;\n    }\n    return this.actors[this.currentActor];\n  }\n\n  remove(removed = true) {\n    this.actors.forEach((actor) => {\n      actor.remove();\n    });\n    this.actors = [];\n    if (removed) this.workerPool.release(this.id);\n  }\n}\n\nexport default Dispatcher;\n", "import WorkerPool, { PRELOAD_POOL_ID } from './WorkerPool';\nimport Dispatcher from './Dispatcher';\nimport Actor from './Actor';\nimport request from './Request';\nimport RequestScheduler from './RequestScheduler';\nimport ThrottledInvoker from './ThrottledInvoker';\nimport { getReferrer } from './util';\nimport { setWorkerUrl, configDeps, getConfigDeps } from './config';\nimport { register } from './webWorkerTransfer';\nimport * as utils from './util';\n\nlet globalWorkerPool;\n\nfunction getGlobalWorkerPool() {\n  if (!globalWorkerPool) {\n    globalWorkerPool = new WorkerPool();\n  }\n  return globalWorkerPool;\n}\n\nfunction prewarm() {\n  const workerPool = getGlobalWorkerPool();\n  workerPool.acquire(PRELOAD_POOL_ID);\n}\n\nconst exported = {\n  utils,\n  request,\n  register,\n  configDeps,\n  getConfigDeps,\n  prewarm,\n  getReferrer,\n  setWorkerUrl,\n  getGlobalWorkerPool,\n  Actor,\n  WorkerPool,\n  Dispatcher,\n  RequestScheduler,\n  ThrottledInvoker,\n};\n\nexport default exported;\n", "import '../dist/build/wgw/shared';\nimport '../dist/build/wgw/worker';\nimport '../dist/build/wgw/index';\n\n// eslint-disable-next-line no-undef\nexport default wgw;\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\n\nexport default class Pipelines {\n  #passes: any[] = [];\n\n  public enabled: boolean;\n  public renderer: Renderer;\n\n  constructor(renderer) {\n    this.enabled = true;\n    this.renderer = renderer;\n  }\n\n  get passes() {\n    return this.#passes;\n  }\n\n  get length() {\n    return this.passes.length;\n  }\n\n  resize(width: number, height: number) {\n    const len = this.#passes.length;\n    for (let i = 0; i < len; i++) {\n      const pass = this.#passes[i];\n      pass.resize?.(width, height);\n    }\n  }\n\n  addPass(pass) {\n    this.#passes.push(pass);\n  }\n\n  removePass(pass) {\n    const idx = this.#passes.indexOf(pass);\n    if (idx > -1) {\n      this.#passes.splice(pass, 1);\n      pass.destroy();\n    }\n  }\n\n  removePasses() {\n    this.#passes.forEach((pass) => pass.destroy());\n    this.#passes = [];\n  }\n\n  getPass(id) {\n    return this.#passes.find((pass) => pass.id === id);\n  }\n\n  prerender(rendererParams, rendererState) {\n    const passes = this.#passes.filter((p) => p.enabled && p.prerender === true);\n    if (passes.length > 0) {\n      const len = passes.length;\n      for (let i = 0; i < len; i++) {\n        const pass = passes[i];\n        pass.render(rendererParams, rendererState);\n      }\n      this.renderer.resetState();\n    }\n  }\n\n  render(rendererParams, rendererState) {\n    const passes = this.#passes.filter((p) => p.enabled && p.prerender !== true);\n    if (passes.length > 0) {\n      const len = passes.length;\n      for (let i = 0; i < len; i++) {\n        const pass = passes[i];\n        pass.render(rendererParams, rendererState);\n      }\n      this.renderer.resetState();\n    }\n  }\n\n  destroy() {\n    this.#passes.forEach((pass) => pass.destroy());\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\n\nconst ERR_PASS_METHOD_UNDEFINED = 'Pass subclass must define virtual methods';\n\nexport default class Pass<T> {\n  public id: string;\n\n  public readonly renderer: Renderer;\n\n  public options: T;\n\n  public maskPass: any;\n\n  #enabled = true;\n\n  constructor(id: string, renderer: Renderer, options: T = {} as T) {\n    this.id = id;\n    this.renderer = renderer;\n    this.options = options;\n\n    this.setMaskPass((this.options as any).maskPass);\n  }\n\n  get enabled() {\n    return this.#enabled;\n  }\n\n  set enabled(state) {\n    this.#enabled = state;\n  }\n\n  setMaskPass(pass) {\n    this.maskPass = pass;\n  }\n\n  render(rendererParams, rendererState, cb) { // eslint-disable-line\n    throw new Error(ERR_PASS_METHOD_UNDEFINED);\n  }\n\n  destroy() {\n    throw new Error(ERR_PASS_METHOD_UNDEFINED);\n  }\n}\n", "import earcut from 'earcut';\nimport { utils, type Attributes } from '@sakitam-gis/vis-engine';\nimport type { Bounds } from '../type';\n\nexport function calcMinMax(array: number[]): [number, number] {\n  let min = Infinity;\n  let max = Infinity;\n  // @from: https://stackoverflow.com/questions/13544476/how-to-find-max-and-min-in-array-using-minimum-comparisons\n  for (let i = 0; i < array.length; i++) {\n    const val = array[i];\n\n    if (min === Infinity) {\n      min = val;\n    } else if (max === Infinity) {\n      max = val;\n      // update min max\n      // 1. Pick 2 elements(a, b), compare them. (say a > b)\n      min = Math.min(min, max);\n      max = Math.max(min, max);\n    } else {\n      // 2. Update min by comparing (min, b)\n      // 3. Update max by comparing (max, a)\n      min = Math.min(val, min);\n      max = Math.max(val, max);\n    }\n  }\n  return [min, max];\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function isFunction(val: any): val is Function {\n  return utils.typeOf(val) === 'function';\n}\n\nexport function findStopLessThanOrEqualTo(stops: number[], input: number) {\n  const lastIndex = stops.length - 1;\n  let lowerIndex = 0;\n  let upperIndex = lastIndex;\n  let currentIndex = 0;\n  let currentValue;\n  let nextValue;\n\n  while (lowerIndex <= upperIndex) {\n    currentIndex = Math.floor((lowerIndex + upperIndex) / 2);\n    currentValue = stops[currentIndex];\n    nextValue = stops[currentIndex + 1];\n\n    if (currentValue <= input) {\n      if (currentIndex === lastIndex || input < nextValue) {\n        // Search complete\n        return currentIndex;\n      }\n\n      lowerIndex = currentIndex + 1;\n    } else if (currentValue > input) {\n      upperIndex = currentIndex - 1;\n    } else {\n      throw new Error('Input is not a number.');\n    }\n  }\n\n  return 0;\n}\n\nlet linkEl;\n\n/**\n * 使用相对地址时使用 `a.href` 和 `image.src` 可以获取完整的 url\n * 但是不同的是 `image.src` 会直接请求资源。\n * @param path\n */\nexport function resolveURL(path: string): string {\n  if (!linkEl) linkEl = document.createElement('a');\n  linkEl.href = path;\n  return linkEl.href;\n}\n\n/**\n * 判断大小端\n */\nexport const littleEndian = (function machineIsLittleEndian() {\n  const uint8Array = new Uint8Array([0xaa, 0xbb]);\n  const uint16array = new Uint16Array(uint8Array.buffer);\n  return uint16array[0] === 0xbbaa;\n})();\n\n/**\n * 判断数据是否是 `ImageBitmap`\n * @param image\n */\nexport function isImageBitmap(image: any): image is ImageBitmap {\n  return typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap;\n}\n\n/**\n * 从 exif 解析数据范围\n * @param exif\n */\nexport function parseRange(exif) {\n  const string = exif?.ImageDescription || '';\n  const group = string.split(';');\n  const gs = group.filter((item) => item !== '');\n  return gs.map((item) => item.split(',').map((v) => parseFloat(v)));\n}\n\n/**\n * 获取两个对象中不同的 key\n * @param obj\n * @param other\n */\nexport function keysDifference(obj, other) {\n  const difference: (string | number)[] = [];\n  for (const i in obj) {\n    if (!(i in other)) {\n      difference.push(i);\n    }\n  }\n  return difference;\n}\n\n/**\n * extent1 是否包含 extent2\n *           extent1[3]\n *           |--------|\n *           |        |\n * extent1[0]|        |extent1[2]\n *           |--------|\n *           extent1[1]\n *\n *            extent2[3]\n *           |--------|\n *           |        |\n * extent2[0]|        |extent2[2]\n *           |--------|\n *           extent2[1]\n * @param extent1\n * @param extent2\n */\nexport function intersects(extent1: Bounds, extent2: Bounds) {\n  return extent1[0] <= extent2[2] && extent1[2] >= extent2[0] && extent1[1] <= extent2[3] && extent1[3] >= extent2[1];\n}\n\n/**\n * extent1 是否包含 extent2\n *           extent1[3]\n *           |--------|\n *           |        |\n * extent1[0]|        |extent1[2]\n *           |--------|\n *           extent1[1]\n *\n *            extent2[3]\n *           |--------|\n *           |        |\n * extent2[0]|        |extent2[2]\n *           |--------|\n *           extent2[1]\n * @param extent1\n * @param extent2\n */\nexport function containsExtent(extent1: Bounds, extent2: Bounds) {\n  return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] && extent1[1] <= extent2[1] && extent2[3] <= extent1[3];\n}\n\n/**\n * 判断坐标是否在矩形范围内\n * @param {Array<number>} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\nexport function inRange(value: number, start: number, end: number) {\n  return value >= start && value < end;\n}\n\nexport function mod(x, y) {\n  return ((x % y) + y) % y;\n}\n\nexport function containTile(a: Bounds, b: Bounds) {\n  return containsExtent(a, b) || intersects(a, b);\n}\n\n/**\n * 将多面转换为单面\n * @returns {*}\n */\nexport function flattenForPolygons(features) {\n  if (!features || features.length === 0) return [];\n\n  const len = features.length;\n  let i = 0;\n  const data: any[] = [];\n\n  for (; i < len; i++) {\n    const feature = features[i];\n\n    const coordinates = feature.geometry.coordinates;\n    const type = feature.geometry.type;\n\n    if (type === 'Polygon') {\n      data.push(feature);\n    } else if (type === 'MultiPolygon') {\n      for (let k = 0; k < coordinates.length; k++) {\n        const coordinate = coordinates[k];\n        data.push({\n          ...feature,\n          geometry: {\n            type: 'Polygon',\n            coordinates: coordinate,\n          },\n        });\n      }\n    }\n  }\n\n  return data;\n}\n\nexport function polygon2buffer(features: any[]) {\n  const len = features.length;\n  let i = 0;\n  const geometries: Attributes[] = [];\n  for (; i < len; i++) {\n    const feature = features[i];\n\n    const coordinates = feature.geometry.coordinates;\n    const type = feature.geometry.type;\n\n    if (type === 'Polygon') {\n      const polygon = earcut.flatten(feature.geometry.coordinates);\n\n      const positions = new Float32Array(polygon.vertices);\n      const indexData = earcut(polygon.vertices, polygon.holes, polygon.dimensions);\n\n      geometries.push({\n        index: {\n          data: indexData.length < 65536 ? new Uint16Array(indexData) : new Uint32Array(indexData),\n        },\n        position: {\n          data: positions,\n          size: 2,\n        },\n      });\n    } else if (type === 'MultiPolygon') {\n      for (let k = 0; k < coordinates.length; k++) {\n        const coordinate = coordinates[k];\n        const polygon = earcut.flatten(coordinate);\n\n        const positions = new Float32Array(polygon.vertices);\n        const indexData = earcut(polygon.vertices, polygon.holes, polygon.dimensions);\n        geometries.push({\n          index: {\n            data: indexData.length < 65536 ? new Uint16Array(indexData) : new Uint32Array(indexData),\n          },\n          position: {\n            data: positions,\n            size: 2,\n          },\n        });\n      }\n    }\n  }\n\n  return geometries;\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { Program, RenderTarget, utils } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport vert from '../../../shaders/compose.vert.glsl';\nimport frag from '../../../shaders/compose.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { RenderFrom, BandType } from '../../../type';\nimport { littleEndian } from '../../../utils/common';\nimport type TileID from '../../../tile/TileID';\nimport type { SourceType } from '../../../source';\nimport type MaskPass from '../mask';\n\nexport interface ComposePassOptions {\n  source: SourceType;\n  bandType: BandType;\n  renderFrom: RenderFrom;\n  isRasterize?: () => boolean;\n  maskPass?: MaskPass;\n  stencilConfigForOverlap: (tiles: any[]) => [{ [_: number]: any }, TileID[]];\n}\n\n/**\n * 在这里我们实现将所有瓦片绘制在 fbo 上以提升多世界渲染的边界接边效果\n * 在下一步再进行完整的着色\n */\nexport default class ComposePass extends Pass<ComposePassOptions> {\n  readonly prerender = true;\n\n  #program: WithNull<Program>;\n  #current: WithNull<RenderTarget>;\n  #next: WithNull<RenderTarget>;\n  #uid: string;\n\n  constructor(id: string, renderer: Renderer, options: ComposePassOptions = {} as ComposePassOptions) {\n    super(id, renderer, options);\n\n    this.#uid = utils.uid('ColorComposePass');\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_image0: {\n          value: undefined,\n        },\n        dataRange: {\n          value: undefined,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n    });\n\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt = {\n      width: this.renderer.width,\n      height: this.renderer.height,\n      minFilter: renderer.gl.NEAREST,\n      magFilter: renderer.gl.NEAREST,\n      type: this.renderer.gl.FLOAT,\n      format: this.renderer.gl.RGBA,\n      // generateMipmaps: false,\n      internalFormat: this.renderer.isWebGL2\n        ? (this.renderer.gl as WebGL2RenderingContext).RGBA32F\n        : this.renderer.gl.RGBA,\n      stencil: true,\n    };\n\n    this.#current = new RenderTarget(renderer, {\n      ...opt,\n      name: 'currentRenderTargetTexture',\n    });\n    this.#next = new RenderTarget(renderer, {\n      ...opt,\n      name: 'nextRenderTargetTexture',\n    });\n  }\n\n  resize(width: number, height: number) {\n    this.#current?.resize(width, height);\n    this.#next?.resize(width, height);\n  }\n\n  get renderTarget() {\n    return {\n      current: this.#current,\n      next: this.#next,\n    };\n  }\n\n  get textures() {\n    return {\n      current: this.#current?.texture,\n      next: this.#next?.texture,\n    };\n  }\n\n  renderTexture(renderTarget, rendererParams, rendererState, sourceCache) {\n    if (renderTarget) {\n      renderTarget.clear();\n      renderTarget.bind();\n      const attr = this.renderer.attributes;\n      if (attr.depth && renderTarget.depth) {\n        this.renderer.state.enable(this.renderer.gl.DEPTH_TEST);\n        this.renderer.state.setDepthMask(true);\n      }\n      this.renderer.setViewport(renderTarget.width, renderTarget.height);\n    }\n\n    const { stencilConfigForOverlap } = this.options;\n    const camera = rendererParams.cameras.camera;\n    if (sourceCache) {\n      const coordsAscending = sourceCache.getVisibleCoordinates();\n      const coordsDescending = coordsAscending.slice().reverse(); // offscreen & opaque\n\n      if (!coordsDescending.length) return;\n\n      let stencil;\n\n      if (this.maskPass) {\n        stencil = this.maskPass.render(rendererParams, rendererState);\n      }\n\n      const [stencilModes, coords] = stencilConfigForOverlap(coordsDescending);\n\n      for (let i = 0; i < coords.length; i++) {\n        const coord = coords[i];\n        const tile = sourceCache.getTile(coord);\n        if (!(tile && tile.hasData())) continue;\n\n        const bbox = coord.getTileProjBounds();\n        if (!bbox) continue;\n\n        const tileMesh = tile.createMesh(this.#uid, bbox, this.renderer, this.#program);\n        const mesh = tileMesh.getMesh();\n\n        const dataRange: number[] = [];\n        for (const [index, texture] of tile.textures) {\n          if (texture.userData?.dataRange && Array.isArray(texture.userData?.dataRange)) {\n            dataRange.push(...texture.userData.dataRange);\n          }\n\n          if (\n            this.options.isRasterize?.() &&\n            (texture.options.minFilter !== this.renderer.gl.NEAREST ||\n              texture.options.magFilter !== this.renderer.gl.NEAREST)\n          ) {\n            texture.setOptions({\n              minFilter: this.renderer.gl.NEAREST,\n              magFilter: this.renderer.gl.NEAREST,\n            });\n          }\n          mesh.program.setUniform(`u_image${index}`, texture);\n        }\n\n        if (dataRange.length > 0) {\n          mesh.program.setUniform('dataRange', dataRange);\n        }\n\n        mesh.updateMatrix();\n        mesh.worldMatrixNeedsUpdate = false;\n        mesh.worldMatrix.multiply(rendererParams.scene.worldMatrix, mesh.localMatrix);\n\n        const stencilMode = stencilModes[coord.overscaledZ];\n\n        if (stencilMode) {\n          // if (stencilMode.stencil) {\n          //   const s = this.renderer.gl.getParameter(this.renderer.gl.STENCIL_TEST);\n          //   if (!s) {\n          //     this.renderer.state.enable(this.renderer.gl.STENCIL_TEST);\n          //   }\n          //\n          //   this.renderer.gl.stencilFunc(\n          //     stencilMode.func?.cmp,\n          //     stencilMode.func?.ref,\n          //     stencilMode.func?.mask,\n          //   );\n          //   this.renderer.gl.stencilOp(\n          //     stencilMode.op?.fail,\n          //     stencilMode.op?.zfail,\n          //     stencilMode.op?.zpass,\n          //   );\n          // } else {\n          //   this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n          // }\n        }\n\n        mesh.draw({\n          ...rendererParams,\n          camera,\n        });\n\n        // reset texture\n        if (this.options.isRasterize?.()) {\n          for (const [_, texture] of tile.textures) {\n            texture.setOptions({\n              minFilter: this.renderer.gl.LINEAR,\n              magFilter: this.renderer.gl.LINEAR,\n            });\n          }\n        }\n      }\n\n      this.renderer.clear(false, false, true);\n\n      if (!stencil) {\n        this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n      }\n    }\n\n    if (renderTarget) {\n      renderTarget.unbind();\n    }\n  }\n\n  /**\n   * 此处绘制主要是合并瓦片\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const { source } = this.options;\n    const sourceCache = source.sourceCache;\n    if (Array.isArray(sourceCache)) {\n      if (sourceCache.length === 2) {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n        this.renderTexture(this.#next, rendererParams, rendererState, sourceCache[1]);\n      } else {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n        this.renderTexture(this.#next, rendererParams, rendererState, sourceCache[0]);\n      }\n    } else {\n      this.renderTexture(this.#current, rendererParams, rendererState, sourceCache);\n      this.renderTexture(this.#next, rendererParams, rendererState, sourceCache);\n    }\n  }\n\n  destroy() {\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#current) {\n      this.#current.destroy();\n      this.#current = null;\n    }\n\n    if (this.#next) {\n      this.#next.destroy();\n      this.#next = null;\n    }\n  }\n}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry, utils, Vector2 } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport { littleEndian } from '../../../utils/common';\nimport vert from '../../../shaders/common.vert.glsl';\nimport frag from '../../../shaders/color.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\n\nexport interface ColorizePassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  bandType: BandType;\n}\n\n/**\n * 着色\n */\nexport default class ColorizePass extends Pass<ColorizePassOptions> {\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n  readonly prerender = false;\n\n  constructor(id: string, renderer: Renderer, options: ColorizePassOptions = {} as ColorizePassOptions) {\n    super(id, renderer, options);\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        opacity: {\n          value: 1,\n        },\n        u_fade_t: {\n          value: 0,\n        },\n        displayRange: {\n          value: new Vector2(-Infinity, Infinity),\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n        colorRampTexture: {\n          value: null,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n      transparent: true,\n    });\n\n    this.#geometry = new Geometry(renderer, {\n      position: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      uv: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      index: {\n        size: 1,\n        data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const attr = this.renderer.attributes;\n    this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    const camera = rendererParams.cameras.planeCamera;\n    if (rendererState && this.#mesh) {\n      const uniforms = utils.pick(rendererState, [\n        'opacity',\n        'colorRange',\n        'dataRange',\n        'colorRampTexture',\n        'useDisplayRange',\n        'displayRange',\n      ]);\n\n      Object.keys(uniforms).forEach((key) => {\n        if (uniforms[key] !== undefined) {\n          this.#mesh?.program.setUniform(key, uniforms[key]);\n        }\n      });\n\n      const fade = this.options.source?.getFadeTime?.() || 0;\n      this.#mesh.program.setUniform(\n        'u_image_res',\n        new Vector2(this.options.texture.width, this.options.texture.height),\n      );\n      this.#mesh.program.setUniform('u_fade_t', fade);\n\n      this.#mesh.updateMatrix();\n      this.#mesh.worldMatrixNeedsUpdate = false;\n      this.#mesh.worldMatrix.multiply(camera.worldMatrix, this.#mesh.localMatrix);\n      this.#mesh.draw({\n        ...rendererParams,\n        camera,\n      });\n    }\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n  }\n}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry, utils } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport vert from '../../../shaders/common.vert.glsl';\nimport frag from '../../../shaders/common.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\n\nexport interface RasterPassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  bandType: BandType;\n}\n\n/**\n * raster 渲染\n */\nexport default class RasterPass extends Pass<RasterPassOptions> {\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n  readonly prerender = false;\n\n  constructor(id: string, renderer: Renderer, options: RasterPassOptions = {} as RasterPassOptions) {\n    super(id, renderer, options);\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        opacity: {\n          value: 1,\n        },\n        u_fade_t: {\n          value: 0,\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n      },\n      includes: shaderLib,\n      transparent: true,\n    });\n\n    this.#geometry = new Geometry(renderer, {\n      position: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      uv: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      index: {\n        size: 1,\n        data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const attr = this.renderer.attributes;\n    this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    const camera = rendererParams.cameras.planeCamera;\n    if (rendererState && this.#mesh) {\n      const fade = this.options.source?.getFadeTime?.() || 0;\n      const uniforms = utils.pick(rendererState, ['opacity']);\n\n      Object.keys(uniforms).forEach((key) => {\n        if (uniforms[key] !== undefined) {\n          this.#mesh?.program.setUniform(key, uniforms[key]);\n        }\n      });\n\n      this.#mesh.program.setUniform('u_fade_t', fade);\n\n      this.#mesh.updateMatrix();\n      this.#mesh.worldMatrixNeedsUpdate = false;\n      this.#mesh.worldMatrix.multiply(camera.worldMatrix, this.#mesh.localMatrix);\n      this.#mesh.draw({\n        ...rendererParams,\n        camera,\n      });\n    }\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { Program, RenderTarget, utils } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport vert from '../../../shaders/compose.vert.glsl';\nimport frag from '../../../shaders/raster-texture.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { RenderFrom, BandType } from '../../../type';\nimport type TileID from '../../../tile/TileID';\nimport type { SourceType } from '../../../source';\nimport type MaskPass from '../mask';\n\nexport interface ComposePassOptions {\n  source: SourceType;\n  bandType: BandType;\n  renderFrom: RenderFrom;\n  stencilConfigForOverlap: (tiles: any[]) => [{ [_: number]: any }, TileID[]];\n  maskPass?: MaskPass;\n}\n\n/**\n * 在这里我们实现将所有瓦片绘制在 fbo 上以提升多世界渲染的边界接边效果\n * 在下一步再进行完整的着色\n */\nexport default class ComposePass extends Pass<ComposePassOptions> {\n  readonly prerender = true;\n\n  #program: WithNull<Program>;\n  #current: WithNull<RenderTarget>;\n  #next: WithNull<RenderTarget>;\n  #uid: string;\n  constructor(id: string, renderer: Renderer, options: ComposePassOptions = {} as ComposePassOptions) {\n    super(id, renderer, options);\n\n    this.#uid = utils.uid('ComposePass');\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_image0: {\n          value: undefined,\n        },\n      },\n      includes: shaderLib,\n    });\n\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt = {\n      width: this.renderer.width,\n      height: this.renderer.height,\n      minFilter: renderer.gl.NEAREST,\n      magFilter: renderer.gl.NEAREST,\n      type: this.renderer.gl.UNSIGNED_BYTE,\n      format: this.renderer.gl.RGBA,\n      generateMipmaps: true,\n      internalFormat: this.renderer.gl.RGBA,\n      stencil: true,\n    };\n\n    this.#current = new RenderTarget(renderer, {\n      ...opt,\n      name: 'currentRenderTargetTexture',\n    });\n    this.#next = new RenderTarget(renderer, {\n      ...opt,\n      name: 'nextRenderTargetTexture',\n    });\n  }\n\n  resize(width: number, height: number) {\n    this.#current?.resize(width, height);\n    this.#next?.resize(width, height);\n  }\n\n  get textures() {\n    return {\n      current: this.#current?.texture,\n      next: this.#next?.texture,\n    };\n  }\n\n  renderTexture(renderTarget, rendererParams, rendererState, sourceCache) {\n    if (renderTarget) {\n      renderTarget.clear();\n      renderTarget.bind();\n      const attr = this.renderer.attributes;\n      if (attr.depth && renderTarget.depth) {\n        this.renderer.state.enable(this.renderer.gl.DEPTH_TEST);\n        this.renderer.state.setDepthMask(true);\n      }\n      this.renderer.setViewport(renderTarget.width, renderTarget.height);\n    }\n\n    const { stencilConfigForOverlap } = this.options;\n    const camera = rendererParams.cameras.camera;\n    if (sourceCache) {\n      const coordsAscending = sourceCache.getVisibleCoordinates();\n      const coordsDescending = coordsAscending.slice().reverse(); // offscreen & opaque\n\n      if (!coordsDescending.length) return;\n\n      let stencil;\n\n      if (this.maskPass) {\n        stencil = this.maskPass.render(rendererParams, rendererState);\n      }\n\n      const [stencilModes, coords] = stencilConfigForOverlap(coordsDescending);\n\n      for (let i = 0; i < coords.length; i++) {\n        const coord = coords[i];\n        const tile = sourceCache.getTile(coord);\n        if (!(tile && tile.hasData())) continue;\n        const bbox = coord.getTileProjBounds();\n        if (!bbox) continue;\n        const tileMesh = tile.createMesh(this.#uid, bbox, this.renderer, this.#program);\n        const mesh = tileMesh.getMesh();\n\n        for (const [index, texture] of tile.textures) {\n          mesh.program.setUniform(`u_image${index}`, texture);\n        }\n\n        mesh.updateMatrix();\n        mesh.worldMatrixNeedsUpdate = false;\n        mesh.worldMatrix.multiply(rendererParams.scene.worldMatrix, mesh.localMatrix);\n\n        const stencilMode = stencilModes[coord.overscaledZ];\n\n        if (stencilMode) {\n          // if (stencilMode.stencil) {\n          //   const s = this.renderer.gl.getParameter(this.renderer.gl.STENCIL_TEST);\n          //   if (!s) {\n          //     this.renderer.state.enable(this.renderer.gl.STENCIL_TEST);\n          //   }\n          //\n          //   this.renderer.gl.stencilFunc(\n          //     stencilMode.func?.cmp,\n          //     stencilMode.func?.ref,\n          //     stencilMode.func?.mask,\n          //   );\n          //   this.renderer.gl.stencilOp(\n          //     stencilMode.op?.fail,\n          //     stencilMode.op?.zfail,\n          //     stencilMode.op?.zpass,\n          //   );\n          // } else {\n          //   this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n          // }\n        }\n\n        mesh.draw({\n          ...rendererParams,\n          camera,\n        });\n      }\n\n      this.renderer.clear(false, false, true);\n\n      if (!stencil) {\n        this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n      }\n    }\n\n    if (renderTarget) {\n      renderTarget.unbind();\n    }\n  }\n\n  /**\n   * 此处绘制主要是合并瓦片\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const { source } = this.options;\n    const sourceCache = source.sourceCache;\n    if (Array.isArray(sourceCache)) {\n      if (sourceCache.length === 2) {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n        this.renderTexture(this.#next, rendererParams, rendererState, sourceCache[1]);\n      } else {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n      }\n    } else {\n      this.renderTexture(this.#current, rendererParams, rendererState, sourceCache);\n    }\n  }\n\n  destroy() {\n    if (this.#current) {\n      this.#current.destroy();\n      this.#current = null;\n    }\n    if (this.#next) {\n      this.#next.destroy();\n      this.#next = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { Program, RenderTarget } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport vert from '../../../shaders/common.vert.glsl';\nimport frag from '../../../shaders/compose.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { RenderFrom, BandType } from '../../../type';\nimport { littleEndian } from '../../../utils/common';\nimport type TileID from '../../../tile/TileID';\nimport type { SourceType } from '../../../source';\n\nexport interface ParticlesComposePassOptions {\n  id: string;\n  source: SourceType;\n  bandType: BandType;\n  renderFrom: RenderFrom;\n  stencilConfigForOverlap: (tiles: any[]) => [{ [_: number]: any }, TileID[]];\n  getTileProjSize: (z: number, tiles: TileID[]) => [number, number];\n}\n\nconst defaultSize = 256;\n\n/**\n * 按区域加载视图范围内的瓦片，然后合并单张纹理\n */\nexport default class ParticlesComposePass extends Pass<ParticlesComposePassOptions> {\n  readonly prerender = true;\n\n  #program: WithNull<Program>;\n  #current: WithNull<RenderTarget>;\n  #next: WithNull<RenderTarget>;\n  #uid: string;\n\n  #width = defaultSize;\n  #height = defaultSize;\n\n  constructor(\n    id: string,\n    renderer: Renderer,\n    options: ParticlesComposePassOptions = {} as ParticlesComposePassOptions,\n  ) {\n    super(id, renderer, options);\n\n    this.#uid = options.id;\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_image0: {\n          value: undefined,\n        },\n        dataRange: {\n          value: undefined,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n    });\n\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt = {\n      width: this.#width,\n      height: this.#height,\n      minFilter: renderer.gl.NEAREST,\n      magFilter: renderer.gl.NEAREST,\n      type: this.renderer.gl.FLOAT,\n      format: this.renderer.gl.RGBA,\n      // generateMipmaps: false,\n      internalFormat: this.renderer.isWebGL2\n        ? (this.renderer.gl as WebGL2RenderingContext).RGBA32F\n        : this.renderer.gl.RGBA,\n      stencil: true,\n    };\n\n    this.#current = new RenderTarget(renderer, {\n      ...opt,\n      name: 'currentRenderTargetTexture',\n    });\n    this.#next = new RenderTarget(renderer, {\n      ...opt,\n      name: 'nextRenderTargetTexture',\n    });\n  }\n\n  resize(width: number, height: number) {\n    if (width !== this.#width || height !== this.#height) {\n      this.#current?.resize(width, height);\n      this.#next?.resize(width, height);\n      this.#width = width;\n      this.#height = height;\n    }\n  }\n\n  get textures() {\n    return {\n      current: this.#current?.texture,\n      next: this.#next?.texture,\n    };\n  }\n\n  renderTexture(renderTarget, rendererParams, rendererState, sourceCache) {\n    if (!sourceCache) {\n      return;\n    }\n\n    const { stencilConfigForOverlap } = this.options;\n    const camera = rendererParams.cameras.planeCamera;\n    const coordsAscending = sourceCache.getVisibleCoordinates();\n    const coordsDescending = coordsAscending.slice().reverse(); // offscreen & opaque\n\n    if (!coordsDescending.length) return;\n\n    let xmin = Infinity;\n    let ymin = Infinity;\n    let xmax = -Infinity;\n    let ymax = -Infinity;\n    let zmin = Infinity;\n    let zmax = -Infinity;\n    // 1. 计算mapbox墨卡托坐标的最大最小值，构建真实瓦片范围\n    // 注意这里不要直接使用图层计算的原始瓦片范围，因为在加载过程中有可能会有失败，我\n    // 们应该取真实加载后的瓦片计算范围\n    // mapbox 的坐标原点是左上角\n    for (let n = 0; n < coordsDescending.length; n++) {\n      const tileId = coordsDescending[n];\n      const bounds = tileId.getTileProjBounds();\n      // @todo 不同引擎的top 和 bottom 方向可能不一样\n      xmin = Math.min(bounds.left, xmin);\n      xmax = Math.max(bounds.right, xmax);\n      zmin = Math.min(tileId.z, zmin);\n      zmax = Math.max(tileId.z, zmax);\n\n      if (!rendererState.u_flip_y) {\n        ymin = Math.min(bounds.top, ymin);\n        ymax = Math.max(bounds.bottom, ymax);\n      } else {\n        ymin = Math.min(bounds.bottom, ymin);\n        ymax = Math.max(bounds.top, ymax);\n      }\n    }\n\n    const zz = this.options.getTileProjSize(zmax, coordsDescending);\n\n    const dx = xmax - xmin;\n    const dy = ymax - ymin;\n\n    // 2. 计算 x 方向和 y 方向的行列数\n    const w = dx / zz[0];\n    const h = dy / zz[1];\n\n    // TODO: 瓦片范围和行列数是否可以提到瓦片计算的时候获取，可以减少几次循环\n\n    rendererState.sharedState.u_data_bbox = [xmin, ymin, xmax, ymax];\n    rendererState.sharedState.u_data_zooms = [zmin, zmax];\n\n    if (renderTarget) {\n      renderTarget.clear();\n      renderTarget.bind();\n      const attr = this.renderer.attributes;\n      if (attr.depth && renderTarget.depth) {\n        this.renderer.state.enable(this.renderer.gl.DEPTH_TEST);\n        this.renderer.state.setDepthMask(true);\n      }\n\n      // 3. 计算出 fbo 所需大小 (此处有可能计算的宽高超出纹理最大大小，我们需要根据宽高比例进行重采样)\n      let width = w * (this.options.source.tileSize ?? defaultSize);\n      let height = h * (this.options.source.tileSize ?? defaultSize);\n\n      rendererState.sharedState.u_tiles_size = [width, height];\n\n      const maxTextureSize = this.renderer.gl.getParameter(this.renderer.gl.MAX_TEXTURE_SIZE) * 0.5;\n      const maxRenderBufferSize = this.renderer.gl.getParameter(this.renderer.gl.MAX_RENDERBUFFER_SIZE) * 0.5;\n      const maxSize = Math.max(width, height);\n      if (maxSize > maxTextureSize) {\n        width = (maxTextureSize / maxSize) * width;\n        height = (maxTextureSize / maxSize) * height;\n      } else if (maxSize > maxRenderBufferSize) {\n        width = (maxRenderBufferSize / maxSize) * width;\n        height = (maxRenderBufferSize / maxSize) * height;\n      }\n\n      this.resize(width, height);\n\n      this.renderer.setViewport(width, height);\n    }\n\n    const [stencilModes, coords] = stencilConfigForOverlap(coordsDescending);\n\n    // 4. 循环 TileID，从 sourceCache 查找对应瓦片渲染（默认是从视野中心向两边渲染）\n    for (let k = 0; k < coords.length; k++) {\n      const coord = coords[k];\n      // 5. 进行渲染\n      if (coord) {\n        const tile = sourceCache.getTile(coord);\n        if (!(tile && tile.hasData())) continue;\n\n        const tileBBox = coord.getTileProjBounds();\n        if (!tileBBox) continue;\n\n        const tileMesh = tile.createMesh(this.#uid, tileBBox, this.renderer, this.#program);\n        const mesh = tileMesh.planeMesh;\n\n        const scale = Math.pow(2, zmax - coord.z);\n        mesh.scale.set((1 / w) * scale, (1 / h) * scale, 1);\n        if (!rendererState.u_flip_y) {\n          mesh.position.set((tileBBox.left - xmin) / dx, (tileBBox.top - ymin) / dy, 0);\n        } else {\n          mesh.position.set((tileBBox.left - xmin) / dx, 1 - (tileBBox.top - ymin) / dy, 0);\n        }\n\n        const dataRange: number[] = [];\n        for (const [index, texture] of tile.textures) {\n          if (texture.userData?.dataRange && Array.isArray(texture.userData?.dataRange)) {\n            dataRange.push(...texture.userData.dataRange);\n          }\n          mesh.program.setUniform(`u_image${index}`, texture);\n        }\n\n        if (dataRange.length > 0) {\n          mesh.program.setUniform('dataRange', dataRange);\n        }\n\n        mesh.updateMatrix();\n        mesh.worldMatrixNeedsUpdate = false;\n        mesh.worldMatrix.multiply(camera.worldMatrix, mesh.localMatrix);\n\n        const stencilMode = stencilModes[coord.overscaledZ];\n\n        if (stencilMode) {\n          if (stencilMode.stencil) {\n            this.renderer.state.enable(this.renderer.gl.STENCIL_TEST);\n\n            this.renderer.state.setStencilFunc(stencilMode.func?.cmp, stencilMode.func?.ref, stencilMode.func?.mask);\n            this.renderer.state.setStencilOp(stencilMode.op?.fail, stencilMode.op?.zfail, stencilMode.op?.zpass);\n          } else {\n            this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n          }\n        }\n\n        mesh.draw({\n          ...rendererParams,\n          camera,\n        });\n      }\n    }\n\n    if (renderTarget) {\n      renderTarget.unbind();\n    }\n  }\n\n  /**\n   * 此处绘制主要是合并瓦片\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const { source } = this.options;\n    const sourceCache = source.sourceCache;\n    if (Array.isArray(sourceCache)) {\n      if (sourceCache.length === 2) {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n        this.renderTexture(this.#next, rendererParams, rendererState, sourceCache[1]);\n      } else {\n        this.renderTexture(this.#current, rendererParams, rendererState, sourceCache[0]);\n        this.renderTexture(this.#next, rendererParams, rendererState, sourceCache[0]);\n      }\n    } else {\n      this.renderTexture(this.#current, rendererParams, rendererState, sourceCache);\n      this.renderTexture(this.#next, rendererParams, rendererState, sourceCache);\n    }\n  }\n\n  destroy() {\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#current) {\n      this.#current.destroy();\n      this.#current = null;\n    }\n\n    if (this.#next) {\n      this.#next.destroy();\n      this.#next = null;\n    }\n  }\n}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { BlendType, Geometry, Mesh, Program, RenderTarget, utils, Vector2 } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport { littleEndian } from '../../../utils/common';\nimport vert from '../../../shaders/common.vert.glsl';\nimport frag from '../../../shaders/particles/update.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\n\nexport interface UpdatePassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  bandType: BandType;\n  getParticleNumber: () => number;\n  glScale: number;\n}\n\nexport default class UpdatePass extends Pass<UpdatePassOptions> {\n  readonly prerender = true;\n\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n  #current: WithNull<RenderTarget>;\n  #next: WithNull<RenderTarget>;\n\n  #initialize = true;\n\n  #particleRes: number;\n\n  constructor(id: string, renderer: Renderer, options: UpdatePassOptions = {} as UpdatePassOptions) {\n    super(id, renderer, options);\n\n    this.initializeRenderTarget();\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_fade_t: {\n          value: 0,\n        },\n        displayRange: {\n          value: new Vector2(-Infinity, Infinity),\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n        u_particles: {\n          value: null,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n      blending: BlendType.NoBlending,\n      transparent: true,\n    });\n\n    this.#geometry = new Geometry(renderer, {\n      position: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      uv: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      index: {\n        size: 1,\n        data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n  }\n\n  #getParticleRes() {\n    return Math.ceil(Math.sqrt(this.options.getParticleNumber()));\n  }\n\n  resize() {\n    const particleRes = this.#getParticleRes();\n\n    this.#current?.resize(particleRes, particleRes);\n    this.#next?.resize(particleRes, particleRes);\n  }\n\n  get textures() {\n    return {\n      currentParticles: this.#current?.texture,\n      nextParticles: this.#next?.texture,\n    };\n  }\n\n  setInitialize(state: boolean) {\n    this.#initialize = state;\n  }\n\n  /**\n   * 创建 RenderTarget\n   */\n  initializeRenderTarget() {\n    const particleRes = this.#getParticleRes();\n\n    const particleState = new Float32Array(particleRes ** 2 * 4);\n    const s = this.options.glScale;\n    for (let i = 0; i < particleState.length; i++) {\n      // 不同地图初始化的实际投影位置是不同的，但是这里只能归一化到 0-1（gl），需要在着色器中反算\n      particleState[i] = Math.random() * s;\n    }\n\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt = {\n      data: particleState,\n      width: particleRes,\n      height: particleRes,\n      minFilter: this.renderer.gl.NEAREST,\n      magFilter: this.renderer.gl.NEAREST,\n      type: this.renderer.gl.FLOAT,\n      format: this.renderer.gl.RGBA,\n      internalFormat: this.renderer.isWebGL2\n        ? (this.renderer.gl as WebGL2RenderingContext).RGBA32F\n        : this.renderer.gl.RGBA,\n      stencil: false,\n    };\n\n    this.#current = new RenderTarget(this.renderer, {\n      ...opt,\n      name: 'currentUpdateTexture',\n    });\n    this.#next = new RenderTarget(this.renderer, {\n      ...opt,\n      name: 'nextUpdateTexture',\n    });\n  }\n\n  /**\n   * 交换 RenderTarget\n   */\n  swapRenderTarget() {\n    [this.#current, this.#next] = [this.#next, this.#current];\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const attr = this.renderer.attributes;\n    const camera = rendererParams.cameras.planeCamera;\n    const particleRes = this.#getParticleRes();\n    if (!this.#particleRes || this.#particleRes !== particleRes) {\n      this.#particleRes = particleRes;\n      this.initializeRenderTarget();\n    }\n\n    if (this.#next) {\n      this.#next.bind();\n      if (attr.depth && this.#next.depth) {\n        this.renderer.state.enable(this.renderer.gl.DEPTH_TEST);\n        this.renderer.state.setDepthMask(true);\n      }\n      this.renderer.setViewport(this.#next.width, this.#next.height);\n    }\n    if (rendererState && this.#mesh) {\n      const uniforms = utils.pick(rendererState, [\n        'dataRange',\n        'useDisplayRange',\n        'displayRange',\n        'u_drop_rate',\n        'u_drop_rate_bump',\n        'u_speed_factor',\n        'u_flip_y',\n        'u_gl_scale',\n      ]);\n\n      Object.keys(uniforms).forEach((key) => {\n        if (uniforms[key] !== undefined) {\n          this.#mesh?.program.setUniform(key, uniforms[key]);\n        }\n      });\n\n      const fade = this.options.source?.getFadeTime?.() || 0;\n      this.#mesh.program.setUniform(\n        'u_image_res',\n        new Vector2(this.options.texture.width, this.options.texture.height),\n      );\n      this.#mesh.program.setUniform('u_fade_t', fade);\n      this.#mesh.program.setUniform('u_rand_seed', Math.random());\n      this.#mesh.program.setUniform('u_particles', this.#current?.texture);\n      this.#mesh.program.setUniform('u_bbox', rendererState.extent);\n      this.#mesh.program.setUniform('u_initialize', this.#initialize);\n      this.#mesh.program.setUniform('u_data_bbox', rendererState.sharedState.u_data_bbox);\n\n      this.#mesh.updateMatrix();\n      this.#mesh.worldMatrixNeedsUpdate = false;\n      this.#mesh.worldMatrix.multiply(camera.worldMatrix, this.#mesh.localMatrix);\n      this.#mesh.draw({\n        ...rendererParams,\n        camera,\n      });\n    }\n    if (this.#next) {\n      this.#next.unbind();\n    }\n\n    this.#initialize = false;\n\n    this.swapRenderTarget();\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n\n    if (this.#current) {\n      this.#current.destroy();\n      this.#current = null;\n    }\n\n    if (this.#next) {\n      this.#next.destroy();\n      this.#next = null;\n    }\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { BlendType, Geometry, Mesh, Program } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport { littleEndian } from '../../../utils/common';\nimport vert from '../../../shaders/common.vert.glsl';\nimport frag from '../../../shaders/particles/screen.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\nimport type ParticlesPass from './particles';\n\nexport interface ScreenPassOptions {\n  source: SourceType;\n  bandType: BandType;\n  prerender: boolean;\n  enableBlend: boolean;\n  particlesPass?: ParticlesPass;\n}\n\nexport default class ScreenPass extends Pass<ScreenPassOptions> {\n  public prerender: boolean;\n\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n\n  constructor(id: string, renderer: Renderer, options: ScreenPassOptions = {} as ScreenPassOptions) {\n    super(id, renderer, options);\n    this.prerender = Boolean(options.prerender);\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        opacity: {\n          value: 1,\n        },\n        u_fade: {\n          value: 1,\n        },\n        u_screen: {\n          value: null,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n      transparent: true,\n      blending: options.enableBlend ? BlendType.CustomBlending : BlendType.NoBlending,\n      blendFunc: {\n        src: this.renderer.gl.ONE,\n        dst: this.renderer.gl.ONE_MINUS_SRC_ALPHA,\n      },\n      blendEquation: {\n        modeAlpha: this.renderer.gl.FUNC_ADD,\n        modeRGB: this.renderer.gl.FUNC_ADD,\n      },\n    });\n\n    this.#geometry = new Geometry(renderer, {\n      position: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      uv: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      index: {\n        size: 1,\n        data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n  }\n\n  get renderTarget() {\n    if (this.options.particlesPass && this.prerender) {\n      return this.options.particlesPass.renderTarget;\n    }\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    if (this.renderTarget) {\n      this.renderTarget.bind();\n      this.renderer.setViewport(this.renderTarget.width, this.renderTarget.height);\n    } else {\n      const attr = this.renderer.attributes;\n      this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    }\n    if (rendererState && this.#mesh) {\n      const camera = rendererParams.cameras.planeCamera;\n      this.#mesh.program.setUniform('u_fade', 1);\n      this.#mesh.program.setUniform('u_opacity', this.prerender ? rendererState.fadeOpacity : rendererState.opacity);\n      this.#mesh.program.setUniform(\n        'u_screen',\n        this.prerender\n          ? this.options.particlesPass?.textures.backgroundTexture\n          : this.options.particlesPass?.textures.screenTexture,\n      );\n\n      this.#mesh.updateMatrix();\n      this.#mesh.worldMatrixNeedsUpdate = false;\n      this.#mesh.worldMatrix.multiply(camera.worldMatrix, this.#mesh.localMatrix);\n      this.#mesh.draw({\n        ...rendererParams,\n        camera,\n      });\n    }\n\n    if (this.renderTarget) {\n      this.renderTarget.unbind();\n    }\n\n    if (this.options.particlesPass && !this.prerender) {\n      this.options.particlesPass?.swapRenderTarget();\n    }\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n  }\n}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry, Vector2, RenderTarget, BlendType } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport { littleEndian } from '../../../utils/common';\nimport vert from '../../../shaders/particles/draw.vert.glsl';\nimport frag from '../../../shaders/particles/draw.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\nimport type MaskPass from '../mask';\n\nexport interface ParticlesPassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  getParticles: () => {\n    currentParticles: Texture;\n    nextParticles: Texture;\n  };\n  bandType: BandType;\n  getParticleNumber: () => number;\n  maskPass?: MaskPass;\n}\n\n/**\n * 着色\n */\nexport default class Particles extends Pass<ParticlesPassOptions> {\n  #prerender = true;\n\n  public particleStateResolution: number;\n\n  #privateNumParticles: number;\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n  #screenTexture: WithNull<RenderTarget>;\n  #backgroundTexture: WithNull<RenderTarget>;\n\n  constructor(id: string, renderer: Renderer, options: ParticlesPassOptions = {} as ParticlesPassOptions) {\n    super(id, renderer, options);\n\n    this.initializeRenderTarget();\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_fade_t: {\n          value: 0,\n        },\n        displayRange: {\n          value: new Vector2(-Infinity, Infinity),\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n        u_particles: {\n          value: null,\n        },\n        u_particleSize: {\n          value: 2.0,\n        },\n        u_particlesRes: {\n          value: 0,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n      transparent: true,\n      blending: BlendType.NoBlending,\n      blendFunc: {\n        src: this.renderer.gl.ONE,\n        dst: this.renderer.gl.ONE_MINUS_SRC_ALPHA,\n      },\n      blendEquation: {\n        modeAlpha: this.renderer.gl.FUNC_ADD,\n        modeRGB: this.renderer.gl.FUNC_ADD,\n      },\n    });\n\n    const { particleIndices, particleReferences } = this.getParticleBuffer();\n\n    this.#geometry = new Geometry(renderer, {\n      a_index: {\n        size: 1,\n        data: particleIndices,\n      },\n      reference: {\n        size: 2,\n        data: particleReferences,\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.POINTS,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n  }\n\n  get prerender() {\n    return this.#prerender;\n  }\n\n  set prerender(prerender) {\n    this.#prerender = prerender;\n  }\n\n  get textures() {\n    return {\n      screenTexture: this.#screenTexture?.texture,\n      backgroundTexture: this.#backgroundTexture?.texture,\n    };\n  }\n\n  get renderTarget() {\n    return this.#prerender && this.#screenTexture;\n  }\n\n  resetParticles() {\n    this.#screenTexture?.clear();\n    this.#backgroundTexture?.clear();\n  }\n\n  getParticleBuffer() {\n    const particleRes = Math.ceil(Math.sqrt(this.options.getParticleNumber()));\n    this.particleStateResolution = particleRes;\n    this.#privateNumParticles = particleRes * particleRes;\n    const indexCount = this.#privateNumParticles;\n    const particleIndices = new Float32Array(indexCount);\n    const particleReferences = new Float32Array(indexCount * 2);\n\n    for (let i = 0; i < indexCount; i++) {\n      const t = (i % particleRes) / particleRes;\n      const a = Math.trunc(i / particleRes) / particleRes;\n      particleReferences.set([t, a], 2 * i);\n      particleIndices[i] = i;\n    }\n\n    return { particleIndices, particleReferences };\n  }\n\n  /**\n   * 创建 RenderTarget\n   */\n  initializeRenderTarget() {\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt = {\n      width: this.renderer.width,\n      height: this.renderer.height,\n      minFilter: this.renderer.gl.LINEAR,\n      magFilter: this.renderer.gl.LINEAR,\n      type: this.renderer.gl.UNSIGNED_BYTE,\n      format: this.renderer.gl.RGBA,\n      stencil: true,\n      premultipliedAlpha: false,\n    };\n\n    this.#screenTexture = new RenderTarget(this.renderer, {\n      ...opt,\n      name: 'screenTexture',\n    });\n    this.#backgroundTexture = new RenderTarget(this.renderer, {\n      ...opt,\n      name: 'backgroundTexture',\n    });\n  }\n\n  /**\n   * 交换 RenderTarget\n   */\n  swapRenderTarget() {\n    [this.#screenTexture, this.#backgroundTexture] = [this.#backgroundTexture, this.#screenTexture];\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    if (this.renderTarget) {\n      this.renderTarget.bind();\n      this.renderer.setViewport(this.renderTarget.width, this.renderTarget.height);\n    } else {\n      const attr = this.renderer.attributes;\n      this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    }\n    const { camera } = rendererParams.cameras;\n\n    let stencil;\n\n    if (this.maskPass) {\n      stencil = this.maskPass.render(rendererParams, rendererState);\n    }\n\n    if (rendererState && this.#mesh) {\n      this.#mesh.program.setUniform(\n        'u_image_res',\n        new Vector2(this.options.texture.width, this.options.texture.height),\n      );\n      const fade = this.options.source?.getFadeTime?.() || 0;\n      this.#mesh.program.setUniform('u_fade_t', fade);\n      this.#mesh.program.setUniform('u_colorRamp', rendererState.colorRampTexture);\n      this.#mesh.program.setUniform('u_colorRange', rendererState.colorRange);\n\n      const particleTextures = this.options.getParticles();\n\n      this.#mesh.program.setUniform('u_particles', particleTextures.currentParticles);\n      this.#mesh.program.setUniform('u_particles_next', particleTextures.nextParticles);\n      this.#mesh.program.setUniform('u_particlesRes', this.#privateNumParticles);\n\n      const sharedState = rendererState.sharedState;\n\n      this.#mesh.program.setUniform('u_bbox', rendererState.extent);\n      this.#mesh.program.setUniform('u_data_bbox', sharedState.u_data_bbox);\n\n      this.#mesh.program.setUniform('u_flip_y', rendererState.u_flip_y);\n      this.#mesh.program.setUniform('u_gl_scale', rendererState.u_gl_scale);\n\n      this.#mesh.updateMatrix();\n      this.#mesh.worldMatrixNeedsUpdate = false;\n      this.#mesh.worldMatrix.multiply(rendererParams.scene.worldMatrix, this.#mesh.localMatrix);\n\n      this.#mesh.draw({\n        ...rendererParams,\n        camera,\n      });\n    }\n\n    if (!stencil) {\n      this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n    }\n\n    if (this.renderTarget) {\n      this.renderTarget.unbind();\n    }\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n\n    if (this.#screenTexture) {\n      this.#screenTexture.destroy();\n      this.#screenTexture = null;\n    }\n\n    if (this.#backgroundTexture) {\n      this.#backgroundTexture.destroy();\n      this.#backgroundTexture = null;\n    }\n  }\n}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry, RenderTarget } from '@sakitam-gis/vis-engine';\nimport Pass from './base';\nimport vert from '../../shaders/picker.vert.glsl';\nimport frag from '../../shaders/picker.frag.glsl';\nimport * as shaderLib from '../../shaders/shaderLib';\nimport type { SourceType } from '../../source';\n\nexport interface PickerPassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  useFloatTexture?: boolean;\n}\n\n/**\n * picking\n */\nexport default class PickerPass extends Pass<PickerPassOptions> {\n  readonly prerender = true;\n\n  #program: WithNull<Program>;\n  #mesh: WithNull<Mesh>;\n  #geometry: WithNull<Geometry>;\n  #picker: WithNull<RenderTarget>;\n\n  #rendererParams: any;\n  #rendererState: any;\n\n  constructor(id: string, renderer: Renderer, options: PickerPassOptions = {} as PickerPassOptions) {\n    super(id, renderer, options);\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        u_fade_t: {\n          value: 0,\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n      },\n      includes: shaderLib,\n      transparent: true,\n    });\n\n    this.#geometry = new Geometry(renderer, {\n      position: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      uv: {\n        size: 2,\n        data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      },\n      index: {\n        size: 1,\n        data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n      },\n    });\n\n    this.#mesh = new Mesh(renderer, {\n      mode: renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: this.#geometry,\n    });\n\n    // @link https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    const opt: any = {\n      width: this.renderer.width,\n      height: this.renderer.height,\n      minFilter: renderer.gl.NEAREST,\n      magFilter: renderer.gl.NEAREST,\n      type: this.renderer.gl.UNSIGNED_BYTE,\n      format: this.renderer.gl.RGBA,\n      generateMipmaps: true,\n      internalFormat: this.renderer.gl.RGBA,\n      stencil: false,\n    };\n\n    if (options.useFloatTexture) {\n      opt.type = this.renderer.gl.FLOAT;\n      opt.internalFormat = this.renderer.isWebGL2\n        ? (this.renderer.gl as WebGL2RenderingContext).RGBA32F\n        : this.renderer.gl.RGBA;\n    }\n\n    this.#picker = new RenderTarget(renderer, {\n      ...opt,\n      name: 'pickerRenderTargetTexture',\n    });\n  }\n\n  resize(width: number, height: number) {\n    this.#picker?.resize(width, height);\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   * @param pixel\n   */\n  render(rendererParams = this.#rendererParams, rendererState = this.#rendererState, pixel) {\n    return new Promise((resolve) => {\n      if (!this.#picker || !this.#mesh) return resolve(null);\n      this.#rendererParams = this.#rendererParams !== rendererParams ? rendererParams : this.#rendererParams;\n      this.#rendererState = this.#rendererState !== rendererState ? rendererState : this.#rendererState;\n      const camera = rendererParams.cameras.planeCamera;\n      this.#picker.clear();\n      this.#picker.bind();\n      this.renderer.setViewport(this.#picker.width, this.#picker.height);\n      if (rendererState) {\n        const fade = this.options.source?.getFadeTime?.() || 0;\n\n        this.#mesh.program.setUniform('u_fade_t', fade);\n\n        this.#mesh.updateMatrix();\n        this.#mesh.worldMatrixNeedsUpdate = false;\n        this.#mesh.worldMatrix.multiply(camera.worldMatrix, this.#mesh.localMatrix);\n        this.#mesh.draw({\n          ...rendererParams,\n          camera,\n        });\n\n        if (pixel) {\n          const a = this.options.useFloatTexture ? new Float32Array(4) : new Uint8Array(4);\n          this.renderer.gl.readPixels(\n            pixel[0],\n            pixel[1],\n            1.0,\n            1.0,\n            this.renderer.gl.RGBA,\n            this.options.useFloatTexture ? this.renderer.gl.FLOAT : this.renderer.gl.UNSIGNED_BYTE,\n            a,\n          );\n          resolve(a);\n        } else {\n          resolve(null);\n        }\n      } else {\n        resolve(null);\n      }\n      this.#picker.unbind();\n    });\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n\n    if (this.#picker) {\n      this.#picker.destroy();\n      this.#picker = null;\n    }\n  }\n}\n", "/**\n * ```js\n * [\n *   'interpolate',\n *   ['linear'],\n *   ['get', 'value'],\n *   0.0,\n *   '#3288bd',\n *   10,\n *   '#66c2a5',\n *   20,\n *   '#abdda4',\n * ]\n * ```\n */\nimport { utils } from '@sakitam-gis/vis-engine';\nimport { findStopLessThanOrEqualTo } from './common';\n\nexport function parseColorStyle(styleAttrField: any[]) {\n  if (Array.isArray(styleAttrField) && styleAttrField.length > 3) {\n    const type = styleAttrField[0]; // interpolate\n    const action = styleAttrField[1]; // linear / step\n    // const expression = styleAttrField[2];\n    const interpolateColor: any[] = [];\n    for (let i = 3; i < styleAttrField.length; i += 2) {\n      const val = styleAttrField[i];\n      const color = styleAttrField[i + 1];\n      interpolateColor.push({\n        key: val,\n        value: color,\n      });\n    }\n    return {\n      operator: type,\n      interpolation: {\n        name: action[0],\n        base: action[1],\n      },\n      input: interpolateColor,\n    };\n  } else {\n    console.warn('[wind-core]: style-parser style config invalid');\n    return {};\n  }\n}\n\nexport function parseZoomStyle(styleAttrField: any[]) {\n  if (Array.isArray(styleAttrField) && styleAttrField.length > 3) {\n    const type = styleAttrField[0]; // interpolate\n    const action = styleAttrField[1]; // linear\n    // const expression = styleAttrField[2];\n    const interpolateZoom: {\n      key: string | number;\n      value: string;\n    }[] = [];\n    for (let i = 3; i < styleAttrField.length; i += 2) {\n      const val = styleAttrField[i];\n      const color = styleAttrField[i + 1];\n      interpolateZoom.push({\n        key: val,\n        value: color,\n      });\n    }\n    return {\n      operator: type,\n      interpolation: {\n        name: action[0],\n        base: action[1],\n      },\n      input: interpolateZoom,\n    };\n  } else {\n    console.warn('[wind-core]: style-parser style config invalid');\n    return {};\n  }\n}\n\nfunction createGradient(interpolateColor, min, max, w, h, gradient, ctx) {\n  for (let i = 0; i < interpolateColor.length; i += 1) {\n    const key = interpolateColor[i].key;\n    const color = interpolateColor[i].value;\n    gradient.addColorStop((key - min) / (max - min), color);\n  }\n\n  ctx.fillStyle = gradient;\n  ctx.fillRect(0, 0, w, h);\n}\nfunction createStepGradient(interpolateColor, min, max, w, h, ctx) {\n  for (let i = 0; i < interpolateColor.length; i += 1) {\n    const key = interpolateColor[i].key;\n    let keyNext = key;\n    if (i < interpolateColor.length - 1) {\n      keyNext = interpolateColor[i + 1].key;\n    } else {\n      keyNext = max;\n    }\n    const color = interpolateColor[i].value;\n    const current = ((key - min) / (max - min)) * w; // 0 - w\n    const next = ((keyNext - min) / (max - min)) * w; // 0 - w\n    ctx.fillStyle = color;\n    ctx.fillRect(current, 0, next - current, 1);\n  }\n}\n\nexport function createLinearGradient(\n  range: any[],\n  styleAttrField: any[],\n): {\n  data: Uint8Array;\n  colorRange: [number, number];\n} {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d', { willReadFrequently: true });\n\n  const { input: interpolateColor, interpolation } = parseColorStyle(styleAttrField);\n\n  if (ctx && interpolateColor && Array.isArray(interpolateColor)) {\n    const keys = interpolateColor.map((d) => parseFloat(d.key));\n    const colorRange: [number, number] = [Math.min(...keys), Math.max(...keys)];\n    const [min, max] = [range[0] || colorRange[0], range[1] || colorRange[1]];\n    const w = 256;\n    const h = 1;\n    canvas.width = w;\n    canvas.height = h;\n    const gradient = ctx.createLinearGradient(0, 0, w, 0);\n    if (interpolation?.name === 'linear') {\n      createGradient(interpolateColor, min, max, w, h, gradient, ctx);\n    } else if (interpolation?.name === 'step') {\n      if (interpolation?.base === true || utils.isNumber(interpolation?.base)) {\n        const interval = Number(interpolation?.base); // true == 1\n        createGradient(interpolateColor, min, max, w, h, gradient, ctx);\n        const len = Math.round((max - min) / interval);\n        const canvas2 = document.createElement('canvas');\n        const ctx2 = canvas2.getContext('2d', {\n          willReadFrequently: true,\n        }) as CanvasRenderingContext2D;\n        canvas2.width = w;\n        canvas2.height = h;\n        for (let j = 0; j < len; j++) {\n          let keyNext = j;\n          if (j < len - 1) {\n            keyNext = j + 1;\n          } else {\n            keyNext = len;\n          }\n          const current = Math.round((j / len) * w); // 0 - w\n          const color = ctx.getImageData(current, 0, 1, 1).data;\n          const next = Math.round((keyNext / len) * w); // 0 - w\n          ctx2.fillStyle = `rgba(${color[0]}, ${color[1]}, ${color[2]}, ${color[3] / 255})`;\n          ctx2.fillRect(current, 0, next - current, h);\n        }\n\n        return {\n          data: new Uint8Array(ctx2.getImageData(0, 0, w, h).data),\n          colorRange,\n        };\n      } else if (interpolation?.base === false) {\n        createStepGradient(interpolateColor, min, max, w, h, ctx);\n      }\n    } else {\n      console.warn(`[wind-core]: invalid action type: ${interpolation}`);\n    }\n    return {\n      data: new Uint8Array(ctx.getImageData(0, 0, w, h).data),\n      colorRange,\n    };\n  } else {\n    // @ts-ignore\n    return {};\n  }\n}\n\nfunction exponentialInterpolation(input: number, base: number, lowerValue: number, upperValue: number) {\n  const difference = upperValue - lowerValue;\n  const progress = input - lowerValue;\n\n  if (difference === 0) {\n    return 0;\n  } else if (base === 1) {\n    return progress / difference;\n  } else {\n    return (Math.pow(base, progress) - 1) / (Math.pow(base, difference) - 1);\n  }\n}\n\nexport type InterpolationType =\n  | { name: 'linear' }\n  | { name: 'exponential'; base: number }\n  | { name: 'cubic-bezier'; controlPoints: [number, number, number, number] };\n\nexport function interpolationFactor(interpolation: InterpolationType, input: number, lower: number, upper: number) {\n  let t = 0;\n  if (interpolation.name === 'exponential') {\n    t = exponentialInterpolation(input, interpolation.base, lower, upper);\n  } else if (interpolation.name === 'linear') {\n    t = exponentialInterpolation(input, 1, lower, upper);\n  } else if (interpolation.name === 'cubic-bezier') {\n    console.warn('interpolationFactor');\n  }\n  return t;\n}\n\nexport function interpolateNumber(a: number, b: number, t: number) {\n  return a * (1 - t) + b * t;\n}\n\nexport type CachedStyleItem =\n  | {\n      operator: any;\n      interpolation: any;\n      input: Array<{ key: any; value: any }>;\n    }\n  | { operator?: undefined; interpolation?: undefined; input?: undefined };\n\nconst cachedStyle: {\n  [key: string]: CachedStyleItem;\n} = {};\n\nexport function isRasterize(styleAttrField) {\n  if (Array.isArray(styleAttrField) && styleAttrField.length > 3) {\n    const type = styleAttrField[0]; // interpolate\n    return type === 'rasterize';\n  } else {\n    console.warn('[wind-core]: style-parser style config invalid');\n    return false;\n  }\n}\n\nexport function createZoom(uid: string, zoom: number, key: string, styles: any, clearCache?: boolean): number {\n  const ukey = `${uid}_${key}`;\n  const styleAttrField = styles[key] as any[] | number;\n\n  if (utils.isNumber(styleAttrField)) {\n    if (cachedStyle[ukey]) {\n      delete cachedStyle[ukey];\n    }\n    return styleAttrField as number;\n  }\n\n  if (styleAttrField && Array.isArray(styleAttrField) && (!cachedStyle[ukey] || clearCache)) {\n    cachedStyle[ukey] = parseZoomStyle(styleAttrField);\n  }\n\n  if (cachedStyle[ukey]) {\n    const { input: interpolateZoom, interpolation } = cachedStyle[ukey] || {};\n    if (interpolateZoom && Array.isArray(interpolateZoom)) {\n      const labels = interpolateZoom.map((i) => i.key);\n      const outputs = interpolateZoom.map((i) => i.value);\n\n      if (zoom <= labels[0]) {\n        return outputs[0];\n      }\n      const stopCount = labels.length;\n      if (zoom >= labels[stopCount - 1]) {\n        return outputs[stopCount - 1];\n      }\n\n      const index = findStopLessThanOrEqualTo(labels, zoom);\n      const idx = labels.length - 1;\n\n      const lower = labels[index];\n      const upper = labels[index >= idx ? idx : index + 1];\n\n      const t = interpolationFactor(interpolation, zoom, lower, upper);\n\n      const outputLower = outputs[index];\n      const outputUpper = outputs[index >= idx ? idx : index + 1];\n\n      return interpolateNumber(outputLower, outputUpper, t);\n    } else {\n      return 1;\n    }\n  }\n  return 1;\n}\n", "export type BandType = 0 | 1 | 2 | 3; // 对应以下四种数据类型，用于在着色器中标识使用何种数据解码方式\nexport enum RenderType {\n  /**\n   * 栅格类型图层\n   */\n  image = 0,\n\n  /**\n   * 色斑图\n   */\n  colorize = 1,\n\n  /**\n   * 粒子\n   */\n  particles = 2,\n\n  /**\n   * 矢量场箭头图层\n   */\n  arrow = 3,\n\n  /**\n   * 风羽图\n   */\n  barb = 4,\n\n  /**\n   * 海浪和波\n   */\n  wave = 5,\n}\n\nexport enum RenderFrom {\n  /**\n   * 标量值\n   * 一般需要配合数据配置中的 dataRange 字段解析原始值；\n   * 当然也可以从图像的 `Exif` 信息中提取\n   */\n  r = 'r',\n  /**\n   * 矢量值，常见于气象要素的风速和风向等描述大小和方向的数据\n   * 一般需要配合数据配置中的 dataRange 字段解析原始值；\n   * 当然也可以从图像的 `Exif` 信息中提取\n   */\n  rg = 'rg',\n  /**\n   * 一般用于浮点值（需要在 glsl 中做 rgba2float 转换）\n   */\n  rgba = 'rgba',\n  /**\n   * 浮点值，一般存储在 r 通道或者使用 `LUMINANCE` 通道（精度最高）\n   */\n  float = 'float',\n}\n\nexport function getBandType(renderFrom: RenderFrom) {\n  if (renderFrom === RenderFrom.rg) {\n    return 1;\n  }\n  if (renderFrom === RenderFrom.rgba) {\n    return 2;\n  }\n  if (renderFrom === RenderFrom.float) {\n    return 3;\n  }\n\n  return 0;\n}\n\n/**\n * 解析类型\n */\nexport enum DecodeType {\n  /**\n   * 以 `ImageBitmap` 图像解析\n   */\n  image = 0,\n\n  /**\n   * 解析为 `Uint8Array`\n   */\n  unit8 = 1,\n\n  /**\n   * 使用 `GeoTIFF` 作为解析器\n   */\n  tiff = 2,\n\n  /**\n   * 解析带有 `Exif` 的图像，一般我们使用单通道 `RenderFrom.r` 或者 `RenderFrom.rg`\n   * 可能从 Exif 信息中提取原始值范围。\n   */\n  imageWithExif = 3,\n}\n\nexport enum LayerSourceType {\n  image = 'image',\n  tile = 'tile',\n  timeline = 'timeline',\n}\n\n/**\n * 瓦片尺寸\n */\nexport type TileSize = number;\n\n/**\n * 数据范围\n */\nexport type DataRange = [number, number];\n\nexport type Coordinates = [[number, number], [number, number], [number, number], [number, number]];\n\nexport interface ImageSourceOptions {\n  url: string | [string, string];\n  /**\n   * top left, top right, bottom right, bottom left\n   */\n  coordinates: Coordinates;\n  type?: LayerSourceType.image;\n  dataRange?: DataRange | [DataRange, DataRange];\n  /**\n   * 指定数据解析类型\n   */\n  decodeType?: DecodeType;\n\n  /**\n   * 是否跨世界渲染\n   */\n  wrapX?: boolean;\n  maxTileCacheSize?: number;\n}\n\nexport type Bounds = [number, number, number, number];\n\nexport interface TileSourceOptions {\n  url: string | [string, string];\n  type?: LayerSourceType.tile;\n  minZoom?: number;\n  maxZoom?: number;\n  tileSize?: TileSize;\n  dataRange?: DataRange | [DataRange, DataRange];\n  scheme?: 'xyz' | 'tms';\n  subdomains?: (string | number)[];\n  roundZoom?: boolean;\n  /**\n   * 指定数据解析类型\n   */\n  decodeType?: DecodeType;\n  /**\n   * 是否跨世界渲染\n   */\n  wrapX?: boolean;\n  maxTileCacheSize?: number;\n  tileBounds?: Bounds;\n}\n\nexport type LayerData = ImageSourceOptions | TileSourceOptions;\n\n/**\n * 瓦片状态\n */\nexport enum TileState {\n  /**\n   * 加载中\n   */\n  loading = '0',\n\n  /**\n   * 加载完成\n   */\n  loaded = '1',\n\n  /**\n   * 加载失败\n   */\n  errored = '2',\n\n  /**\n   * 未加载\n   */\n  unloaded = '3',\n\n  /**\n   * 重新加载\n   */\n  reloading = '4',\n}\n\n/**\n * 瓦片范围 (经纬度) [xmin, ymin, xmax, ymax]\n */\nexport type TileBounds = Bounds;\n\n/**\n * 投影后的瓦片范围\n */\nexport interface ProjTileBounds {\n  left: number;\n  top: number;\n  right: number;\n  bottom: number;\n}\n\nexport interface ParseOptionsType {\n  renderFrom: RenderFrom;\n}\n\n/**\n * 图层掩膜类型\n * 0. 不包含：区域外显示\n * 1. 包含：区域内显示\n */\nexport enum MaskType {\n  outside,\n  inside,\n}\n", "import type { Renderer, Attributes } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry } from '@sakitam-gis/vis-engine';\nimport Pass from './base';\nimport maskVert from '../../shaders/mask.vert.glsl';\nimport maskFrag from '../../shaders/mask.frag.glsl';\nimport * as shaderLib from '../../shaders/shaderLib';\nimport { MaskType } from '../../type';\n\nexport interface MaskPassOptions {\n  mask?: {\n    data: Attributes[];\n    type: MaskType;\n  };\n}\n\n/**\n * 遮罩\n */\nexport default class MaskPass extends Pass<MaskPassOptions> {\n  readonly #program: Program;\n  readonly prerender = true;\n\n  #meshes: Mesh[];\n\n  constructor(id: string, renderer: Renderer, options: MaskPassOptions = {} as MaskPassOptions) {\n    super(id, renderer, options);\n\n    this.#program = new Program(renderer, {\n      vertexShader: maskVert,\n      fragmentShader: maskFrag,\n      includes: shaderLib,\n      transparent: true,\n    });\n\n    this.#meshes = [];\n\n    this.updateGeometry();\n  }\n\n  updateGeometry() {\n    const { mask } = this.options;\n\n    if (!mask || mask.data.length === 0) return;\n\n    const len = mask.data.length;\n    let i = 0;\n\n    for (let k = 0; k < this.#meshes.length; k++) {\n      const mesh = this.#meshes[k];\n\n      // 只销毁 Geometry\n      if (mesh.geometry) {\n        mesh.geometry.destroy();\n      }\n    }\n\n    this.#meshes = [];\n    for (; i < len; i++) {\n      const attributes = mask.data[i];\n\n      this.#meshes.push(\n        new Mesh(this.renderer, {\n          mode: this.renderer.gl.TRIANGLES,\n          program: this.#program,\n          geometry: new Geometry(this.renderer, attributes),\n        }),\n      );\n    }\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  render(rendererParams, rendererState) {\n    const attr = this.renderer.attributes;\n    this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    const { worlds = [0] } = rendererParams.cameras;\n    const stencil = this.renderer.gl.getParameter(this.renderer.gl.STENCIL_TEST);\n    if (!stencil) {\n      this.renderer.state.enable(this.renderer.gl.STENCIL_TEST);\n    }\n\n    this.renderer.gl.stencilFunc(this.renderer.gl.ALWAYS, 1, 0xff);\n    this.renderer.gl.stencilOp(this.renderer.gl.REPLACE, this.renderer.gl.REPLACE, this.renderer.gl.REPLACE);\n    this.renderer.gl.stencilMask(0xff); // 模板允许写入\n\n    this.renderer.gl.clearStencil(0); // 置为 0\n    this.renderer.gl.clear(this.renderer.gl.STENCIL_BUFFER_BIT);\n    // 0 0 0 0 0\n    // 0 0 0 0 0\n    // 0 0 0 0 0\n    // 0 0 0 0 0\n    // 0 0 0 0 0\n\n    for (let k = 0; k < this.#meshes.length; k++) {\n      const mesh = this.#meshes[k];\n\n      for (let j = 0; j < worlds.length; j++) {\n        mesh.program.setUniform('u_offset', worlds[j]);\n\n        mesh.updateMatrix();\n        mesh.worldMatrixNeedsUpdate = false;\n        mesh.worldMatrix.multiply(rendererParams.scene.worldMatrix, mesh.localMatrix);\n        mesh.draw({\n          ...rendererParams,\n          camera: rendererParams.cameras.camera,\n        });\n      }\n    }\n    // 0 0 0 0 0\n    // 0 1 1 1 0\n    // 0 1 1 1 0\n    // 0 1 1 1 0\n    // 0 0 0 0 0\n\n    const ref = this.options.mask?.type === MaskType.outside ? 0 : 1;\n\n    // ref 为 0 / 1 的通过测试 @fixme 会与瓦片模板测试冲突\n    this.renderer.gl.stencilFunc(this.renderer.gl.EQUAL, ref, 0xff);\n    this.renderer.gl.stencilOp(this.renderer.gl.KEEP, this.renderer.gl.KEEP, this.renderer.gl.KEEP);\n\n    return stencil;\n  }\n}\n", "import ComposePass from '../particles/compose';\n\nexport default class ArrowComposePass extends ComposePass {}\n", "import type { Renderer, Texture } from '@sakitam-gis/vis-engine';\nimport { Program, Mesh, Geometry, utils, Vector2 } from '@sakitam-gis/vis-engine';\nimport Pass from '../base';\nimport { littleEndian } from '../../../utils/common';\nimport vert from '../../../shaders/arrow.vert.glsl';\nimport frag from '../../../shaders/arraw.frag.glsl';\nimport * as shaderLib from '../../../shaders/shaderLib';\nimport type { BandType } from '../../../type';\nimport type { SourceType } from '../../../source';\nimport type TileID from '../../../tile/TileID';\nimport type MaskPass from '../mask';\n\nexport interface ArrowPassOptions {\n  source: SourceType;\n  texture: Texture;\n  textureNext: Texture;\n  bandType: BandType;\n  getPixelsToUnits: () => [number, number];\n  getGridTiles: (source: SourceType) => TileID[];\n  maskPass?: MaskPass;\n}\n\nconst TILE_EXTENT = 4096.0;\n\n/**\n * arrow\n */\nexport default class ArrowPass extends Pass<ArrowPassOptions> {\n  #mesh: WithNull<Mesh>;\n  #program: WithNull<Program>;\n  #geometry: WithNull<Geometry>;\n  #vertexArray: Float32Array;\n  #lastTileSize: number;\n  #lastSpace: number;\n\n  readonly prerender = false;\n\n  constructor(id: string, renderer: Renderer, options: ArrowPassOptions = {} as ArrowPassOptions) {\n    super(id, renderer, options);\n\n    this.#program = new Program(renderer, {\n      vertexShader: vert,\n      fragmentShader: frag,\n      uniforms: {\n        opacity: {\n          value: 1,\n        },\n        u_fade_t: {\n          value: 0,\n        },\n        displayRange: {\n          value: new Vector2(-Infinity, Infinity),\n        },\n        u_texture: {\n          value: this.options.texture,\n        },\n        u_textureNext: {\n          value: this.options.textureNext,\n        },\n        colorRampTexture: {\n          value: null,\n        },\n      },\n      defines: [`RENDER_TYPE ${this.options.bandType}`, `LITTLE_ENDIAN ${littleEndian}`],\n      includes: shaderLib,\n      transparent: true,\n    });\n\n    this.#mesh = new Mesh(this.renderer, {\n      mode: this.renderer.gl.TRIANGLES,\n      program: this.#program,\n      geometry: new Geometry(this.renderer, {\n        index: {\n          size: 1,\n          // data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n          data: new Uint16Array([0, 1, 2, 0, 2, 3]),\n        },\n        position: {\n          size: 2,\n          // data: new Float32Array([-1, 1, -1, -1, 1, 1, 1, -1]),\n          data: new Float32Array([0, 1, 0, 0, 1, 0, 1, 1]),\n        },\n        uv: {\n          size: 2,\n          data: new Float32Array([0, 1, 0, 0, 1, 0, 1, 1]),\n        },\n        coords: {\n          divisor: 1,\n          data: new Float32Array(2),\n          offset: 0,\n          size: 2,\n          stride: 8,\n        },\n      }),\n    });\n  }\n\n  createTileVertexArray(tileSize: number, space = 20) {\n    if (!this.#vertexArray || tileSize !== this.#lastTileSize || space !== this.#lastSpace) {\n      this.#lastTileSize = tileSize;\n      this.#lastSpace = space;\n      const column = Math.round(tileSize / space);\n\n      const columnUnit = 1 / column;\n\n      const halfUnit = columnUnit / 2;\n      const points: any[] = [];\n\n      for (let j = 0; j < column; j++) {\n        for (let i = 0; i < column; i++) {\n          points.push({\n            x: TILE_EXTENT * (halfUnit + i * columnUnit),\n            y: TILE_EXTENT * (halfUnit + j * columnUnit),\n          });\n        }\n      }\n\n      this.#vertexArray = new Float32Array(points.length * 2);\n\n      for (let i = 0; i < points.length; i++) {\n        const point = points[i];\n        const pos = {\n          x: Math.round(point.x),\n          y: Math.round(point.y),\n        };\n        if (pos.x < 0 || pos.x >= TILE_EXTENT || pos.y < 0 || pos.y >= TILE_EXTENT) continue;\n        this.#vertexArray[2 * i] = pos.x / TILE_EXTENT;\n        this.#vertexArray[2 * i + 1] = pos.y / TILE_EXTENT;\n      }\n\n      const geometry = new Geometry(this.renderer, {\n        index: {\n          size: 1,\n          data: new Uint16Array([0, 1, 2, 0, 2, 3]),\n        },\n        position: {\n          size: 2,\n          data: new Float32Array([0, 1, 0, 0, 1, 0, 1, 1]),\n        },\n        uv: {\n          size: 2,\n          data: new Float32Array([0, 1, 0, 0, 1, 0, 1, 1]),\n        },\n        coords: {\n          divisor: 1,\n          data: this.#vertexArray,\n          offset: 0,\n          size: 2,\n          stride: 8,\n        },\n      });\n\n      if (this.#mesh) {\n        this.#mesh.updateGeometry(geometry, true);\n      }\n    }\n\n    return this.#vertexArray;\n  }\n\n  /**\n   * @param rendererParams\n   * @param rendererState\n   */\n  render(rendererParams, rendererState) {\n    const attr = this.renderer.attributes;\n    this.renderer.setViewport(this.renderer.width * attr.dpr, this.renderer.height * attr.dpr);\n    const camera = rendererParams.cameras.camera;\n    const tileSize = this.options.source.tileSize ?? 256;\n    const tiles = this.options.getGridTiles(this.options.source);\n\n    let stencil;\n\n    if (this.maskPass) {\n      stencil = this.maskPass.render(rendererParams, rendererState);\n    }\n\n    if (rendererState && this.#mesh && tiles && tiles.length > 0) {\n      const uniforms = utils.pick(rendererState, [\n        'opacity',\n        'colorRange',\n        'dataRange',\n        'colorRampTexture',\n        'useDisplayRange',\n        'displayRange',\n      ]);\n\n      const zoom = rendererState.zoom;\n      const dataBounds = rendererState.sharedState.u_data_bbox;\n      this.createTileVertexArray(tileSize, rendererState.symbolSpace);\n      for (let i = 0; i < tiles.length; i++) {\n        const tile = tiles[i];\n        const bounds = tile.getTileProjBounds();\n\n        const scaleFactor = Math.pow(2, zoom - tile.overscaledZ);\n\n        const max = Math.max(bounds.right - bounds.left, bounds.bottom - bounds.top);\n        const scale = 1 / max;\n\n        const pixelToUnits = 1 / (tileSize * scaleFactor) / scale;\n\n        Object.keys(uniforms).forEach((key) => {\n          if (uniforms[key] !== undefined) {\n            this.#mesh?.program.setUniform(key, uniforms[key]);\n          }\n        });\n\n        const fade = this.options.source?.getFadeTime?.() || 0;\n        this.#mesh.program.setUniform(\n          'u_image_res',\n          new Vector2(this.options.texture.width, this.options.texture.height),\n        );\n        this.#mesh.program.setUniform('u_fade_t', fade);\n        this.#mesh.program.setUniform('arrowSize', rendererState.symbolSize);\n        this.#mesh.program.setUniform('pixelsToProjUnit', new Vector2(pixelToUnits, pixelToUnits));\n        this.#mesh.program.setUniform('u_bbox', rendererState.extent);\n        this.#mesh.program.setUniform('u_data_bbox', dataBounds);\n        this.#mesh.program.setUniform(\n          'u_tile_bbox',\n          rendererState.u_flip_y\n            ? [bounds.left, bounds.bottom, bounds.right, bounds.top]\n            : [bounds.left, bounds.top, bounds.right, bounds.bottom],\n        );\n        this.#mesh.program.setUniform('u_head', 0.1);\n        this.#mesh.program.setUniform('u_devicePixelRatio', attr.dpr);\n        this.#mesh.program.setUniform('u_texture', this.options.texture);\n        this.#mesh.program.setUniform('u_textureNext', this.options.textureNext);\n        this.#mesh.program.setUniform('u_flip_y', rendererState.u_flip_y);\n        this.#mesh.program.setUniform('u_zoomScale', rendererState.u_zoomScale);\n\n        this.#mesh.updateMatrix();\n        this.#mesh.worldMatrixNeedsUpdate = false;\n        this.#mesh.worldMatrix.multiply(rendererParams.scene.worldMatrix, this.#mesh.localMatrix);\n        this.#mesh.draw({\n          ...rendererParams,\n          camera,\n        });\n      }\n    }\n\n    if (!stencil) {\n      this.renderer.state.disable(this.renderer.gl.STENCIL_TEST);\n    }\n  }\n\n  destroy() {\n    if (this.#mesh) {\n      this.#mesh.destroy();\n      this.#mesh = null;\n    }\n\n    if (this.#program) {\n      this.#program.destroy();\n      this.#program = null;\n    }\n\n    if (this.#geometry) {\n      this.#geometry.destroy();\n      this.#geometry = null;\n    }\n  }\n}\n", "import type { Attributes, Renderer, Scene } from '@sakitam-gis/vis-engine';\nimport { DataTexture, Raf, utils, Vector2 } from '@sakitam-gis/vis-engine';\nimport wgw from 'wind-gl-worker';\nimport Pipelines from './Pipelines';\nimport ColorizeComposePass from './pass/color/compose';\nimport ColorizePass from './pass/color/colorize';\nimport RasterPass from './pass/raster/image';\nimport RasterComposePass from './pass/raster/compose';\nimport ParticlesComposePass from './pass/particles/compose';\nimport UpdatePass from './pass/particles/update';\nimport ScreenPass from './pass/particles/screen';\nimport ParticlesPass from './pass/particles/particles';\nimport PickerPass from './pass/picker';\nimport { isFunction, resolveURL } from '../utils/common';\nimport {createLinearGradient, createZoom, isRasterize} from '../utils/style-parser';\nimport type { MaskType } from '../type';\nimport { getBandType, RenderFrom, RenderType } from '../type';\nimport type { SourceType } from '../source';\nimport type Tile from '../tile/Tile';\nimport type TileID from '../tile/TileID';\nimport MaskPass from './pass/mask';\nimport ArrowComposePass from './pass/arrow/compose';\nimport ArrowPass from './pass/arrow/arrow';\n// import ComposeRenderPass from './pass/particles/compose-test';\n\nexport interface UserOptions {\n  /**\n   * 渲染类型\n   * 目前支持三种类型：\n   * 0：普通 raster 瓦片渲染\n   * 1：气象数据的色斑图渲染\n   * 2：风等 vector 数据的粒子渲染\n   */\n  renderType: RenderType;\n  /**\n   * 指定渲染通道\n   */\n  renderFrom?: RenderFrom;\n  styleSpec?: {\n    'fill-color'?: any[];\n    opacity?: number | any[];\n    numParticles?: number | any[];\n    speedFactor?: number | any[];\n    fadeOpacity?: number | any[];\n    dropRate?: number | any[];\n    dropRateBump?: number | any[];\n\n    /**\n     * arrow space\n     */\n    space?: number | any[];\n\n    /**\n     * arrow size\n     */\n    size?: [number, number];\n  };\n\n  displayRange?: [number, number];\n  widthSegments?: number;\n  heightSegments?: number;\n  wireframe?: boolean;\n\n  flipY?: boolean;\n\n  /**\n   * 是否开启拾取\n   */\n  picking?: boolean;\n  /**\n   * 可以为任意 GeoJSON 数据\n   */\n  mask?: {\n    data: Attributes[];\n    type: MaskType;\n  };\n}\n\nexport interface BaseLayerOptions extends UserOptions {\n  /**\n   * 获取当前视野内的瓦片\n   */\n  getViewTiles: (data: any, renderType: RenderType) => TileID[];\n\n  /**\n   * 这里我们 Mock 一个瓦片图层，用于获取视野内的所有可渲染瓦片，与getViewTiles不同的是\n   * 此方法不会限制层级，方便我们在大层级时也能合理采样\n   */\n  getGridTiles: (source: SourceType) => TileID[];\n\n  /**\n   * 获取某层级下瓦片的投影宽高\n   * @param z\n   */\n  getTileProjSize: (z: number, tiles: TileID[]) => [number, number];\n\n  /**\n   * 获取当前视图下像素和投影的转换关系\n   */\n  getPixelsToUnits: () => [number, number];\n\n  /**\n   * 像素到投影坐标的转换关系\n   */\n  getPixelsToProjUnit: () => [number, number];\n\n  getZoom?: () => number;\n  getExtent?: () => number[];\n  triggerRepaint?: () => void;\n  flipY?: boolean;\n\n  glScale?: () => number;\n  zoomScale?: () => number;\n  onInit?: (error, data) => void;\n}\n\nexport const defaultOptions: BaseLayerOptions = {\n  getViewTiles: () => [],\n  getGridTiles: () => [],\n  getTileProjSize: (z) => [256, 256], // eslint-disable-line\n  getPixelsToUnits: () => [1, 1],\n  getPixelsToProjUnit: () => [1, 1],\n  renderType: RenderType.colorize,\n  renderFrom: RenderFrom.r,\n  styleSpec: {\n    'fill-color': [\n      'interpolate',\n      ['linear'],\n      ['get', 'value'],\n      0.0,\n      '#3288bd',\n      10,\n      '#66c2a5',\n      20,\n      '#abdda4',\n      30,\n      '#e6f598',\n      40,\n      '#fee08b',\n      50,\n      '#fdae61',\n      60,\n      '#f46d43',\n      100.0,\n      '#d53e4f',\n    ],\n    opacity: 1,\n    numParticles: 65535,\n    speedFactor: 1,\n    fadeOpacity: 0.93,\n    dropRate: 0.003,\n    dropRateBump: 0.002,\n    space: 20,\n    size: [16, 16],\n  },\n  displayRange: [Infinity, Infinity],\n  widthSegments: 1,\n  heightSegments: 1,\n  wireframe: false,\n  flipY: false,\n  glScale: () => 1,\n  zoomScale: () => 1,\n  onInit: () => undefined,\n};\n\n/**\n * 因为使用的是共享 worker 所以外部依赖仅需要注册一次\n */\nlet registerDeps = false;\n\nexport default class BaseLayer {\n  private options: BaseLayerOptions;\n  private readonly uid: string;\n  private renderPipeline: WithNull<Pipelines>;\n  private readonly scene: Scene;\n  private readonly renderer: Renderer;\n  private readonly dispatcher: any;\n  private readonly source: SourceType;\n  private raf: Raf;\n  private sharedState: {\n    u_bbox: [number, number, number, number];\n    u_data_bbox: [number, number, number, number];\n    u_scale: [number, number];\n  };\n\n  #opacity: number;\n  #numParticles: number;\n  #speedFactor: number;\n  #fadeOpacity: number;\n  #dropRate: number;\n  #dropRateBump: number;\n  #space: number;\n  #size: [number, number];\n  #colorRange: Vector2;\n  #colorRampTexture: DataTexture;\n  #nextStencilID: number;\n  #maskPass: MaskPass;\n  #isRasterize: boolean;\n\n  constructor(source: SourceType, rs: { renderer: Renderer; scene: Scene }, options?: Partial<BaseLayerOptions>) {\n    this.renderer = rs.renderer;\n    this.scene = rs.scene;\n    this.source = source;\n\n    if (!this.renderer) {\n      throw new Error('initialize error');\n    }\n\n    this.uid = utils.uid('ScalarFill');\n\n    if (!options) {\n      // eslint-disable-next-line no-param-reassign\n      options = {} as BaseLayerOptions;\n    }\n\n    this.options = {\n      ...defaultOptions,\n      ...options,\n      styleSpec: {\n        ...defaultOptions.styleSpec,\n        ...options.styleSpec,\n      },\n    };\n\n    this.#opacity = 1;\n\n    this.#nextStencilID = 1;\n\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    this.dispatcher = new wgw.Dispatcher(wgw.getGlobalWorkerPool(), this, this.uid);\n\n    if (!registerDeps) {\n      const deps = wgw.getConfigDeps();\n      this.dispatcher.broadcast(\n        'configDeps',\n        deps.map((d) => resolveURL(d)),\n        (err, data) => {\n          this.options.onInit?.(err, data);\n        },\n      );\n      registerDeps = true;\n    }\n\n    this.update = this.update.bind(this);\n    this.onTileLoaded = this.onTileLoaded.bind(this);\n\n    this.source.prepare(this.renderer, this.dispatcher, {\n      renderFrom: this.options.renderFrom ?? RenderFrom.r,\n    });\n    this.source.onAdd(this);\n    if (Array.isArray(this.source.sourceCache)) {\n      this.source.sourceCache.forEach((s) => {\n        s.on('update', this.update);\n        s.on('tileLoaded', this.onTileLoaded);\n      });\n    } else {\n      this.source.sourceCache.on('update', this.update);\n      this.source.sourceCache.on('tileLoaded', this.onTileLoaded);\n    }\n\n    this.initialize();\n  }\n\n  initialize() {\n    this.updateOptions({});\n    this.sharedState = {\n      u_bbox: [0, 0, 1, 1],\n      u_data_bbox: [0, 0, 1, 1],\n      u_scale: [1, 1],\n    };\n    this.renderPipeline = new Pipelines(this.renderer);\n    const bandType = getBandType(this.options.renderFrom ?? RenderFrom.r);\n\n    if (this.options.mask) {\n      this.#maskPass = new MaskPass('MaskPass', this.renderer, {\n        mask: this.options.mask,\n      });\n    }\n\n    if (this.options.renderType === RenderType.image) {\n      const composePass = new RasterComposePass('RasterComposePass', this.renderer, {\n        bandType,\n        source: this.source,\n        renderFrom: this.options.renderFrom ?? RenderFrom.r,\n        maskPass: this.#maskPass,\n        stencilConfigForOverlap: this.stencilConfigForOverlap.bind(this),\n      });\n      const rasterPass = new RasterPass('RasterPass', this.renderer, {\n        bandType,\n        source: this.source,\n        texture: composePass.textures.current,\n        textureNext: composePass.textures.next,\n      });\n      this.renderPipeline?.addPass(composePass);\n      if (this.options.picking) {\n        const pickerPass = new PickerPass('PickerPass', this.renderer, {\n          source: this.source,\n          texture: composePass.textures.current,\n          textureNext: composePass.textures.next,\n          useFloatTexture: false,\n        });\n        this.renderPipeline?.addPass(pickerPass);\n      }\n      this.renderPipeline?.addPass(rasterPass);\n    } else if (this.options.renderType === RenderType.colorize) {\n      const composePass = new ColorizeComposePass('ColorizeComposePass', this.renderer, {\n        bandType,\n        source: this.source,\n        renderFrom: this.options.renderFrom ?? RenderFrom.r,\n        maskPass: this.#maskPass,\n        stencilConfigForOverlap: this.stencilConfigForOverlap.bind(this),\n        isRasterize: () => this.#isRasterize,\n      });\n      const colorizePass = new ColorizePass('ColorizePass', this.renderer, {\n        bandType,\n        source: this.source,\n        texture: composePass.textures.current,\n        textureNext: composePass.textures.next,\n      });\n      this.renderPipeline?.addPass(composePass);\n\n      if (this.options.picking) {\n        const pickerPass = new PickerPass('PickerPass', this.renderer, {\n          source: this.source,\n          texture: composePass.textures.current,\n          textureNext: composePass.textures.next,\n          useFloatTexture: true,\n        });\n        this.renderPipeline?.addPass(pickerPass);\n      }\n\n      this.renderPipeline?.addPass(colorizePass);\n    } else if (this.options.renderType === RenderType.particles) {\n      const composePass = new ParticlesComposePass('ParticlesComposePass', this.renderer, {\n        id: utils.uid('ParticlesComposePass'),\n        bandType,\n        source: this.source,\n        renderFrom: this.options.renderFrom ?? RenderFrom.r,\n        stencilConfigForOverlap: this.stencilConfigForOverlap.bind(this),\n        getTileProjSize: this.options.getTileProjSize,\n      });\n      this.renderPipeline?.addPass(composePass);\n\n      const updatePass = new UpdatePass('UpdatePass', this.renderer, {\n        bandType,\n        source: this.source,\n        texture: composePass.textures.current,\n        textureNext: composePass.textures.next,\n        getParticleNumber: () => this.#numParticles,\n        glScale: this.options.glScale?.() as number,\n      });\n      this.renderPipeline?.addPass(updatePass);\n\n      const particlesPass = new ParticlesPass('ParticlesPass', this.renderer, {\n        bandType,\n        source: this.source,\n        texture: composePass.textures.current,\n        textureNext: composePass.textures.next,\n        getParticles: () => updatePass.textures,\n        getParticleNumber: () => this.#numParticles,\n        maskPass: this.#maskPass,\n      });\n\n      const particlesTexturePass = new ScreenPass('ParticlesTexturePass', this.renderer, {\n        bandType,\n        source: this.source,\n        prerender: true,\n        enableBlend: false,\n        particlesPass,\n      });\n\n      this.renderPipeline?.addPass(particlesTexturePass);\n      this.renderPipeline?.addPass(particlesPass);\n\n      const screenPass = new ScreenPass('ScreenPass', this.renderer, {\n        bandType,\n        source: this.source,\n        prerender: false,\n        enableBlend: true,\n        particlesPass,\n      });\n\n      this.renderPipeline?.addPass(screenPass);\n\n      this.raf = new Raf(\n        () => {\n          if (this.options.triggerRepaint) {\n            this.options.triggerRepaint();\n          }\n        },\n        { autoStart: true },\n      );\n    } else if (this.options.renderType === RenderType.arrow) {\n      const composePass = new ArrowComposePass('ArrowComposePass', this.renderer, {\n        id: utils.uid('ArrowComposePass'),\n        bandType,\n        source: this.source,\n        renderFrom: this.options.renderFrom ?? RenderFrom.r,\n        stencilConfigForOverlap: this.stencilConfigForOverlap.bind(this),\n        getTileProjSize: this.options.getTileProjSize,\n      });\n      const arrowPass = new ArrowPass('ArrowPass', this.renderer, {\n        bandType,\n        source: this.source,\n        texture: composePass.textures.current,\n        textureNext: composePass.textures.next,\n        getPixelsToUnits: this.options.getPixelsToUnits,\n        getGridTiles: this.options.getGridTiles,\n        maskPass: this.#maskPass,\n      });\n      this.renderPipeline?.addPass(composePass);\n      this.renderPipeline?.addPass(arrowPass);\n    }\n  }\n\n  updateOptions(options: Partial<UserOptions>) {\n    this.options = {\n      ...this.options,\n      ...options,\n      styleSpec: {\n        ...this.options.styleSpec,\n        ...options?.styleSpec,\n      },\n    };\n\n    this.buildColorRamp();\n    this.parseStyleSpec(true);\n    this.options?.triggerRepaint?.();\n  }\n\n  resize(width: number, height: number) {\n    if (this.renderPipeline) {\n      this.renderPipeline.resize(width, height);\n    }\n  }\n\n  /**\n   * 设置填色色阶\n   */\n  setFillColor() {\n    this.buildColorRamp();\n  }\n\n  /**\n   * 设置图层透明度\n   * @param opacity\n   */\n  setOpacity(opacity: number) {\n    this.#opacity = opacity;\n  }\n\n  /**\n   * 设置粒子图层的粒子数量\n   * @param numParticles\n   */\n  setNumParticles(numParticles: number) {\n    this.#numParticles = numParticles;\n  }\n\n  /**\n   * 设置粒子图层的粒子数量\n   * @param speedFactor\n   */\n  setSpeedFactor(speedFactor: number) {\n    this.#speedFactor = speedFactor;\n  }\n\n  /**\n   * 设置粒子图层的粒子数量\n   * @param fadeOpacity\n   */\n  setFadeOpacity(fadeOpacity: number) {\n    this.#fadeOpacity = fadeOpacity;\n  }\n\n  /**\n   * 设置粒子图层的粒子数量\n   * @param dropRate\n   */\n  setDropRate(dropRate: number) {\n    this.#dropRate = dropRate;\n  }\n\n  /**\n   * 设置粒子图层的粒子数量\n   * @param dropRateBump\n   */\n  setDropRateBump(dropRateBump: number) {\n    this.#dropRateBump = dropRateBump;\n  }\n\n  /**\n   * 设置 symbol 的间距\n   * @param space\n   */\n  setSymbolSpace(space) {\n    this.#space = space;\n  }\n\n  /**\n   * 设置 symbol 的大小\n   * @param size\n   */\n  setSymbolSize(size) {\n    this.#size = size;\n  }\n\n  /**\n   * 解析样式配置\n   * @param clear\n   */\n  parseStyleSpec(clear) {\n    if (isFunction(this.options.getZoom)) {\n      const zoom = this.options.getZoom();\n      this.setOpacity(createZoom(this.uid, zoom, 'opacity', this.options.styleSpec, clear));\n      if (this.options.renderType === RenderType.particles) {\n        this.setNumParticles(createZoom(this.uid, zoom, 'numParticles', this.options.styleSpec, clear));\n        this.setFadeOpacity(createZoom(this.uid, zoom, 'fadeOpacity', this.options.styleSpec, clear));\n        this.setSpeedFactor(createZoom(this.uid, zoom, 'speedFactor', this.options.styleSpec, clear));\n        this.setDropRate(createZoom(this.uid, zoom, 'dropRate', this.options.styleSpec, clear));\n        this.setDropRateBump(createZoom(this.uid, zoom, 'dropRateBump', this.options.styleSpec, clear));\n      }\n\n      if (this.options.renderType === RenderType.arrow) {\n        this.setSymbolSize(this.options.styleSpec?.size);\n        this.setSymbolSpace(createZoom(this.uid, zoom, 'space', this.options.styleSpec, clear));\n      }\n    }\n  }\n\n  /**\n   * 处理地图缩放事件\n   */\n  handleZoom() {\n    this.parseStyleSpec(false);\n  }\n\n  /**\n   * 构建渲染所需色带\n   */\n  buildColorRamp() {\n    if (!this.options.styleSpec?.['fill-color']) return;\n    const { data, colorRange } = createLinearGradient([], this.options.styleSpec?.['fill-color'] as any[]);\n    this.#isRasterize = isRasterize(this.options.styleSpec?.['fill-color']);\n\n    if (colorRange) {\n      this.#colorRange = new Vector2(...colorRange);\n    }\n\n    if (data) {\n      this.#colorRampTexture = new DataTexture(this.renderer, {\n        data,\n        name: 'colorRampTexture',\n        magFilter: this.renderer.gl.NEAREST,\n        minFilter: this.renderer.gl.NEAREST,\n        width: 255,\n        height: 1,\n      });\n    }\n  }\n\n  clearStencil() {\n    this.#nextStencilID = 1;\n  }\n\n  stencilConfigForOverlap(tiles: any[]): [{ [_: number]: any }, Tile[]] {\n    const coords = tiles.sort((a, b) => b.overscaledZ - a.overscaledZ);\n    const minTileZ = coords[coords.length - 1].overscaledZ;\n    const stencilValues = coords[0].overscaledZ - minTileZ + 1;\n    if (stencilValues > 1) {\n      if (this.#nextStencilID + stencilValues > 256) {\n        this.clearStencil();\n      }\n      const zToStencilMode = {};\n      for (let i = 0; i < stencilValues; i++) {\n        zToStencilMode[i + minTileZ] = {\n          stencil: true,\n          mask: 0xff,\n          func: {\n            cmp: this.renderer.gl.GEQUAL,\n            ref: i + this.#nextStencilID,\n            mask: 0xff,\n          },\n          op: {\n            fail: this.renderer.gl.KEEP,\n            zfail: this.renderer.gl.KEEP,\n            zpass: this.renderer.gl.REPLACE,\n          },\n        };\n      }\n      this.#nextStencilID += stencilValues;\n      return [zToStencilMode, coords];\n    }\n    return [\n      {\n        [minTileZ]: {\n          // 禁止写入\n          stencil: false,\n          mask: 0,\n          func: {\n            cmp: this.renderer.gl.ALWAYS,\n            ref: 0,\n            mask: 0,\n          },\n          op: {\n            fail: this.renderer.gl.KEEP,\n            zfail: this.renderer.gl.KEEP,\n            zpass: this.renderer.gl.KEEP,\n          },\n        },\n      },\n      coords,\n    ];\n  }\n\n  moveStart() {\n    if (this.renderPipeline && this.options.renderType === RenderType.particles) {\n      const particlesPass = this.renderPipeline.getPass('ParticlesPass');\n\n      if (particlesPass) {\n        particlesPass.resetParticles();\n      }\n\n      this.renderPipeline.passes.forEach((pass) => {\n        if (pass.id === 'ParticlesTexturePass' || pass.id === 'ScreenPass') {\n          pass.enabled = false;\n        }\n        if (pass.id === 'ParticlesPass') {\n          pass.prerender = false;\n        }\n      });\n    }\n  }\n\n  moveEnd() {\n    if (this.renderPipeline && this.options.renderType === RenderType.particles) {\n      const updatePass = this.renderPipeline.getPass('UpdatePass');\n\n      if (updatePass) {\n        // updatePass.initializeRenderTarget();\n        updatePass.setInitialize(true);\n      }\n\n      this.renderPipeline.passes.forEach((pass) => {\n        if (pass.id === 'ParticlesTexturePass' || pass.id === 'ScreenPass') {\n          pass.enabled = true;\n        }\n\n        if (pass.id === 'ParticlesPass') {\n          pass.prerender = true;\n          // pass.resetParticles();\n        }\n      });\n    }\n  }\n\n  /**\n   * 更新视野内的瓦片\n   */\n  update() {\n    const tiles = this.options.getViewTiles(this.source, this.options.renderType);\n    if (Array.isArray(this.source.sourceCache)) {\n      this.source.sourceCache.forEach((s) => {\n        s?.update(tiles);\n      });\n    } else {\n      this.source.sourceCache?.update(tiles);\n    }\n  }\n\n  onTileLoaded() {\n    if (this.options.triggerRepaint && isFunction(this.options.triggerRepaint)) {\n      this.options.triggerRepaint();\n    }\n  }\n\n  setMask(mask: BaseLayerOptions['mask']) {\n    this.options.mask = mask;\n\n    if (this.options.mask) {\n      if (!this.#maskPass) {\n        this.#maskPass = new MaskPass('MaskPass', this.renderer, {\n          mask: this.options.mask,\n        });\n\n        const raster = this.renderPipeline?.getPass('RasterComposePass');\n        if (raster) {\n          raster.setMaskPass(this.#maskPass);\n        }\n        const colorize = this.renderPipeline?.getPass('ColorizeComposePass');\n        if (colorize) {\n          colorize.setMaskPass(this.#maskPass);\n        }\n        const particles = this.renderPipeline?.getPass('ParticlesPass');\n        if (particles) {\n          particles.setMaskPass(this.#maskPass);\n        }\n\n        const arrow = this.renderPipeline?.getPass('ArrowPass');\n        if (arrow) {\n          arrow.setMaskPass(this.#maskPass);\n        }\n      }\n\n      this.#maskPass.updateGeometry();\n\n      this.options?.triggerRepaint?.();\n    }\n  }\n\n  async picker(pixel = [0, 0]) {\n    if (!this.renderPipeline) return null;\n    const pickerPass = this.renderPipeline.getPass('PickerPass');\n    if (!pickerPass) return null;\n    return pickerPass.render(undefined, undefined, pixel);\n  }\n\n  prerender(cameras, renderTarget?: any) {\n    if (this.renderPipeline) {\n      this.renderPipeline.prerender(\n        {\n          scene: this.scene,\n          cameras,\n          ...(renderTarget ? { target: renderTarget } : {}),\n        },\n        {\n          zoom: this.options?.getZoom?.() ?? 0,\n          extent: this.options?.getExtent?.(),\n          opacity: this.#opacity,\n          fadeOpacity: this.#fadeOpacity,\n          numParticles: this.#numParticles,\n          colorRange: this.#colorRange,\n          colorRampTexture: this.#colorRampTexture,\n          sharedState: this.sharedState,\n          u_drop_rate: this.#dropRate,\n          u_drop_rate_bump: this.#dropRateBump,\n          u_speed_factor: this.#speedFactor,\n          u_flip_y: this.options.flipY,\n          u_gl_scale: this.options.glScale?.(),\n          u_zoomScale: this.options.zoomScale?.(),\n          symbolSize: this.#size,\n          symbolSpace: this.#space,\n          pixelsToProjUnit: this.options.getPixelsToProjUnit(),\n        },\n      );\n    }\n  }\n\n  render(cameras, renderTarget?: any) {\n    if (this.renderPipeline) {\n      const state: any = {\n        zoom: this.options?.getZoom?.() ?? 0,\n        extent: this.options?.getExtent?.(),\n        opacity: this.#opacity,\n        fadeOpacity: this.#fadeOpacity,\n        numParticles: this.#numParticles,\n        colorRange: this.#colorRange,\n        colorRampTexture: this.#colorRampTexture,\n        displayRange: this.options.displayRange,\n        useDisplayRange: Boolean(this.options.displayRange),\n        sharedState: this.sharedState,\n        u_drop_rate: this.#dropRate,\n        u_drop_rate_bump: this.#dropRateBump,\n        u_speed_factor: this.#speedFactor,\n        u_flip_y: this.options.flipY,\n        u_gl_scale: this.options.glScale?.(),\n        u_zoomScale: this.options.zoomScale?.(),\n        symbolSize: this.#size,\n        symbolSpace: this.#space,\n        pixelsToProjUnit: this.options.getPixelsToProjUnit(),\n      };\n\n      this.renderPipeline.render(\n        {\n          scene: this.scene,\n          cameras,\n          ...(renderTarget ? { target: renderTarget } : {}),\n        },\n        state,\n      );\n    }\n  }\n\n  /**\n   * 销毁此 Renderer\n   */\n  destroy() {\n    if (this.raf) {\n      this.raf.stop();\n    }\n    if (this.renderPipeline) {\n      this.renderPipeline.destroy();\n      this.renderPipeline = null;\n    }\n    if (this.source) {\n      if (Array.isArray(this.source.sourceCache)) {\n        this.source.sourceCache.forEach((s) => {\n          s.off('update', this.update);\n          s.off('tileLoaded', this.onTileLoaded);\n        });\n      } else {\n        this.source.sourceCache.off('update', this.update);\n        this.source.sourceCache.off('tileLoaded', this.onTileLoaded);\n      }\n      this.source.destroy();\n    }\n  }\n}\n", "import type { TileBounds, ProjTileBounds } from '../type';\nimport { isFunction } from '../utils/common';\n\nexport interface TileIDOptions {\n  getTileBounds?: (tileID: TileID) => TileBounds;\n  getTileProjBounds: (tileID: TileID) => ProjTileBounds;\n}\n\nexport default class TileID {\n  /**\n   * 瓦片列\n   */\n  public x: number;\n\n  /**\n   * 跨世界后的瓦片列\n   */\n  public wrapedX: number;\n  /**\n   * 瓦片行\n   */\n  public y: number;\n\n  /**\n   * 跨世界后的瓦片行（目前仅 maptalks 支持）\n   */\n  public wrapedY: number;\n\n  /**\n   * 瓦片层级\n   */\n  public z: number;\n  /**\n   * 所在世界（如果是多世界的话）\n   */\n  public wrap: number;\n\n  /**\n   * 放大后的 zoom 值\n   */\n  public overscaledZ: number;\n  /**\n   * 瓦片唯一标识\n   */\n  public tileKey: string;\n  /**\n   * 不包含跨世界的瓦片标识（因为多个世界的瓦片如果仅仅是 `wrap` 不同，他们对应的数据资源是完全相同的）\n   */\n  public unWrappedTileKey: string;\n\n  /**\n   * 瓦片范围（每次获取时计算）\n   */\n  public tileBounds: TileBounds;\n\n  /**\n   * 投影后的瓦片范围\n   */\n  public projTileBounds: ProjTileBounds;\n\n  public options: TileIDOptions;\n\n  /**\n   * 挂载的其他数据\n   */\n  public dep: any;\n\n  /**\n   * @param overscaledZ 扩大的 z 值\n   * @param wrap 所处世界\n   * @param z 层级\n   * @param x 列\n   * @param y 行\n   * @param options 瓦片其他配置\n   */\n  constructor(\n    overscaledZ: number,\n    wrap = 0,\n    z: number,\n    x: number,\n    y: number,\n    options: TileIDOptions = {} as TileIDOptions,\n  ) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.wrap = wrap;\n    this.tileKey = `${z}_${x}_${y}-${wrap}`;\n    this.unWrappedTileKey = `${z}_${x}_${y}`;\n\n    const max = Math.pow(2, this.z);\n\n    this.wrapedX = max * wrap + this.x;\n    this.wrapedY = this.y;\n    this.overscaledZ = overscaledZ;\n    this.options = options;\n\n    this.getTileBounds();\n  }\n\n  /**\n   * 获取瓦片范围\n   */\n  getTileBounds(tileID = this) {\n    if (isFunction(this.options.getTileBounds)) {\n      this.tileBounds = this.options.getTileBounds(tileID);\n    } else {\n      console.error('[TileID]: projection function must be provided');\n    }\n    return this.tileBounds;\n  }\n\n  /**\n   * 获取瓦片投影后的范围\n   */\n  getTileProjBounds(tileID = this, force?: boolean) {\n    if (!this.projTileBounds || force) {\n      this.projTileBounds = this.options.getTileProjBounds?.(tileID);\n    }\n\n    return this.projTileBounds;\n  }\n\n  overscaleFactor(): number {\n    return Math.pow(2, this.overscaledZ - this.z);\n  }\n\n  /**\n   * 缩放到目标层级\n   * @param targetZ\n   */\n  scaledTo(targetZ: number): TileID {\n    const zDifference = this.z - targetZ;\n    if (targetZ > this.z) {\n      return new TileID(targetZ, this.wrap, this.z, this.x, this.y, this.options);\n    } else {\n      return new TileID(targetZ, this.wrap, targetZ, this.x >> zDifference, this.y >> zDifference, this.options);\n    }\n  }\n\n  /**\n   * 获取父级瓦片\n   */\n  parent() {\n    if (this.z > 0) return new TileID(this.z - 1, this.wrap, this.z - 1, this.x >> 1, this.y >> 1, this.options);\n    else return new TileID(this.z, this.wrap, this.z, this.x, this.y, this.options);\n  }\n\n  /**\n   * 查找当前瓦片的子瓦片\n   * @param sourceMaxZoom\n   */\n  children(sourceMaxZoom: number): TileID[] {\n    // 如果所需层级大于了数据的最大层级，那么不需要寻找子集瓦片\n    if (this.overscaledZ >= sourceMaxZoom) {\n      return [new TileID(this.overscaledZ + 1, this.wrap, this.z, this.x, this.y, this.options)];\n    }\n\n    const z = this.z + 1;\n    const x = this.x * 2;\n    const y = this.y * 2;\n    return [\n      new TileID(z, this.wrap, z, x, y, this.options),\n      new TileID(z, this.wrap, z, x + 1, y, this.options),\n      new TileID(z, this.wrap, z, x, y + 1, this.options),\n      new TileID(z, this.wrap, z, x + 1, y + 1, this.options),\n    ];\n  }\n\n  /**\n   * 查找兄弟瓦片\n   */\n  siblings() {\n    return this.z === 0\n      ? []\n      : this.parent()\n          .children(this.overscaledZ)\n          .filter((t) => !this.isEqual(t));\n  }\n\n  /**\n   * 查找相临瓦片\n   * @param hor 横向偏移\n   * @param ver 纵向偏移\n   */\n  neighbor(hor: number, ver = 0) {\n    if (this.z === 0) {\n      return new TileID(this.overscaledZ, this.wrap + hor, this.z, this.x, this.y, this.options);\n    }\n    const max = Math.pow(2, this.z);\n\n    const w = this.x + hor;\n    const dw = Math.floor(w / max);\n    const wrap = this.wrap + dw;\n\n    return new TileID(\n      this.overscaledZ,\n      wrap,\n      this.z,\n      (this.x + hor - max * dw) % max,\n      (this.y + ver + max) % max,\n      this.options,\n    );\n  }\n\n  /**\n   * 判断瓦片是否相同\n   * 一般我们认为只要 xyz 和所处世界 wrap 相同就确认相同（即 tileKey 相同）\n   * @param tile\n   */\n  isEqual(tile: TileID) {\n    return tile.tileKey === this.tileKey;\n  }\n\n  /**\n   * 判断是否是根节点\n   * @returns {boolean}\n   */\n  isRoot(): boolean {\n    return this.z === 0;\n  }\n}\n", "import type { Program } from '@sakitam-gis/vis-engine';\nimport { Mesh, Geometry } from '@sakitam-gis/vis-engine';\n\nexport default class TileMesh {\n  public id: string;\n  public program: Program;\n\n  /**\n   * 用于地图投影下的 Mesh\n   */\n  public mesh: Mesh;\n\n  /**\n   * 用于平面绘制的 Mesh，常用于瓦片合并 Pass\n   */\n  public planeMesh: Mesh;\n\n  constructor(id, renderer, program, geometry) {\n    this.id = id;\n    this.program = program;\n\n    this.mesh = new Mesh(renderer, {\n      program,\n      geometry,\n    });\n\n    this.planeMesh = new Mesh(renderer, {\n      program,\n      geometry: new Geometry(renderer, {\n        position: {\n          size: 2,\n          data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n        },\n        uv: {\n          size: 2,\n          data: new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]),\n        },\n        index: {\n          size: 1,\n          data: new Uint16Array([0, 1, 2, 2, 1, 3]),\n        },\n      }),\n    });\n  }\n\n  setCenter(center: number[]) {\n    this.mesh.position.set(center[0], center[1], center[2] || 0);\n  }\n\n  getMesh() {\n    return this.mesh;\n  }\n\n  destroy() {\n    this.mesh.destroy();\n    this.planeMesh.destroy();\n  }\n}\n", "import type { Program, Renderer } from '@sakitam-gis/vis-engine';\nimport { Geometry, Texture } from '@sakitam-gis/vis-engine';\nimport TileMesh from './TileMesh';\nimport type { ParseOptionsType, ProjTileBounds, TileBounds } from '../type';\nimport { RenderFrom, TileState } from '../type';\nimport { isImageBitmap, parseRange } from '../utils/common';\nimport type TileID from './TileID';\n\nexport interface TileOptions {\n  tileBounds?: TileBounds;\n  tileSize: number;\n}\n\n/**\n * 这里是一个内部的瓦片实现，他主要是为了统各地图类库的瓦片相关操作\n * 我们常规需要的是在某个地图类库下某个瓦片的 xyz 以及其对应投影下\n * 的瓦片范围（常规情况使用世界坐标，部分类库可能直接使用像素位置并且在每一帧更新），\n * 并且在此我们需要维护瓦片的状态。\n */\nexport default class Tile {\n  /**\n   * 瓦片 是否取消请求\n   */\n  public aborted: boolean;\n\n  /**\n   * 瓦片重加载回调\n   */\n  public reloadCallback: any;\n\n  /**\n   * worker 执行器\n   */\n  public actor: any;\n\n  /**\n   * 瓦片 ID\n   */\n  public tileID: TileID;\n\n  /**\n   * 瓦片数据加载状态\n   */\n  public state: TileState;\n\n  /**\n   * 瓦片加载失败的次数\n   */\n  public errorCount = 0;\n\n  /**\n   * 允许的瓦片最大失败次数\n   */\n  public maxErrorCount = 3;\n\n  /**\n   * 瓦片的世界范围\n   */\n  public tileBounds: ProjTileBounds;\n\n  /**\n   * 瓦片尺寸\n   */\n  public tileSize: number;\n\n  /**\n   * 瓦片使用次数（在多个 render 共享 source 时，瓦片只能在为被任何渲染器使用时才能被销毁）\n   */\n  public uses = 0;\n\n  public tileMeshs: Map<string, TileMesh> = new Map();\n\n  public geometries: Map<string, Geometry> = new Map<string, Geometry>();\n\n  request: Map<string, any>;\n\n  #textures: Map<number, Texture> = new Map();\n\n  /**\n   * @param tileID\n   * @param options\n   */\n  constructor(tileID: TileID, options: TileOptions = {} as TileOptions) {\n    this.tileID = tileID;\n\n    this.tileSize = options.tileSize;\n\n    this.request = new Map();\n\n    this.state = TileState.loading;\n  }\n\n  /**\n   * 瓦片是否已经加载到数据\n   */\n  hasData() {\n    return this.state === TileState.loaded || this.state === TileState.reloading;\n  }\n\n  /**\n   * 瓦片是否已经请求过\n   */\n  wasRequested(): boolean {\n    return this.state === TileState.errored || this.state === TileState.loaded;\n  }\n\n  /**\n   * 瓦片是否加载完成\n   */\n  isLoaded() {\n    return this.state === TileState.loaded || this.state === TileState.reloading || this.state === TileState.errored;\n  }\n\n  getMesh(passId) {\n    return this.tileMeshs.get(passId);\n  }\n\n  get textures() {\n    return this.#textures;\n  }\n\n  get tileCenter() {\n    return [(this.tileBounds.left + this.tileBounds.right) / 2, (this.tileBounds.top + this.tileBounds.bottom) / 2, 0];\n  }\n\n  /**\n   * 更新瓦片顶点信息\n   * @param passId\n   * @param bbox\n   * @param renderer\n   * @param force\n   */\n  updateGeometry(passId: string, bbox: ProjTileBounds, renderer: Renderer, force?: boolean) {\n    this.tileBounds = bbox;\n    if (!this.geometries.get(passId) || force) {\n      const position = [\n        this.tileBounds.left,\n        this.tileBounds.top,\n        0,\n        this.tileBounds.right,\n        this.tileBounds.top,\n        0,\n        this.tileBounds.left,\n        this.tileBounds.bottom,\n        0,\n        this.tileBounds.right,\n        this.tileBounds.bottom,\n        0,\n      ];\n      let i = 0;\n      const len = position.length;\n      for (; i < len; i += 3) {\n        // eslint-disable-next-line operator-assignment\n        position[i] = position[i] - this.tileCenter[0];\n        position[i + 1] = position[i + 1] - this.tileCenter[1];\n        position[i + 2] = position[i + 2] - this.tileCenter[2];\n      }\n      this.geometries.set(\n        passId,\n        new Geometry(renderer, {\n          position: {\n            size: 3,\n            data: new Float32Array(position),\n          },\n          normal: {\n            size: 3,\n            data: new Float32Array([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]),\n          },\n          uv: {\n            size: 2,\n            data: new Float32Array([0, 1, 1, 1, 0, 0, 1, 0]),\n          },\n          index: {\n            data: new Uint16Array([0, 2, 1, 2, 3, 1]),\n          },\n        }),\n      );\n    }\n\n    return this.geometries.get(passId);\n  }\n\n  /**\n   * 创建 `TileMesh`\n   * @param passId 在多个 render pass 共享 tile 时我们可能需要针对多个 pass 创建渲染资源\n   * 在 mapbox 这种共享 gl 上下文的一般我们不需要重建，但是对于 maptalks 这种每个图层一个 gl\n   * 上下文的我们需要针对每个 gl上下文绑定资源\n   * @param bbox\n   * @param renderer\n   * @param program\n   * @param force\n   */\n  createMesh(passId: string, bbox: ProjTileBounds, renderer: Renderer, program: Program, force?: boolean) {\n    const geometry = this.updateGeometry(passId, bbox, renderer, force);\n    if (!this.tileMeshs.get(passId) || force) {\n      this.uses++;\n      const uid = passId + '_' + this.tileID.tileKey;\n      const tileMesh = new TileMesh(uid, renderer, program, geometry);\n      tileMesh.setCenter(this.tileCenter);\n      this.tileMeshs.set(passId, tileMesh);\n    }\n\n    return this.tileMeshs.get(passId);\n  }\n\n  /**\n   * 创建纹理\n   * @param renderer\n   * @param index\n   * @param image\n   * @param parseOptions\n   * @param userData\n   */\n  setTextures(renderer: Renderer, index: number, image: any, parseOptions: ParseOptionsType, userData?: any) {\n    const texture = this.#textures.get(index);\n    const iib = isImageBitmap(image) || image instanceof Image;\n\n    let dataRange;\n\n    if (userData?.dataRange) {\n      dataRange = userData?.dataRange;\n    } else if (image.withExif) {\n      dataRange = parseRange(image.exif as string);\n    }\n\n    if (texture) {\n      if (texture.userData) {\n        texture.userData.dataRange = dataRange;\n      }\n      texture.setData(iib ? image : image.data);\n    } else {\n      this.#textures.set(\n        index,\n        new Texture(renderer, {\n          userData: dataRange\n            ? {\n                dataRange,\n              }\n            : undefined,\n          image: iib ? image : image.data,\n          width: image.width,\n          height: image.height,\n          minFilter: renderer.gl.LINEAR,\n          magFilter: renderer.gl.LINEAR,\n          wrapS: renderer.gl.CLAMP_TO_EDGE,\n          wrapT: renderer.gl.CLAMP_TO_EDGE,\n          flipY: false, // 注意，对 ImageBitmap 无效\n          premultiplyAlpha: false, // 禁用 `Alpha` 预乘\n          type: parseOptions.renderFrom === RenderFrom.float ? renderer.gl.FLOAT : renderer.gl.UNSIGNED_BYTE,\n          format:\n            parseOptions.renderFrom === RenderFrom.float\n              ? renderer.isWebGL2\n                ? (renderer.gl as WebGL2RenderingContext).RED\n                : renderer.gl.LUMINANCE\n              : renderer.gl.RGBA,\n          internalFormat:\n            parseOptions.renderFrom === RenderFrom.float\n              ? renderer.isWebGL2\n                ? (renderer.gl as WebGL2RenderingContext).R32F\n                : renderer.gl.LUMINANCE\n              : renderer.gl.RGBA,\n        }),\n      );\n    }\n  }\n\n  /**\n   * 获取瓦片世界坐标系下的范围\n   */\n  getBounds() {\n    return this.tileBounds;\n  }\n\n  copy(tile: Tile) {\n    this.#textures = tile.textures;\n    this.actor = tile.actor;\n    this.state = tile.state !== TileState.errored ? TileState.loaded : TileState.errored;\n    this.request = tile.request;\n    this.reloadCallback = tile.reloadCallback;\n    return this;\n  }\n\n  /**\n   * 释放瓦片资源\n   */\n  destroy() {\n    for (const [, value] of this.#textures) {\n      if (value) {\n        value?.destroy();\n      }\n    }\n    this.#textures.clear();\n\n    for (const [, value] of this.geometries) {\n      if (value) {\n        value?.destroy();\n      }\n    }\n\n    for (const [, value] of this.tileMeshs) {\n      if (value) {\n        value?.destroy();\n      }\n    }\n    this.tileMeshs.clear();\n  }\n}\n", "/* eslint-disable no-param-reassign */\n\n// eslint-disable-next-line max-classes-per-file\ntype Key = string | number;\n\nclass DoubleQueueNode<T> {\n  key: Key;\n  val: any;\n  pre: DoubleQueueNode<T>;\n  next: DoubleQueueNode<T>;\n  constructor(key: Key, val: T) {\n    this.key = key;\n    this.val = val;\n  }\n}\n\nexport default class LRUCache<T> {\n  private max: number; // 限制大小\n  private map: Map<Key, DoubleQueueNode<T>>; // 数据和链表中节点的映射\n  private head: DoubleQueueNode<T>; // 头结点\n  private tail: DoubleQueueNode<T>; // 尾结点\n  private onRemove: (element: T) => void;\n\n  constructor(max, onRemove: (element: T) => void) {\n    this.max = max;\n    this.onRemove = onRemove;\n    this.reset();\n  }\n\n  /**\n   * 当前容量\n   */\n  get size() {\n    return this.map.size;\n  }\n\n  public reset() {\n    if (this.map) {\n      const iterator = this.map.entries();\n      for (let i = 0; i < this.map.size; i++) {\n        const [, value] = iterator.next().value;\n        this.onRemove(value.val);\n      }\n    }\n\n    this.map = new Map();\n    this.head = new DoubleQueueNode(0, 0);\n    this.tail = new DoubleQueueNode(0, 0);\n    this.head.next = this.tail;\n\n    return this;\n  }\n\n  public clear() {\n    this.reset();\n    this.onRemove = () => undefined;\n  }\n\n  public has(key: Key) {\n    const node: WithUndef<DoubleQueueNode<T>> = this.map.get(key);\n    return node !== undefined;\n  }\n\n  public get(key: Key) {\n    const node: WithUndef<DoubleQueueNode<T>> = this.map.get(key);\n    if (node === undefined) {\n      return null;\n    }\n\n    // 数据在链表中，则移至链表头部\n    this.moveToHead(node);\n\n    return node.val;\n  }\n\n  public getAndRemove(key: Key) {\n    if (!this.has(key)) {\n      return null;\n    }\n    return this.remove(key);\n  }\n\n  public add(key: Key, value: any) {\n    let oldValue;\n    const node: WithUndef<DoubleQueueNode<T>> = this.map.get(key);\n    if (node === undefined) {\n      // 淘汰数据\n      this.eliminate();\n      // 数据不在链表中，插入数据至头部\n      const newNode: DoubleQueueNode<T> = new DoubleQueueNode(key, value);\n      const temp: DoubleQueueNode<T> = this.head.next;\n      this.head.next = newNode;\n      newNode.next = temp;\n      newNode.pre = this.head;\n      temp.pre = newNode;\n      this.map.set(key, newNode);\n      oldValue = null;\n    } else {\n      // 数据在链表中，则移至链表头部\n      this.moveToHead(node);\n      oldValue = node.val;\n      node.val = value;\n    }\n    return oldValue;\n  }\n\n  public remove(key: Key) {\n    const deletedNode: WithUndef<DoubleQueueNode<T>> = this.map.get(key);\n    if (deletedNode === undefined) {\n      return null;\n    }\n    deletedNode.pre.next = deletedNode.next;\n    deletedNode.next.pre = deletedNode.pre;\n    this.onRemove(deletedNode.val);\n    this.map.delete(key);\n    return deletedNode.val;\n  }\n\n  /**\n   * 设置最大缓存大小\n   * @param max\n   */\n  public setMaxSize(max: number) {\n    this.max = max;\n\n    // 当前缓存的数量大于重新设置的最大缓存值时进行缓存淘汰\n    while (this.size > this.max) {\n      this.eliminate();\n    }\n  }\n\n  // 将节点插入至头部节点\n  private moveToHead(node: DoubleQueueNode<T>) {\n    node.pre.next = node.next;\n    node.next.pre = node.pre;\n    const temp: DoubleQueueNode<T> = this.head.next;\n    this.head.next = node;\n    node.next = temp;\n    node.pre = this.head;\n    temp.pre = node;\n  }\n\n  /**\n   * 如果超出缓存限制，那么移除未使用的数据\n   * @private\n   */\n  private eliminate() {\n    if (this.size < this.max) {\n      return;\n    }\n\n    // 将链表中最后一个节点去除\n    const last: DoubleQueueNode<T> = this.tail.pre;\n    this.onRemove(last.val);\n    this.map.delete(last.key);\n    last.pre.next = this.tail;\n    this.tail.pre = last.pre;\n  }\n}\n", "import { EventEmitter } from '@sakitam-gis/vis-engine';\nimport LRUCache from '../utils/LRUCache';\nimport type TileSource from './tile';\nimport type ImageSource from './image';\nimport Tile from '../tile/Tile';\nimport { keysDifference } from '../utils/common';\nimport { TileState } from '../type';\nimport type TileID from '../tile/TileID';\n\nfunction compareTileId(a: TileID, b: TileID) {\n  const aWrap = Math.abs(a.wrap * 2) - +(a.wrap < 0);\n  const bWrap = Math.abs(b.wrap * 2) - +(b.wrap < 0);\n  return a.overscaledZ - b.overscaledZ || bWrap - aWrap || b.y - a.y || b.x - a.x;\n}\n\nexport default class SourceCache extends EventEmitter {\n  public id: string;\n  public source: TileSource | ImageSource;\n  private readonly cacheTiles: {\n    [key: string]: Tile;\n  };\n  private coveredTiles: {\n    [key: string]: WithUndef<boolean>;\n  };\n  private loadedParentTiles: {\n    [key: string]: Tile;\n  };\n\n  #cache: LRUCache<Tile>;\n\n  /**\n   * 这两个配置是用于控制瓦片数据的最大缩放级别的。\n   * 在瓦片地图中，为了避免图像模糊或者失真，通常不会将某个瓦片数据过度缩放，\n   * 而是使用它的父级瓦片或者子集瓦片数据进行显示。\n   * 这个缩放的范围就是通过 maxOverzooming 和 maxUnderzooming 属性来控制的\n   */\n  static maxOverzooming = 10;\n  static maxUnderzooming = 3;\n\n  constructor(id, source) {\n    super();\n    this.id = id;\n    this.source = source;\n    this.cacheTiles = {};\n    this.coveredTiles = {};\n    this.loadedParentTiles = {};\n    this.#cache = new LRUCache(0, this.unloadTile.bind(this));\n  }\n\n  /**\n   * 判断当前 source 瓦片是否全部加载完毕（成功加载或者加载错误）\n   */\n  loaded() {\n    if (!this.source.loaded()) {\n      return false;\n    }\n    for (const t in this.cacheTiles) {\n      const tile = this.cacheTiles[t];\n      if (tile.state !== TileState.loaded && tile.state !== TileState.errored) return false;\n    }\n    return true;\n  }\n\n  /**\n   * 调用 `Source` 的瓦片加载方法\n   * 具体由各个`Source` 实现\n   * @param tile\n   * @param callback\n   */\n  loadTile(tile, callback) {\n    return this.source.loadTile(tile, callback);\n  }\n\n  /**\n   * 移除已加载的瓦片\n   * @param tile\n   */\n  unloadTile(tile) {\n    if (this.source.unloadTile) {\n      return this.source.unloadTile(tile, () => undefined);\n    }\n  }\n\n  /**\n   * 取消正在加载中的瓦片\n   * @param tile\n   */\n  abortTile(tile) {\n    if (this.source.abortTile) {\n      return this.source.abortTile(tile, () => undefined);\n    }\n  }\n\n  /**\n   * 获取所有的可渲染的瓦片 id 并且排序（从 0 世界向两边排序）\n   */\n  getRenderableIds() {\n    const renderables: any[] = [];\n    for (const id in this.cacheTiles) {\n      if (this._isIdRenderable(id)) renderables.push(this.cacheTiles[id]);\n    }\n    return renderables\n      .map((tile) => tile.tileID)\n      .sort(compareTileId)\n      .map((tile) => tile.tileKey);\n  }\n\n  _isIdRenderable(id) {\n    return this.cacheTiles[id] && this.cacheTiles[id].hasData() && !this.coveredTiles[id];\n  }\n\n  /**\n   * 获取已经加载的瓦片\n   */\n  getVisibleCoordinates() {\n    return this.getRenderableIds().map((id) => this.cacheTiles[id].tileID);\n  }\n\n  /**\n   * 瓦片加载完成回调\n   * @param tile\n   * @param id\n   * @param previousState\n   * @param err\n   * @param disableUpdate\n   */\n  tileLoaded(tile, id, previousState, err, disableUpdate = false) {\n    if (err) {\n      tile.state = TileState.errored;\n      if (err.status !== 404) {\n        // this._source.fire(new ErrorEvent(err, {tile}));\n      } else {\n        // 如果瓦片不存在，则继续尝试加载父/子瓦片\n        this.emit('update');\n      }\n      return;\n    }\n\n    tile.timeAdded = Date.now();\n    if (!disableUpdate) {\n      this.emit('update');\n    }\n    this.emit('tileLoaded');\n    if (this.loaded()) {\n      this.emit('tilesLoadEnd');\n    }\n  }\n\n  _addTile(tileID): WithNull<Tile> {\n    let tile = this.cacheTiles[tileID.tileKey];\n    if (tile) return tile;\n\n    // 目前问题在于，跨世界的瓦片在执行过一次缓存获取后会被移除，后续瓦片无法再从缓存中\n    // 取到，这就造成了需要重复请求的问题\n    tile = this.#cache.getAndRemove(tileID.tileKey);\n    if (tile) {\n      tile.tileID = tileID;\n    }\n\n    const cached = Boolean(tile);\n    if (!cached) {\n      tile = new Tile(tileID, {\n        tileSize: this.source.tileSize * tileID.overscaleFactor(),\n      });\n      this.loadTile(tile, this.tileLoaded.bind(this, tile, tileID.tileKey, tile.state));\n    }\n\n    // Impossible, but silence flow.\n    if (!tile) return null;\n\n    tile.uses++;\n    this.cacheTiles[tileID.tileKey] = tile;\n\n    return tile;\n  }\n\n  /**\n   * 根据 `tileKey` 移除瓦片\n   * @param id\n   */\n  _removeTile(id) {\n    const tile = this.cacheTiles[id];\n    if (!tile) return;\n\n    tile.uses--;\n    delete this.cacheTiles[id];\n\n    if (tile.uses > 0) return;\n\n    if (tile.hasData() && tile.state !== TileState.reloading) {\n      this.#cache.add(tile.tileID.tileKey, tile);\n    } else {\n      tile.aborted = true;\n      this.abortTile(tile);\n      this.unloadTile(tile);\n    }\n  }\n\n  /**\n   * 根据 `TileID` 获取瓦片\n   * @param tileID\n   */\n  getTile(tileID) {\n    return this.cacheTiles[tileID?.tileKey];\n  }\n\n  /**\n   * 该策略会在内存中保留当前层级的瓦片的所有子瓦片（children），直到一直保留到最大覆盖缩放级别（maxCoveringZoom）为止。\n   * 简单来说，当当前地图缩放等级超过了当前图层的最大缩放级别时，Mapbox GL JS 会自动加载当前瓦片的所有子瓦片来填充当前视图的空白部分。而 retain any loaded children of ideal tiles up to maxCoveringZoom 这个选项会保留这些子瓦片的缓存，以便在缩放到更高层级时直接使用，而不需要重新加载。\n   * 举个例子，假设当前地图缩放等级是 10，最大缩放级别是 14，而 maxCoveringZoom 设置为 12。地图将会加载当前缩放级别为 10 的瓦片，并将其所有子瓦片缓存到内存中，包括缩放级别为 11、12、13 的所有瓦片。但是，因为 maxCoveringZoom 设置为 12，所以缩放到 13 级时，只会使用缓存中缩放级别为 11、12 的子瓦片。当缩放到 14 级时，则不再使用缓存，而是重新加载新的瓦片数据。\n   * 需要注意的是，这个选项可能会占用大量内存，因此在使用时需要根据实际情况进行设置。如果需要优化内存使用，可以将 maxCoveringZoom 设置为一个较小的值，以减少缓存的瓦片数量。\n   * @param idealTiles\n   * @param zoom\n   * @param maxCoveringZoom\n   * @param retain\n   */\n  retainLoadedChildren(idealTiles, zoom, maxCoveringZoom, retain) {\n    for (const id in this.cacheTiles) {\n      let tile = this.cacheTiles[id];\n\n      // only consider renderable tiles up to maxCoveringZoom\n      if (retain[id] || !tile.hasData() || tile.tileID.overscaledZ <= zoom || tile.tileID.overscaledZ > maxCoveringZoom)\n        continue;\n\n      // loop through parents and retain the topmost loaded one if found\n      let topmostLoadedID = tile.tileID;\n      while (tile && tile.tileID.overscaledZ > zoom + 1) {\n        const parentID = tile.tileID.scaledTo(tile.tileID.overscaledZ - 1);\n\n        tile = this.cacheTiles[parentID.tileKey];\n\n        if (tile && tile.hasData()) {\n          topmostLoadedID = parentID;\n        }\n      }\n\n      // loop through ancestors of the topmost loaded child to see if there's one that needed it\n      let tileID = topmostLoadedID;\n      while (tileID.overscaledZ > zoom) {\n        tileID = tileID.scaledTo(tileID.overscaledZ - 1);\n\n        if (idealTiles[tileID.tileKey]) {\n          // found a parent that needed a loaded child; retain that child\n          retain[topmostLoadedID.tileKey] = topmostLoadedID;\n          break;\n        }\n      }\n    }\n  }\n\n  updateLoadedParentTileCache() {\n    this.loadedParentTiles = {};\n\n    for (const tileKey in this.cacheTiles) {\n      const path: any[] = [];\n      let parentTile;\n      let currentId = this.cacheTiles[tileKey].tileID;\n\n      // Find the closest loaded ancestor by traversing the tile tree towards the root and\n      // caching results along the way\n      while (currentId.overscaledZ > 0) {\n        // Do we have a cached result from previous traversals?\n        if (currentId.tileKey in this.loadedParentTiles) {\n          parentTile = this.loadedParentTiles[currentId.tileKey];\n          break;\n        }\n\n        path.push(currentId.tileKey);\n\n        // Is the parent loaded?\n        const parentId = currentId.scaledTo(currentId.overscaledZ - 1);\n        parentTile = this.getLoadedTile(parentId);\n        if (parentTile) {\n          break;\n        }\n\n        currentId = parentId;\n      }\n\n      // Cache the result of this traversal to all newly visited tiles\n      for (const key of path) {\n        this.loadedParentTiles[key] = parentTile;\n      }\n    }\n  }\n\n  updateRetainedTiles(wrapTiles) {\n    const retain = {};\n    if (wrapTiles.length === 0) {\n      return retain;\n    }\n\n    const checked = {};\n    const minZoom = wrapTiles.reduce((min, id) => Math.min(min, id.overscaledZ), Infinity);\n    const maxZoom = wrapTiles[0].overscaledZ;\n    console.assert(minZoom <= maxZoom);\n    const minCoveringZoom = Math.max(maxZoom - SourceCache.maxOverzooming, this.source.minZoom);\n    const maxCoveringZoom = Math.max(maxZoom + SourceCache.maxUnderzooming, this.source.minZoom);\n\n    const missingTiles = {};\n    for (const tileID of wrapTiles) {\n      const tile = this._addTile(tileID);\n\n      // retain the tile even if it's not loaded because it's an ideal tile.\n      // 即使没有加载也保留瓦片因为这是一个合适的瓦片\n      retain[tileID.tileKey] = tileID;\n\n      // 如果已经有数据，跳过，可能从缓存中取\n      if (tile?.hasData()) continue;\n\n      if (minZoom < this.source.maxZoom) {\n        // save missing tiles that potentially have loaded children\n        // 保存已经加载子瓦片的不需要的瓦片\n        missingTiles[tileID.tileKey] = tileID;\n      }\n    }\n\n    // 保留任何已经加载的子瓦片，直到超过 `maxCoveringZoom`\n    this.retainLoadedChildren(missingTiles, minZoom, maxCoveringZoom, retain);\n\n    for (const tileID of wrapTiles) {\n      let tile: WithNull<Tile> = this.cacheTiles[tileID.tileKey];\n\n      if (tile.hasData()) continue;\n\n      // 需要的瓦片未加载完成或者不存在，查找其子集瓦片\n      if (tileID.z >= this.source.maxZoom) {\n        // 查找过度缩放的子集瓦片\n        const childTileLike = tileID.children(this.source.maxZoom)[0];\n        const childTile = this.getTile(childTileLike);\n        if (!!childTile && childTile.hasData()) {\n          retain[childTileLike.tileKey] = childTileLike;\n          continue; // 子集瓦片已经可以完全覆盖\n        }\n      } else {\n        // 检查当前瓦片子瓦片是否加载完成，如果已经加载则可以替代当前瓦片\n        const children = tileID.children(this.source.maxZoom);\n\n        if (\n          retain[children[0].tileKey] &&\n          retain[children[1].tileKey] &&\n          retain[children[2].tileKey] &&\n          retain[children[3].tileKey]\n        )\n          continue; // tile is covered by children\n      }\n\n      // 当找不到合适的子集瓦片，并且本身也无法找到，那么查找其父集瓦片\n\n      // As we ascend up the tile pyramid of the ideal tile, we check whether the parent\n      // tile has been previously requested (and errored because we only loop over tiles with no data)\n      // in order to determine if we need to request its parent.\n      let parentWasRequested = tile.wasRequested();\n\n      for (let overscaledZ = tileID.overscaledZ - 1; overscaledZ >= minCoveringZoom; --overscaledZ) {\n        const parentId = tileID.scaledTo(overscaledZ);\n\n        // Break parent tile ascent if this route has been previously checked by another child.\n        if (checked[parentId.tileKey]) break;\n        checked[parentId.tileKey] = true;\n\n        tile = this.getTile(parentId);\n        if (!tile && parentWasRequested) {\n          tile = this._addTile(parentId);\n        }\n        if (tile) {\n          retain[parentId.tileKey] = parentId;\n          // Save the current values, since they're the parent of the next iteration\n          // of the parent tile ascent loop.\n          parentWasRequested = tile.wasRequested();\n          if (tile.hasData()) break;\n        }\n      }\n    }\n\n    return retain;\n  }\n\n  /**\n   * 获取已经加载的缓存瓦片\n   * @param tileID\n   * @return {*}\n   */\n  getLoadedTile(tileID) {\n    const tile = this.cacheTiles[tileID.tileKey];\n    if (tile && tile.hasData()) {\n      return tile;\n    }\n    return this.#cache.get(tileID.tileKey);\n  }\n\n  /**\n   * 查找已经加载的父级瓦片\n   * @param tileID\n   * @param minCoveringZoom\n   */\n  findLoadedParent(tileID, minCoveringZoom) {\n    if (tileID.tileKey in this.loadedParentTiles) {\n      const parent = this.loadedParentTiles[tileID.tileKey];\n      if (parent && parent.tileID.overscaledZ >= minCoveringZoom) {\n        return parent;\n      } else {\n        return null;\n      }\n    }\n    for (let z = tileID.overscaledZ - 1; z >= minCoveringZoom; z--) {\n      const parentTileID = tileID.scaledTo(z);\n      const tile = this.getLoadedTile(parentTileID);\n      if (tile) {\n        return tile;\n      }\n    }\n  }\n\n  /**\n   * 更新当前的缓存大小\n   */\n  updateCacheSize() {\n    const tileSize = this.source.tileSize;\n    const { width, height } = this.source.renderer.size;\n    const widthInTiles = Math.ceil((width || 4 * tileSize) / tileSize) + 1;\n    const heightInTiles = Math.ceil((height || 4 * tileSize) / tileSize) + 1;\n    const approxTilesInView = widthInTiles * heightInTiles;\n    const commonZoomRange = 5;\n\n    const viewDependentMaxSize = Math.floor(approxTilesInView * commonZoomRange);\n    const maxSize =\n      typeof this.source.options.maxTileCacheSize === 'number'\n        ? Math.max(this.source.options.maxTileCacheSize, viewDependentMaxSize)\n        : viewDependentMaxSize;\n\n    this.#cache.setMaxSize(maxSize);\n  }\n\n  update(wrapTiles) {\n    this.coveredTiles = {};\n    let tiles = wrapTiles;\n    this.updateCacheSize();\n\n    if (this.source.hasTile) {\n      tiles = wrapTiles.filter((coord) => this.source.hasTile(coord));\n    }\n\n    const retain = this.updateRetainedTiles(tiles);\n\n    if (tiles.length !== 0) {\n      const parentsForFading = {};\n      const fadingTiles = {};\n      const ids = Object.keys(retain);\n      for (const id of ids) {\n        const tileID = retain[id];\n\n        const tile = this.cacheTiles[id];\n        if (!tile) continue;\n\n        // if the tile is loaded but still fading in, find parents to cross-fade with it\n        const parentTile = this.findLoadedParent(\n          tileID,\n          Math.max(tileID.overscaledZ - SourceCache.maxOverzooming, this.source.minZoom),\n        );\n        if (parentTile) {\n          this._addTile(parentTile.tileID);\n          parentsForFading[parentTile.tileID.tileKey] = parentTile.tileID;\n        }\n\n        fadingTiles[id] = tileID;\n      }\n\n      for (const id in parentsForFading) {\n        if (!retain[id]) {\n          // If a tile is only needed for fading, mark it as covered so that it isn't rendered on it's own.\n          this.coveredTiles[id] = true;\n          retain[id] = parentsForFading[id];\n        }\n      }\n    }\n\n    this.emit('tilesLoadStart', {\n      retain,\n    });\n\n    const remove = keysDifference(this.cacheTiles, retain);\n    for (const tileKey of remove) {\n      this._removeTile(tileKey);\n    }\n\n    this.updateLoadedParentTileCache();\n    const currentLength = Object.keys(this.cacheTiles).filter((k) => this.cacheTiles[k]?.wasRequested()).length;\n    const retainLength = Object.keys(retain).length;\n    if (currentLength < retainLength) {\n      this.emit('tilesLoading', {\n        progress: currentLength / retainLength,\n      });\n    }\n  }\n\n  /**\n   * 重载当前视野内的瓦片（需要移除缓存）\n   */\n  reload() {\n    this.#cache.reset();\n\n    for (const key in this.cacheTiles) {\n      this._reloadTile(key, TileState.reloading);\n    }\n  }\n\n  _reloadTile(id: string, state: TileState) {\n    const tile = this.cacheTiles[id];\n\n    if (!tile) return;\n\n    // The difference between \"loading\" tiles and \"reloading\" or \"expired\"\n    // tiles is that \"reloading\"/\"expired\" tiles are \"renderable\".\n    // Therefore, a \"loading\" tile cannot become a \"reloading\" tile without\n    // first becoming a \"loaded\" tile.\n    if (tile.state !== TileState.loading) {\n      tile.state = state;\n    }\n\n    this.loadTile(tile, this.tileLoaded.bind(this, tile, id, state));\n  }\n\n  clearTiles() {\n    for (const id in this.cacheTiles) {\n      this._removeTile(id);\n    }\n\n    this.#cache.reset();\n  }\n\n  /**\n   * 查找覆盖 queryGeometry 的瓦片\n   * @param {QueryGeometry} queryGeometry\n   * @param {boolean} [visualizeQueryGeometry=false]\n   * @param {boolean} use3DQuery\n   * @returns\n   * @private\n   */\n  tilesIn(queryGeometry: any): any[] {\n    const tileResults: any[] = [];\n\n    for (const tileID in this.cacheTiles) {\n      const tile = this.cacheTiles[tileID];\n\n      const tilesToCheck = [0];\n\n      for (const wrap of tilesToCheck) {\n        const tileResult = queryGeometry.containsTile(this.source, tile, wrap);\n        if (tileResult) {\n          tileResults.push(tileResult);\n        }\n      }\n    }\n    return tileResults;\n  }\n\n  destroy() {\n    for (const id in this.cacheTiles) {\n      this._removeTile(id);\n    }\n\n    this.#cache.reset();\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { utils, EventEmitter } from '@sakitam-gis/vis-engine';\nimport SourceCache from './cahce';\nimport type { ParseOptionsType, TileSourceOptions } from '../type';\nimport { DecodeType, LayerSourceType, TileState } from '../type';\nimport { containTile, resolveURL } from '../utils/common';\nimport type TileID from '../tile/TileID';\nimport type Tile from '../tile/Tile';\nimport type Layer from '../renderer';\n\nconst URL_PATTERN = /\\{ *([\\w_]+) *\\}/g;\n\nfunction formatUrl(url: string, data: any) {\n  return url.replace(URL_PATTERN, (str, key) => {\n    let value = data[key];\n\n    if (value === undefined) {\n      throw new Error(`No value provided for variable ${str}`);\n    } else if (typeof value === 'function') {\n      value = value(data);\n    }\n    return value;\n  });\n}\n\nexport interface TileSourceInterval {\n  url: TileSourceOptions['url'];\n}\n\nexport default class TileSource extends EventEmitter {\n  /**\n   * 数据源 id\n   */\n  public id: string;\n\n  /**\n   * 数据源类型\n   */\n  public type: LayerSourceType.tile;\n\n  /**\n   * 支持的最小层级\n   */\n  public minZoom: number;\n\n  /**\n   * 支持的最大层级\n   */\n  public maxZoom: number;\n\n  /**\n   * 生成瓦片时的配置\n   */\n  public roundZoom = false;\n\n  /**\n   * 瓦片规范\n   */\n  public scheme: 'xyz' | 'tms';\n\n  public url: string | string[];\n\n  /**\n   * 瓦片大小\n   */\n  public tileSize: number;\n\n  public tileBounds: TileSourceOptions['tileBounds'];\n\n  /**\n   * 配置项\n   */\n  public options: TileSourceOptions;\n\n  public renderer: Renderer;\n\n  public dispatcher: any;\n\n  public layer: WithNull<Layer>;\n\n  /**\n   * 是否跨世界渲染\n   */\n  public wrapX: boolean;\n\n  public parseOptions: ParseOptionsType;\n\n  #loaded = false;\n  #sourceCache: SourceCache;\n  #tileWorkers: Map<string, any> = new Map();\n\n  constructor(id, options: TileSourceOptions) {\n    super();\n    this.id = id;\n\n    this.type = LayerSourceType.tile;\n    this.minZoom = options.minZoom ?? 0;\n    this.maxZoom = options.maxZoom ?? 22;\n    this.roundZoom = Boolean(options.roundZoom);\n    this.scheme = options.scheme || 'xyz';\n    this.tileSize = options.tileSize || 512;\n    this.tileBounds = options.tileBounds;\n    this.wrapX = Boolean(options.wrapX);\n\n    const decodeType = options.decodeType || DecodeType.image;\n    const maxTileCacheSize = options.maxTileCacheSize;\n\n    this.options = {\n      ...options,\n      decodeType,\n      maxTileCacheSize,\n      type: this.type,\n    };\n\n    this.#sourceCache = new SourceCache(this.id, this);\n  }\n\n  get sourceCache() {\n    return this.#sourceCache;\n  }\n\n  onAdd(layer, cb?: any) {\n    this.layer = layer;\n    this.load(cb);\n  }\n\n  update(data: TileSourceInterval, clear = true): this {\n    this.options.url = data.url;\n    this.reload(clear);\n\n    return this;\n  }\n\n  prepare(renderer: Renderer, dispatcher, parseOptions) {\n    this.renderer = renderer;\n    this.dispatcher = dispatcher;\n    this.parseOptions = parseOptions;\n  }\n\n  /**\n   * 兼容 TileJSON 加载，需要具体实现\n   * @param cb\n   */\n  load(cb?: any) {\n    this.#loaded = true;\n    this.url = this.options.url;\n    if (cb) {\n      cb(null);\n    }\n  }\n\n  loaded() {\n    return this.#loaded;\n  }\n\n  reload(clear: boolean) {\n    this.#loaded = false;\n    this.load(() => {\n      if (clear) {\n        this.#sourceCache.clearTiles();\n      } else {\n        this.#sourceCache.reload();\n      }\n      this.layer?.update();\n    });\n  }\n\n  hasTile(coord: TileID) {\n    return !this.tileBounds || containTile(this.tileBounds, coord.getTileBounds());\n  }\n\n  getFadeTime() {\n    return 0;\n  }\n\n  getUrl(x: number, y: number, z: number) {\n    const { subdomains } = this.options;\n    let domain: string | number = '';\n    if (subdomains && Array.isArray(subdomains) && subdomains.length > 0) {\n      const { length } = subdomains;\n      let s = (x + y) % length;\n      if (s < 0) {\n        s = 0;\n      }\n      domain = subdomains[s];\n    }\n\n    const data = {\n      x,\n      y,\n      z,\n      s: domain,\n    };\n\n    if (Array.isArray(this.url)) {\n      if (this.url.length > 2) {\n        console.warn(\n          `[TileSource]: Only supports up to two urls, Now there are more than two urls-${this.url.toString()}, and only the first two are selected by default`,\n        );\n      }\n      return this.url.filter((item, index) => index < 2).map((u) => formatUrl(u, data));\n    }\n\n    return formatUrl(this.url, data);\n  }\n\n  asyncActor(tile: Tile, url: string) {\n    return new Promise((resolve, reject) => {\n      const id = `${tile.tileID.tileKey}-${url}`;\n      tile.actor.send(\n        'loadData',\n        {\n          url: resolveURL(url),\n          cancelId: id,\n          type: 'arrayBuffer',\n          decodeType: this.options.decodeType,\n        },\n        (e, data) => {\n          if (e) {\n            return reject(e);\n          }\n          resolve(data);\n        },\n      );\n      tile.request.set(id, url);\n    });\n  }\n\n  getTileUrl(tileID: TileID) {\n    const z = tileID.z;\n    const x = tileID.x;\n    const y = this.scheme === 'tms' ? Math.pow(2, tileID.z) - tileID.y - 1 : tileID.y;\n\n    const url = this.getUrl(x, y, z);\n\n    let urls: string[] = url as string[];\n    if (utils.isString(url)) {\n      urls = [url];\n    }\n\n    return urls;\n  }\n\n  loadTile(tile: Tile, callback) {\n    try {\n      if (!tile.actor || tile.state === TileState.reloading) {\n        const urls = this.getTileUrl(tile.tileID);\n\n        const key = urls.join(',');\n        this.#tileWorkers.set(key, this.#tileWorkers.get(key) || this.dispatcher.getActor());\n        tile.actor = this.#tileWorkers.get(key);\n\n        const p: Promise<any>[] = [];\n        for (let i = 0; i < urls.length; i++) {\n          p.push(this.asyncActor(tile, urls[i]));\n        }\n\n        Promise.all(p)\n          .then((data) => {\n            tile.request.clear();\n\n            if (tile.aborted) {\n              tile.state = TileState.unloaded;\n              return callback(null);\n            }\n\n            if (!data) return callback(null);\n\n            data.forEach((d, index) => {\n              tile.setTextures(this.renderer, index, d, this.parseOptions, this.options);\n            });\n\n            tile.state = TileState.loaded;\n            callback(null);\n          })\n          .catch((e) => {\n            tile.state = TileState.errored;\n            console.log(e);\n          });\n      } else if (tile.state === TileState.loading) {\n        // schedule tile reloading after it has been loaded\n        tile.reloadCallback = callback;\n      }\n    } catch (e) {\n      tile.state = TileState.errored;\n      return callback(e);\n    }\n  }\n\n  abortTile(tile: Tile, callback) {\n    if (tile.request) {\n      if (tile.request.size > 0 && tile.actor) {\n        const iterator = tile.request.entries();\n        for (let i = 0; i < tile.request.size; i++) {\n          const [id, url] = iterator.next().value;\n          if (id) {\n            tile.actor.send(\n              'cancel',\n              {\n                url,\n                cancelId: id,\n              },\n              (err) => {\n                if (err) {\n                  tile.state = TileState.unloaded;\n                }\n              },\n            );\n          }\n        }\n      }\n      tile.request.clear();\n    } else {\n      tile.state = TileState.unloaded;\n    }\n    callback();\n  }\n\n  unloadTile(tile: Tile, callback) { // eslint-disable-line\n    if (tile.actor) {\n      // tile.actor.send('removeTile', {uid: tile.uid, type: this.type, source: this.id});\n    }\n  }\n\n  destroy() {\n    this.layer = null;\n    this.#loaded = false;\n    this.#tileWorkers.clear();\n    this.#sourceCache.clear();\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { EventEmitter, utils } from '@sakitam-gis/vis-engine';\nimport SourceCache from './cahce';\nimport type { ImageSourceOptions, ParseOptionsType } from '../type';\nimport { DecodeType, LayerSourceType, TileState } from '../type';\nimport { resolveURL } from '../utils/common';\nimport type Tile from '../tile/Tile';\nimport type Layer from '../renderer';\n\nexport interface ImageSourceInterval {\n  url: ImageSourceOptions['url'];\n}\n\nexport default class ImageSource extends EventEmitter {\n  /**\n   * 数据源 id\n   */\n  public id: string;\n\n  /**\n   * 数据源类型\n   */\n  public type: LayerSourceType.image;\n\n  /**\n   * 支持的最小层级\n   */\n  public minZoom: number;\n\n  /**\n   * 支持的最大层级\n   */\n  public maxZoom: number;\n\n  /**\n   * 是否对层级进行四舍五入\n   */\n  public roundZoom = false;\n\n  /**\n   * 瓦片大小\n   */\n  public tileSize: number;\n\n  /**\n   * 配置项\n   */\n  public options: ImageSourceOptions;\n\n  public url: ImageSourceOptions['url'];\n\n  public renderer: Renderer;\n\n  public dispatcher: any;\n\n  public layer: WithNull<Layer>;\n\n  public parseOptions: ParseOptionsType;\n\n  /**\n   * 影像坐标\n   */\n  public coordinates: ImageSourceOptions['coordinates'];\n\n  /**\n   * 是否跨世界渲染\n   */\n  public wrapX: boolean;\n\n  #loaded = false;\n  #sourceCache: SourceCache;\n  #tileWorkers: Map<string, any> = new Map();\n\n  constructor(id, options: ImageSourceOptions) {\n    super();\n    this.id = id;\n\n    this.type = LayerSourceType.image;\n    this.minZoom = 0;\n    this.maxZoom = 22;\n    this.roundZoom = false;\n    this.tileSize = 512;\n    this.coordinates = options.coordinates;\n    this.wrapX = Boolean(options.wrapX);\n    this.url = options.url;\n\n    const decodeType = options.decodeType || DecodeType.image;\n\n    this.options = {\n      ...options,\n      decodeType,\n      type: this.type,\n    };\n\n    this.#sourceCache = new SourceCache(this.id, this);\n  }\n\n  get sourceCache() {\n    return this.#sourceCache;\n  }\n\n  onAdd(layer, cb?: any) {\n    this.layer = layer;\n    this.load(cb);\n  }\n\n  prepare(renderer: Renderer, dispatcher, parseOptions: ParseOptionsType) {\n    this.renderer = renderer;\n    this.dispatcher = dispatcher;\n    this.parseOptions = parseOptions;\n  }\n\n  update(data: ImageSourceInterval, clear = true) {\n    this.options.url = data.url;\n    this.reload(clear);\n  }\n\n  updateImage(options: Pick<ImageSourceOptions, 'url' | 'coordinates'>, clear = true) {\n    this.options = {\n      ...this.options,\n      ...options,\n    };\n    this.reload(clear);\n  }\n\n  setCoordinates(coordinates: ImageSourceOptions['coordinates']) {\n    this.coordinates = coordinates;\n    this.reload(false);\n  }\n\n  asyncActor(tile, url) {\n    return new Promise((resolve, reject) => {\n      const id = `${tile.tileID.tileKey}-${url}`;\n      tile.actor.send(\n        'loadData',\n        {\n          url: resolveURL(url),\n          cancelId: id,\n          type: 'arrayBuffer',\n          decodeType: this.options.decodeType,\n        },\n        (e, data) => {\n          if (e) {\n            return reject(e);\n          }\n          resolve(data);\n        },\n      );\n      tile.request.set(id, url);\n    });\n  }\n\n  /**\n   * 兼容 TileJSON 加载，需要具体实现\n   * @param cb\n   */\n  load(cb?: any) {\n    this.#loaded = true;\n    this.url = this.options.url;\n    if (cb) {\n      cb(null);\n    }\n  }\n\n  loaded() {\n    return this.#loaded;\n  }\n\n  reload(clear) {\n    this.#loaded = false;\n    this.load(() => {\n      if (clear) {\n        this.#sourceCache.clearTiles();\n      } else {\n        this.#sourceCache.reload();\n      }\n      this.layer?.update();\n    });\n  }\n\n  getTileUrl(tileID) { // eslint-disable-line\n    let urls: string[] = this.url as string[];\n    if (utils.isString(this.url)) {\n      urls = [this.url];\n    }\n    return urls;\n  }\n\n  loadTile(tile: Tile, callback) {\n    try {\n      if (!tile.actor || tile.state === TileState.reloading) {\n        const urls = this.getTileUrl(tile.tileID);\n\n        const key = urls.join(',');\n        this.#tileWorkers.set(key, this.#tileWorkers.get(key) || this.dispatcher.getActor());\n        tile.actor = this.#tileWorkers.get(key);\n\n        const p: Promise<any>[] = [];\n        for (let i = 0; i < urls.length; i++) {\n          p.push(this.asyncActor(tile, urls[i]));\n        }\n\n        Promise.all(p)\n          .then((data) => {\n            tile.request.clear();\n\n            if (tile.aborted) {\n              tile.state = TileState.unloaded;\n              return callback(null);\n            }\n\n            if (!data) return callback(null);\n\n            data.forEach((d, index) => {\n              tile.setTextures(this.renderer, index, d, this.parseOptions, this.options);\n            });\n\n            tile.state = TileState.loaded;\n            callback(null);\n          })\n          .catch((e) => {\n            tile.state = TileState.errored;\n            console.log(e);\n          });\n      } else if (tile.state === TileState.loading) {\n        // schedule tile reloading after it has been loaded\n        tile.reloadCallback = callback;\n      } else {\n        // tile.request = tile.actor.send('reloadTile', params, done.bind(this));\n      }\n    } catch (e) {\n      tile.state = TileState.errored;\n      return callback(e);\n    }\n  }\n\n  hasTile(coord) { // eslint-disable-line\n    return true;\n  }\n\n  getFadeTime() {\n    return 0;\n  }\n\n  abortTile(tile: Tile, callback) {\n    if (tile.request) {\n      if (tile.request.size > 0 && tile.actor) {\n        const iterator = tile.request.entries();\n        for (let i = 0; i < tile.request.size; i++) {\n          const [id, url] = iterator.next().value;\n          if (id) {\n            tile.actor.send(\n              'cancel',\n              {\n                url,\n                cancelId: id,\n              },\n              (err) => {\n                if (err) {\n                  tile.state = TileState.unloaded;\n                }\n              },\n            );\n          }\n        }\n      }\n      tile.request.clear();\n    } else {\n      tile.state = TileState.unloaded;\n    }\n    callback();\n  }\n\n  // eslint-disable-next-line\n  unloadTile(tile, cb) {}\n\n  destroy() {\n    this.layer = null;\n    this.#loaded = false;\n    this.#tileWorkers.clear();\n    this.#sourceCache.clear();\n  }\n}\n", "import { Raf } from '@sakitam-gis/vis-engine';\nimport type Track from './Track';\n\nclass TrackManger {\n  public raf: Raf;\n\n  public tracks: Set<Track>;\n\n  constructor() {\n    this.tracks = new Set();\n    this.run = this.run.bind(this);\n    this.raf = new Raf(this.run);\n  }\n\n  add(track) {\n    if (!this.tracks.has(track)) {\n      this.tracks.add(track);\n      this.raf.start();\n    }\n  }\n\n  run(time) {\n    this.tracks.forEach((t) => {\n      t.tick(time);\n    });\n  }\n\n  remove(track) {\n    if (this.tracks.has(track)) {\n      this.tracks.delete(track);\n    }\n\n    if (this.tracks.size === 0) {\n      this.raf.stop();\n    }\n  }\n}\n\nlet tm: WithNull<TrackManger> = null;\n\nexport default function () {\n  if (!tm) {\n    tm = new TrackManger();\n  }\n\n  return tm;\n}\n", "import { EventEmitter, utils } from '@sakitam-gis/vis-engine';\nimport getTrackManger from './TrackManger';\n\nexport enum State {\n  /**\n   * 播放器初始状态\n   */\n  initial = 0,\n\n  /**\n   * 播放状态\n   */\n  playing = 1,\n\n  /**\n   * 暂停状态\n   */\n  paused = 2,\n\n  /**\n   * 停止状态\n   */\n  stopped = 3,\n}\n\nexport interface TrackOptions {\n  /**\n   * 过渡时间\n   */\n  duration?: number; // s\n\n  /**\n   * 延迟时间\n   */\n  delay?: number; // s\n\n  /**\n   * 播放完成后是否延迟\n   */\n  endDelay?: number; // s\n\n  /**\n   * 是否轮播\n   */\n  repeat?: boolean;\n\n  /**\n   * 是否默认启动播放\n   */\n  autoplay?: boolean;\n\n  /**\n   * 回调\n   * @param position\n   */\n  track?: (position: number) => void;\n}\n\nexport const defaultTrackOptions = {\n  duration: 1000,\n  autoplay: true,\n  repeat: true,\n  delay: 0,\n  endDelay: 0,\n  track: (p: number) => undefined, // eslint-disable-line\n};\n\nconst trackManger = getTrackManger();\n\nexport default class Track extends EventEmitter {\n  #playing = false;\n  #state = State.initial;\n  #elapsedTime = -1;\n  #lastTime = -1;\n  #options: Required<TrackOptions>;\n\n  constructor(options: TrackOptions) {\n    super();\n    this.#options = {\n      ...defaultTrackOptions,\n      ...options,\n    };\n\n    if (this.#options.autoplay) {\n      this.play();\n    }\n  }\n\n  /**\n   * 获取当前 Track 的状态\n   */\n  get state() {\n    return this.#state;\n  }\n\n  /**\n   * 获取总的过渡时间\n   */\n  get totalDuration() {\n    return this.#options.delay + this.#options.duration + this.#options.endDelay;\n  }\n\n  get elapsedTime() {\n    return this.#elapsedTime;\n  }\n\n  get totalPosition() {\n    return Math.max(0, Math.min(1, this.#elapsedTime / this.totalDuration));\n  }\n\n  /**\n   * 是否在播放\n   */\n  get isPlaying() {\n    return this.#state === State.playing;\n  }\n\n  /**\n   * 是否暂停\n   */\n  get isPaused() {\n    return this.#state === State.paused;\n  }\n\n  /**\n   * 是否处于激活状态\n   */\n  get isActive() {\n    return this.isPlaying || this.isPaused;\n  }\n\n  /**\n   * 获取当前 Track 的 cursor 位置\n   */\n  get position() {\n    if (this.#elapsedTime < this.#options.delay) {\n      return 0;\n    }\n\n    if (this.#elapsedTime >= this.#options.delay + this.#options.duration) {\n      return 1;\n    }\n\n    return Math.max(0, Math.min(1, (this.#elapsedTime - this.#options.delay) / this.#options.duration));\n  }\n\n  /**\n   * 开始播放\n   */\n  play() {\n    this.#playing = true;\n    this.#state = State.playing;\n    this.advance(0);\n    trackManger.add(this);\n  }\n\n  /**\n   * 暂停\n   */\n  pause() {\n    if (this.#state === State.playing) {\n      this.#state = State.paused;\n    }\n  }\n\n  /**\n   * 继续播放\n   */\n  resume() {\n    if (this.#state === State.paused) {\n      this.#state = State.playing;\n    }\n  }\n\n  /**\n   * 停止\n   */\n  stop() {\n    this.#playing = false;\n    this.#state = State.stopped;\n    // this.advance(0);\n    trackManger.remove(this);\n  }\n\n  /**\n   * 重新开始\n   */\n  restart() {\n    this.#elapsedTime = 0;\n    trackManger.add(this);\n  }\n\n  /**\n   * 重置\n   */\n  reset() {\n    if (this.#state === State.playing) {\n      this.stop();\n    } else {\n      this.advance(0);\n    }\n  }\n\n  /**\n   * 在播放和暂停状态切换\n   */\n  toggle() {\n    if (this.#playing) {\n      if (this.isPlaying) {\n        this.pause();\n      } else {\n        this.resume();\n      }\n    }\n  }\n\n  /**\n   * 步进\n   * @param position\n   * @param e\n   */\n  advance(position, e = true) {\n    const p = utils.clamp(position, 0, 1);\n    this.#elapsedTime = e ? this.totalDuration * p : this.#options.delay + this.#options.duration * p;\n    this.#options?.track?.(this.position);\n    this.emit('track', {\n      position: this.position,\n    });\n  }\n\n  tick(time) {\n    if (this.#lastTime < 0) {\n      this.#lastTime = time;\n    }\n    const lastTime = this.#lastTime;\n    this.#lastTime = time;\n    if (this.#state !== State.playing) return;\n    const delta = time - lastTime;\n    this.#elapsedTime += delta;\n    this.#elapsedTime = Math.min(this.#elapsedTime, this.totalDuration);\n    if (this.totalPosition === 1) {\n      this.advance(this.totalPosition);\n      this.#options.repeat ? this.restart() : this.stop();\n    } else {\n      this.advance(this.totalPosition);\n    }\n  }\n}\n", "import type { Renderer } from '@sakitam-gis/vis-engine';\nimport { EventEmitter, utils } from '@sakitam-gis/vis-engine';\nimport type SourceCache from './cahce';\nimport type Layer from '../renderer';\nimport type { ImageSourceInterval } from './image';\nimport ImageSource from './image';\nimport type { TileSourceInterval } from './tile';\nimport TileSource from './tile';\nimport type { Bounds, Coordinates, DataRange, ParseOptionsType, TileSize, TileSourceOptions } from '../type';\nimport { DecodeType, LayerSourceType, TileState } from '../type';\nimport type Tile from '../tile/Tile';\nimport type { TrackOptions } from '../utils/Track';\nimport Track, { defaultTrackOptions } from '../utils/Track';\n\nconst sourceImpl = {\n  tile: TileSource,\n  image: ImageSource,\n};\n\nfunction generateKey(url: string | string[]) {\n  let urls: string[] = [];\n  if (utils.isString(url)) {\n    urls = [url];\n  }\n\n  return urls.join(',');\n}\n\ninterface TimelineSourceOptions extends TrackOptions {\n  sourceType: LayerSourceType;\n  intervals: (ImageSourceInterval | TileSourceInterval)[];\n  type?: LayerSourceType.timeline;\n\n  /**\n   * image source 配置\n   */\n  coordinates?: Coordinates;\n\n  /**\n   * tile source 配置\n   */\n  subdomains?: (string | number)[];\n  minZoom?: number;\n  maxZoom?: number;\n  tileSize?: TileSize;\n  dataRange?: DataRange | [DataRange, DataRange];\n  scheme?: 'xyz' | 'tms';\n  roundZoom?: number;\n  /**\n   * 指定数据解析类型\n   */\n  decodeType?: DecodeType;\n\n  /**\n   * 是否跨世界渲染\n   */\n  wrapX?: boolean;\n\n  maxTileCacheSize?: number;\n  tileBounds?: Bounds;\n}\n\nclass TimelineSource extends EventEmitter {\n  /**\n   * 数据源 id\n   */\n  public id: string;\n\n  /**\n   * 数据源类型\n   */\n  public type: LayerSourceType.timeline;\n\n  /**\n   * 支持的最小层级\n   */\n  public minZoom: number;\n\n  /**\n   * 支持的最大层级\n   */\n  public maxZoom: number;\n\n  /**\n   * 生成瓦片时的配置\n   */\n  public roundZoom = false;\n\n  /**\n   * 瓦片大小\n   */\n  public tileSize: number;\n\n  /**\n   * 影像坐标\n   */\n  public coordinates: WithUndef<Coordinates>;\n\n  /**\n   * 配置项\n   */\n  public options: TimelineSourceOptions;\n\n  /**\n   * 是否跨世界渲染\n   */\n  public wrapX: boolean;\n\n  public renderer: Renderer;\n\n  public dispatcher: any;\n\n  public layer: WithNull<Layer>;\n\n  public parseOptions: ParseOptionsType;\n\n  public tileBounds: TileSourceOptions['tileBounds'];\n\n  public intervals: TimelineSourceOptions['intervals'];\n\n  #loaded = false;\n  #sourceCache: SourceCache[];\n\n  #current: TileSource | ImageSource;\n  #next: TileSource | ImageSource;\n\n  #index: number;\n  #fadeTime = 0;\n\n  #track: Track;\n\n  #cache: Map<string, any> = new Map();\n\n  constructor(id: string, options: TimelineSourceOptions) {\n    super();\n    this.id = id;\n    this.type = LayerSourceType.timeline;\n\n    this.minZoom = options.minZoom ?? 0;\n    this.maxZoom = options.maxZoom ?? 22;\n    this.roundZoom = Boolean(options.roundZoom);\n    const scheme = options.scheme || 'xyz';\n    this.tileSize = options.tileSize || 512;\n    this.tileBounds = options.tileBounds;\n    this.wrapX = Boolean(options.wrapX);\n    if (options.sourceType === LayerSourceType.image && !options.coordinates) {\n      throw new Error('ImageSource must provide `coordinates`');\n    }\n    this.coordinates = options.coordinates;\n    this.intervals = options.intervals;\n\n    const decodeType = options.decodeType || DecodeType.image;\n    const maxTileCacheSize = options.maxTileCacheSize;\n\n    this.options = {\n      ...defaultTrackOptions,\n      ...options,\n      decodeType,\n      maxTileCacheSize,\n      wrapX: this.wrapX,\n      type: this.type,\n    };\n\n    const current = this.intervals[0];\n    this.#index = 0;\n\n    this.animate = this.animate.bind(this);\n    this.tilesLoadEnd = this.tilesLoadEnd.bind(this);\n\n    const config = {};\n\n    if (options.sourceType === LayerSourceType.image) {\n      Object.assign(config, {\n        url: (current as ImageSourceInterval).url,\n        coordinates: this.coordinates,\n        maxTileCacheSize: this.options.maxTileCacheSize,\n        minZoom: this.minZoom,\n        maxZoom: this.maxZoom,\n        decodeType,\n      });\n    } else if (options.sourceType === LayerSourceType.tile) {\n      Object.assign(config, {\n        url: (current as TileSourceInterval).url,\n        subdomains: this.options.subdomains,\n        minZoom: this.minZoom,\n        maxZoom: this.maxZoom,\n        tileSize: this.tileSize,\n        roundZoom: this.roundZoom,\n        tileBounds: this.tileBounds,\n        maxTileCacheSize: this.options.maxTileCacheSize,\n        scheme,\n        decodeType,\n      });\n    } else {\n      throw new Error('不支持的数据源类型！');\n    }\n\n    this.#current = new (sourceImpl[options.sourceType] as any)(`${this.id}_current`, config);\n    this.#next = new (sourceImpl[options.sourceType] as any)(`${this.id}_next`, config);\n    const currentLoadTile = this.#current.loadTile;\n    const nextLoadTile = this.#next.loadTile;\n\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    function wrapCurrentLoadTile(tile: Tile, callback) {\n      const key = `${tile.tileID.tileKey}-${generateKey(this.url)}`;\n      const cacheTile = that.#cache.get(key);\n      if (cacheTile) {\n        tile.copy(cacheTile);\n        callback(null, true);\n      } else {\n        currentLoadTile.call(this, tile, (err, data) => {\n          if (!err && !that.#cache.has(key) && tile.state === TileState.loaded) {\n            that.#cache.set(key, tile);\n          }\n          callback(err, data);\n        });\n      }\n    }\n    function wrapNextLoadTile(tile: Tile, callback) {\n      const key = `${tile.tileID.tileKey}-${generateKey(this.url)}`;\n      const cacheTile = that.#cache.get(key);\n      if (cacheTile) {\n        tile.copy(cacheTile);\n        callback(null, true);\n      } else {\n        nextLoadTile.call(this, tile, (err, data) => {\n          if (!err && !that.#cache.has(key) && tile.state === TileState.loaded) {\n            that.#cache.set(key, tile);\n          }\n          callback(err, data);\n        });\n      }\n    }\n\n    this.#current.loadTile = wrapCurrentLoadTile;\n    this.#next.loadTile = wrapNextLoadTile;\n    this.#current.sourceCache.on('tilesLoadEnd', this.tilesLoadEnd);\n    this.#next.sourceCache.on('tilesLoadEnd', this.tilesLoadEnd);\n  }\n\n  get track() {\n    return this.#track;\n  }\n\n  get privateType(): LayerSourceType {\n    return this.options.sourceType;\n  }\n\n  get cache() {\n    return this.#cache;\n  }\n\n  get source() {\n    return [this.#current, this.#next];\n  }\n\n  get sourceCache() {\n    return [this.#current?.sourceCache, this.#next?.sourceCache].filter(Boolean);\n  }\n\n  onAdd(layer) {\n    this.layer = layer;\n    if (this.#current) {\n      this.#current.onAdd(this.layer, (error) => {\n        if (!error) {\n          if (this.#next) {\n            this.#next.onAdd(this.layer, (err) => {\n              if (!err) {\n                this.load();\n              }\n            });\n          }\n        }\n      });\n    }\n  }\n\n  prepare(renderer: Renderer, dispatcher, parseOptions: ParseOptionsType) {\n    this.renderer = renderer;\n    this.dispatcher = dispatcher;\n    this.parseOptions = parseOptions;\n    if (this.#current) {\n      this.#current.prepare(renderer, dispatcher, parseOptions);\n    }\n    if (this.#next) {\n      this.#next.prepare(renderer, dispatcher, parseOptions);\n    }\n  }\n\n  getFadeTime() {\n    return this.#fadeTime;\n  }\n\n  tilesLoadEnd() {\n    this.resume();\n  }\n\n  animate({ position }) {\n    const len = this.intervals.length;\n    const lastIndex = this.#index;\n    this.#index = position * utils.clamp(len - 1, 0, Infinity);\n\n    const diff = Math.floor(this.#index) - Math.floor(lastIndex);\n\n    if (diff > 0 || diff < 0) {\n      // 如果 swap source 有任意一个数据未加载完成，停止动画等待加载完成后再执行动画\n      if (!this.#current?.sourceCache.loaded() || !this.#next?.sourceCache.loaded()) {\n        this.pause();\n      } else {\n        this.#fadeTime = 0;\n        // swap source\n        [this.#current, this.#next] = [this.#next, this.#current];\n        this.pause();\n        const item = this.intervals[utils.clamp(Math.floor(this.#index), 0, len - 1)];\n        this.#next.update(item, true);\n      }\n    } else {\n      this.#fadeTime = this.#index % 1;\n    }\n\n    if (this.layer) {\n      this.layer.onTileLoaded();\n    }\n\n    this.emit('update', {\n      position,\n      index: this.#index,\n      clampIndex: utils.clamp(Math.floor(this.#index), 0, len - 1),\n    });\n  }\n\n  play() {\n    this.#track.play();\n    this.emit('play', { position: this.#track.position });\n  }\n\n  pause() {\n    this.#track.pause();\n    this.emit('pause', { position: this.#track.position });\n  }\n\n  resume() {\n    this.#track.resume();\n    this.emit('resume', { position: this.#track.position });\n  }\n\n  stop() {\n    this.#track.stop();\n    this.emit('stop', { position: this.#track.position });\n  }\n\n  restart() {\n    this.#track.restart();\n    this.emit('restart', { position: this.#track.position });\n  }\n\n  load(cb?: any) {\n    this.#loaded = true;\n    this.#track = new Track({\n      duration: (this.options.duration as number) * utils.clamp(this.intervals.length - 1, 0, Infinity),\n      endDelay: this.options.endDelay,\n      repeat: this.options.repeat,\n      autoplay: this.options.autoplay,\n    });\n    this.#track.on('track', this.animate);\n\n    this.layer?.update();\n\n    if (cb) {\n      cb(null);\n    }\n\n    this.emit('loaded', { position: this.#track.position });\n  }\n\n  loaded() {\n    return this.#loaded;\n  }\n\n  destroy() {\n    this.layer = null;\n    this.#loaded = false;\n    this.#track.off('track', this.animate);\n    if (this.#sourceCache && Array.isArray(this.#sourceCache)) {\n      this.#sourceCache.forEach((s) => {\n        s.clear();\n      });\n    }\n\n    this.emit('destroy');\n  }\n}\n\nexport default TimelineSource;\n", "import wgw from 'wind-gl-worker';\nimport BaseLayer, { defaultOptions } from './renderer';\nimport TileID from './tile/TileID';\nimport Tile from './tile/Tile';\nimport type { BaseLayerOptions, UserOptions } from './renderer';\n\nconst configDeps = wgw.configDeps;\n\nexport * from './utils/common';\n\nexport { BaseLayer, BaseLayerOptions, UserOptions, TileID, Tile, defaultOptions, configDeps };\n\nexport * from './source';\n\nexport * from './type';\n"],
  "mappings": "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",
  "names": ["earcut", "intersects", "i", "isImageBitmap", "isFunction", "v", "e", "y", "t", "s", "n", "r", "a", "o", "h", "l", "f", "u", "d", "defaultOptions", "p", "q", "request", "w", "j", "x", "decode", "H", "N", "W", "R", "m", "J", "Q", "X", "C", "V", "A", "M", "I", "b", "Z", "D", "E", "c", "K", "S", "T", "z", "_", "$", "Y", "k", "parse", "_a", "Worker", "self", "Actor", "getRequest", "isWorker", "configDeps", "worker", "uid", "nullFunction", "index", "utils", "register", "getReferrer", "RequestScheduler", "ThrottledInvoker", "earcut", "vert", "frag", "_program", "_mesh", "_geometry", "_current", "_next", "_uid", "RenderType", "RenderFrom", "DecodeType", "LayerSourceType", "TileState", "MaskType", "ComposePass", "wgw", "RasterComposePass", "ColorizeComposePass", "ParticlesPass", "_loaded", "_sourceCache", "_tileWorkers", "_cache"]
}
